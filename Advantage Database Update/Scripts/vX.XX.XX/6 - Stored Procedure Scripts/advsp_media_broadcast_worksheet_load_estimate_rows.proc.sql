CREATE PROCEDURE [dbo].[advsp_media_broadcast_worksheet_load_estimate_rows]
	@MEDIA_BROADCAST_WORKSHEET_MARKET_ID int,
	@REVISION_NUMBER int
AS
BEGIN

	SELECT
		[ID] = MBWMD.MEDIA_BROADCAST_WORKSHEET_MARKET_DETAIL_ID,
		[MediaBroadcastWorksheetMarketID] = MBWMD.MEDIA_BROADCAST_WORKSHEET_MARKET_ID,
		[OnHold] = MBWMD.ON_HOLD,
		[LineNumber] = MBWMD.LINE_NUMBER,
		[MakegoodNumber] = MBWMD.MAKEGOOD_NUMBER,
		[MakegoodDate] = MBWMD.MAKEGOOD_DATE,
		[MakegoodSpots] = MBWMD.MAKEGOOD_SPOTS,
		[MadegoodNumber] = MBWMD.MADEGOOD_NUMBER,
		[RevisionNumber] = MBWMD.REVISION_NUMBER,
		[VendorCode] = MBWMD.VN_CODE,
		[VendorName] = V.VN_NAME,
		[VendorNielsenRadioStationComboID] = ISNULL(CASE WHEN MBWM.EXTERNAL_RADIO_SOURCE = 0 THEN V.NIELSEN_RADIO_STATION_COMBO_ID
														 ELSE V.EASTLAN_RADIO_STATION_COMBO_ID END, 0),
		[VendorNCCTVSyscodeID] = ISNULL(V.NCC_TV_SYSCODE_ID, 0),
		[VendorNielsenTVStationCode] = ISNULL(CASE WHEN MBW.RATINGS_SERVICE_ID = 1 THEN V.NIELSEN_TV_STATION_CODE
                                                   WHEN MBW.RATINGS_SERVICE_ID = 5 THEN V.NPR_STATION_ID
												   ELSE V.COMSCORE_TV_STATION_ID END, 0),
		[VendorIsCableSystem] = V.IS_CABLE_SYSTEM,
		[CableNetworkStationCode] = MBWMD.CABLE_NETWORK_STATION_CODE,
		[CableNetworkStationDescription] = '',
		[CableNetworkNielsenTVStationCode] = MBWMD.CABLE_NETWORK_NIELSEN_TV_STATION_CODE,
		[BookProgram] = MBWMD.BOOK_PROGRAM,
		[Program] = MBWMD.PROGRAM,
		[DaypartID] = MBWMD.DAY_PART_ID,
		[DaypartCode] = ISNULL(DP.DAY_PART_CODE, ''),
		[DaypartDescription] = ISNULL(DP.[DESCRIPTION], ''),
		[Product] = MBWMD.PRODUCT,
		[Piggyback] = MBWMD.PIGGYBACK,
		[Length] = MBWMD.[LENGTH],
		[Days] = MBWMD.[DAYS],
		[Sunday] = MBWMD.SUNDAY,
		[Monday] = MBWMD.MONDAY,
		[Tuesday] = MBWMD.TUESDAY,
		[Wednesday] = MBWMD.WEDNESDAY,
		[Thursday] = MBWMD.THURSDAY,
		[Friday] = MBWMD.FRIDAY,
		[Saturday] = MBWMD.SATURDAY,
		[StartTime] = MBWMD.START_TIME,
		[EndTime] = MBWMD.END_TIME,
		[StartHour] = MBWMD.START_HOUR,
		[EndHour] = MBWMD.END_HOUR,
		[Comments] = MBWMD.COMMENTS,
		[Bookend] = MBWMD.BOOKEND,
		[ValueAdded] = MBWMD.VALUE_ADDED,
		[DefaultRate] = MBWMD.DEFAULT_RATE,
		[OrderComments] = MBWMD.ORDER_COMMENTS,
		[BookPrimaryRating] = MBWMD.BOOK_PRIMARY_RATING,
		[PrimaryRating] = MBWMD.PRIMARY_RATING,
		[BookPrimaryShare] = MBWMD.BOOK_PRIMARY_SHARE,
		[PrimaryShare] = MBWMD.PRIMARY_SHARE,
		[PrimaryHPUT] = MBWMD.PRIMARY_HPUT,
		[PrimaryCPP] = MBWMD.PRIMARY_CPP,
		[PrimaryGRP] = MBWMD.PRIMARY_GRP,
		[PrimaryReach] = MBWMD.PRIMARY_REACH,
		[PrimaryFrequency] = MBWMD.PRIMARY_FREQUENCY,
		[BookPrimaryImpressions] = MBWMD.BOOK_PRIMARY_IMPRESSIONS,
		[PrimaryImpressions] = MBWMD.PRIMARY_IMPRESSIONS,
		[PrimaryGrossImpressions] = MBWMD.PRIMARY_GROSS_IMPRESSIONS,
		[PrimaryUniverse] = MBWMD.PRIMARY_UNIVERSE,
		[PrimaryCumeImpressions] = MBWMD.PRIMARY_CUME_IMPRESSIONS,
		[BookPrimaryAQHRating] = MBWMD.BOOK_PRIMARY_AQH_RATING,
		[PrimaryAQHRating] = MBWMD.PRIMARY_AQH_RATING,
		[BookPrimaryAQH] = MBWMD.BOOK_PRIMARY_AQH,
		[PrimaryAQH] = MBWMD.PRIMARY_AQH,
		[PrimaryCumeRating] = MBWMD.PRIMARY_CUME_RATING,
		[PrimaryCume] = MBWMD.PRIMARY_CUME,
		[PrimaryCPM] = MBWMD.PRIMARY_CPM,
		[BookSecondaryRating] = MBWMD.BOOK_SECONDARY_RATING,
		[SecondaryRating] = MBWMD.SECONDARY_RATING,
		[BookSecondaryShare] = MBWMD.BOOK_SECONDARY_SHARE,
		[SecondaryShare] = MBWMD.SECONDARY_SHARE,
		[SecondaryHPUT] = MBWMD.SECONDARY_HPUT,
		[SecondaryCPP] = MBWMD.SECONDARY_CPP,
		[SecondaryGRP] = MBWMD.SECONDARY_GRP,
		[SecondaryReach] = MBWMD.SECONDARY_REACH,
		[SecondaryFrequency] = MBWMD.SECONDARY_FREQUENCY,
		[BookSecondaryImpressions] = MBWMD.BOOK_SECONDARY_IMPRESSIONS,
		[SecondaryImpressions] = MBWMD.SECONDARY_IMPRESSIONS,
		[SecondaryGrossImpressions] = MBWMD.SECONDARY_GROSS_IMPRESSIONS,
		[SecondaryUniverse] = MBWMD.SECONDARY_UNIVERSE,
		[SecondaryCumeImpressions] = MBWMD.SECONDARY_CUME_IMPRESSIONS,
		[BookSecondaryAQHRating] = MBWMD.BOOK_SECONDARY_AQH_RATING,
		[SecondaryAQHRating] = MBWMD.SECONDARY_AQH_RATING,
		[BookSecondaryAQH] = MBWMD.BOOK_SECONDARY_AQH,
		[SecondaryAQH] = MBWMD.SECONDARY_AQH,
		[SecondaryCumeRating] = MBWMD.SECONDARY_CUME_RATING,
		[SecondaryCume] = MBWMD.SECONDARY_CUME,
		[SecondaryCPM] = MBWMD.SECONDARY_CPM,
		[PrimaryVendorSubmittedRating] = MBWMD.PRIMARY_VENDOR_SUBMITTED_RATING,
		[PrimaryVendorSubmittedShare] = MBWMD.PRIMARY_VENDOR_SUBMITTED_SHARE,
		[PrimaryVendorSubmittedImpressions] = MBWMD.PRIMARY_VENDOR_SUBMITTED_IMPRESSIONS,
		[SecondaryVendorSubmittedRating] = MBWMD.SECONDARY_VENDOR_SUBMITTED_RATING,
		[SecondaryVendorSubmittedShare] = MBWMD.SECONDARY_VENDOR_SUBMITTED_SHARE,
		[SecondaryVendorSubmittedImpressions] = MBWMD.SECONDARY_VENDOR_SUBMITTED_IMPRESSIONS,
		[CreatedByUserCode] = MBWMD.USER_CREATED,
		[CreatedDate] = MBWMD.CREATED_DATE,
		[ModifiedByUserCode] = MBWMD.USER_MODIFIED,
		[ModifiedDate] = MBWMD.MODIFIED_DATE,
		[OverridePost] = MBWMD.OVERRIDE_POST,
		[OverridePostImpressions] = MBWMD.OVERRIDE_POST_IMPRESSIONS,
		[OverridePostAQH] = MBWMD.OVERRIDE_POST_AQH 
	FROM 
		[dbo].[MEDIA_BROADCAST_WORKSHEET_MARKET_DETAIL] MBWMD
		INNER JOIN [dbo].[MEDIA_BROADCAST_WORKSHEET_MARKET] MBWM ON MBWM.MEDIA_BROADCAST_WORKSHEET_MARKET_ID = MBWMD.MEDIA_BROADCAST_WORKSHEET_MARKET_ID 
		INNER JOIN [dbo].[MEDIA_BROADCAST_WORKSHEET] MBW ON MBW.MEDIA_BROADCAST_WORKSHEET_ID = MBWM.MEDIA_BROADCAST_WORKSHEET_ID 
		INNER JOIN [dbo].[VENDOR] V ON V.VN_CODE = MBWMD.VN_CODE 
		LEFT OUTER JOIN [dbo].[DAY_PART] DP ON DP.DAY_PART_ID = MBWMD.DAY_PART_ID
	WHERE 
		MBWMD.MEDIA_BROADCAST_WORKSHEET_MARKET_ID = @MEDIA_BROADCAST_WORKSHEET_MARKET_ID 
		AND MBWMD.REVISION_NUMBER = @REVISION_NUMBER

END
GO


