CREATE PROCEDURE [dbo].[advsp_media_plan_estimate_template_demographics]
	@MEDIA_PLAN_ESTIMATE_TEMPLATE_ID int,
	@TYPE char(1) 
AS

SELECT
	Selected = CAST(CASE WHEN mpetd.MEDIA_DEMO_ID IS NOT NULL THEN 1 ELSE 0 END as bit),
	MediaDemoID = md.MEDIA_DEMO_ID,
	Demographic = md.[DESCRIPTION] 
FROM dbo.MEDIA_DEMO md
	LEFT OUTER JOIN dbo.MEDIA_PLAN_ESTIMATE_TEMPLATE_DEMOGRAPHIC mpetd ON md.MEDIA_DEMO_ID = mpetd.MEDIA_DEMO_ID AND mpetd.MEDIA_PLAN_ESTIMATE_TEMPLATE_ID = @MEDIA_PLAN_ESTIMATE_TEMPLATE_ID
WHERE md.IS_INACTIVE = 0
AND md.[TYPE] = @TYPE
AND md.MEDIA_DEMO_SOURCE_ID = 0
AND md.IS_SYSTEM = 0
ORDER BY md.[DESCRIPTION] 
GO
