IF(SELECT COUNT(1) FROM MEDIA_DEMO WHERE MEDIA_DEMO_SOURCE_ID = 4) = 0 BEGIN
    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pp2P','Persons 2+','T',0,0,1,1,1,0,4,2,99,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm2P','Males 2+','T',0,0,1,0,1,0,4,2,99,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm2-5','Males 2-5','T',0,0,1,0,1,0,4,2,5,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm6-11','Males 6-11','T',0,0,1,0,1,0,4,6,11,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm12-14','Males 12-14','T',0,0,1,0,1,0,4,12,14,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm15-17','Males 15-17','T',0,0,1,0,1,0,4,15,17,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm18-20','Males 18-20','T',0,0,1,0,1,0,4,18,20,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm21-24','Males 21-24','T',0,0,1,0,1,0,4,21,24,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm25-34','Males 25-34','T',0,0,1,0,1,0,4,25,34,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm35-44','Males 35-44','T',0,0,1,0,1,0,4,35,44,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm45-49','Males 45-49','T',0,0,1,0,1,0,4,45,49,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm50-54','Males 50-54','T',0,0,1,0,1,0,4,50,54,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm55-64','Males 55-64','T',0,0,1,0,1,0,4,55,64,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pm65+','Males 65+','T',0,0,1,0,1,0,4,65,99,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf2P','Females 2+','T',0,0,0,1,1,0,4,2,99,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf2-5','Females 2-5','T',0,0,0,1,1,0,4,2,5,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf6-11','Females 6-11','T',0,0,0,1,1,0,4,6,11,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf12-14','Females 12-14','T',0,0,0,1,1,0,4,12,14,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf15-17','Females 15-17','T',0,0,0,1,1,0,4,15,17,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf18-20','Females 18-20','T',0,0,0,1,1,0,4,18,20,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf21-24','Females 21-24','T',0,0,0,1,1,0,4,21,24,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf25-34','Females 25-34','T',0,0,0,1,1,0,4,25,34,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf35-44','Females 35-44','T',0,0,0,1,1,0,4,35,44,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf45-49','Females 45-49','T',0,0,0,1,1,0,4,45,49,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf50-54','Females 50-54','T',0,0,0,1,1,0,4,50,54,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf55-64','Females 55-64','T',0,0,0,1,1,0,4,55,64,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pf65+','Females 65+','T',0,0,0,1,1,0,4,65,99,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO]([CODE],[DESCRIPTION],[TYPE],[IS_BOYS],[IS_GIRLS],[IS_MALES],[IS_FEMALES],[IS_SYSTEM],[IS_WORKING_WOMEN],[MEDIA_DEMO_SOURCE_ID],[AGE_FROM],[AGE_TO],[IS_INACTIVE],[IS_CHILDREN],[USE_FOR_COUNTY],[USE_FOR_MARKET])
    VALUES ('pww','Working Women','T',0,0,0,0,1,1,4,NULL,NULL,0,0,0,1)

    INSERT INTO [dbo].[MEDIA_DEMO_DETAIL] (MEDIA_DEMO_ID, NIELSEN_DEMO_ID)
    SELECT md.MEDIA_DEMO_ID, n.NIELSEN_DEMO_ID 
    FROM dbo.NIELSEN_DEMO n
	    INNER JOIN dbo.MEDIA_DEMO md ON n.CODE = md.CODE 
    WHERE md.MEDIA_DEMO_SOURCE_ID = 4
END

UPDATE [dbo].[MEDIA_DEMO] SET CODE = 'pm65P'
WHERE CODE = 'pm65+'
AND MEDIA_DEMO_SOURCE_ID = 4

UPDATE [dbo].[MEDIA_DEMO] SET CODE = 'pf65P'
WHERE CODE = 'pf65+'
AND MEDIA_DEMO_SOURCE_ID = 4

DELETE [MEDIA_DEMO_DETAIL]
WHERE MEDIA_DEMO_ID IN (
    select MEDIA_DEMO_ID from MEDIA_DEMO
    where MEDIA_DEMO_SOURCE_ID = 4
)

INSERT INTO [dbo].[MEDIA_DEMO_DETAIL] (MEDIA_DEMO_ID, NIELSEN_DEMO_ID)
SELECT md.MEDIA_DEMO_ID, n.NIELSEN_DEMO_ID 
FROM dbo.NIELSEN_DEMO n
	INNER JOIN dbo.MEDIA_DEMO md ON n.CODE = md.CODE 
WHERE md.MEDIA_DEMO_SOURCE_ID = 4