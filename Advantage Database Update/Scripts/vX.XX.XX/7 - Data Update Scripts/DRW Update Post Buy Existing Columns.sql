CREATE TABLE #REPORTS([RowID] [int] IDENTITY(1,1), 
					  [DYNAMIC_REPORT_ID] [int] NOT NULL)
					
DECLARE @ROW_COUNT AS integer
DECLARE @ROW_ID AS integer
DECLARE @DYNAMIC_REPORT_ID AS integer
	
INSERT INTO #REPORTS
SELECT DYNAMIC_REPORT_ID FROM dbo.DYNAMIC_REPORT WHERE DYNAMIC_REPORT_TYPE = 108
	
SET @ROW_COUNT = @@ROWCOUNT
SET @ROW_ID = 1

WHILE @ROW_ID <= @ROW_COUNT BEGIN

	SELECT
		@DYNAMIC_REPORT_ID = [DYNAMIC_REPORT_ID]
	FROM 
		#REPORTS
	WHERE
		RowID = @ROW_ID

	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'Actual') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Act GRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'
			AND HEADER_TEXT = 'Actual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'ActualGRP',
			COLUMN_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'DetailActual') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Act Rtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'
			AND (HEADER_TEXT = 'DetailActual' OR HEADER_TEXT = 'Detail Actual')
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'ActualRtg',
			COLUMN_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'Estimate') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Est GRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'
			AND HEADER_TEXT = 'Estimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'EstimateGRP',
			COLUMN_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'DetailEstimate') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Est Rtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'
			AND (HEADER_TEXT = 'DetailEstimate' OR HEADER_TEXT = 'Detail Estimate')
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'EstimateRtg',
			COLUMN_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'

	END
	
	SET @ROW_ID = @ROW_ID + 1
	
END

DELETE FROM #REPORTS

INSERT INTO #REPORTS
SELECT DYNAMIC_REPORT_ID FROM dbo.DYNAMIC_REPORT WHERE DYNAMIC_REPORT_TYPE = 136
	
SET @ROW_COUNT = @@ROWCOUNT
SET @ROW_ID = 1

WHILE @ROW_ID <= @ROW_COUNT BEGIN

	SELECT
		@DYNAMIC_REPORT_ID = [DYNAMIC_REPORT_ID]
	FROM 
		#REPORTS
	WHERE
		RowID = @ROW_ID

	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'Actual') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Act GRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'
			AND HEADER_TEXT = 'Actual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'ActualGRP',
			COLUMN_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'ActualGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Actual'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'DetailActual') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Act Rtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'
			AND (HEADER_TEXT = 'DetailActual' OR HEADER_TEXT = 'Detail Actual')
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'ActualRtg',
			COLUMN_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'ActualRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailActual'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'Estimate') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Est GRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'
			AND HEADER_TEXT = 'Estimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'EstimateGRP',
			COLUMN_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'EstimateGRP'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'Estimate'

	END
	
	IF EXISTS(SELECT FIELD_NAME FROM dbo.DYNAMIC_REPORT_COL WHERE DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID AND FIELD_NAME = 'DetailEstimate') BEGIN
	
		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			HEADER_TEXT = 'Est Rtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'
			AND (HEADER_TEXT = 'DetailEstimate' OR HEADER_TEXT = 'Detail Estimate')
			
		UPDATE
			dbo.DYNAMIC_REPORT_SUM
		SET
			FIELD_NAME = 'EstimateRtg',
			COLUMN_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'
			
		UPDATE
			dbo.DYNAMIC_REPORT_UB_COL
		SET
			FIELD_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'

		UPDATE
			dbo.DYNAMIC_REPORT_COL
		SET
			FIELD_NAME = 'EstimateRtg'
		WHERE
			DYNAMIC_REPORT_ID = @DYNAMIC_REPORT_ID 
			AND FIELD_NAME = 'DetailEstimate'

	END
	
	SET @ROW_ID = @ROW_ID + 1
	
END

DROP TABLE #REPORTS