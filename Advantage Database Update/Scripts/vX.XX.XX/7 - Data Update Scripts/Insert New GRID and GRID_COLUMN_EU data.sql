/* STEP 1

	CLEAN UP OLD GRIDS
	IF YOU RENAME A GRID, CLEAN UP THE OLD GRID DATA

*/

DECLARE @OLD_GRID_ID INT;

/* STEP 2

	ADD GRID NAMES

*/
IF NOT EXISTS (SELECT GRID_ID FROM [GRID] WHERE [NAME] = 'RadGridEUDashboard')
BEGIN
	INSERT INTO GRID ([NAME]) VALUES ('RadGridEUDashboard');	
END
--CLEAN UP EXISTING COLUMNS AND USER SETTINGS
BEGIN
	DELETE FROM GRID_COLUMN_SETTING WHERE GRID_ID = (SELECT GRID_ID FROM GRID WHERE NAME = 'RadGridEUDashboard')
	DELETE FROM GRID_COLUMN WHERE GRID_ID = (SELECT GRID_ID FROM GRID WHERE NAME = 'RadGridEUDashboard');	
END


/* STEP 3

	ADD COLUMNS TO GRID
	IF YOU RENAME COLUMNS, DELETE OLD SETTINGS
*/

DECLARE 
	@GRID_ID AS INT,
	@GRID_NAME AS VARCHAR(50),
	@COLUMN_NAME AS VARCHAR(50),
	@COLUMN_IS_EDITABLE AS BIT;

DECLARE GRID_NAME_CURSOR CURSOR FOR
SELECT GRID_ID, [NAME] FROM [GRID] WITH(NOLOCK);

--DELETE ALL EXISTING COLUMNS FOR THE RadGridAlertInbox GRID
DELETE FROM GRID_COLUMN
		WHERE GRID_ID = @GRID_ID;



OPEN GRID_NAME_CURSOR;
FETCH NEXT FROM GRID_NAME_CURSOR INTO @GRID_ID, @GRID_NAME;

WHILE (@@FETCH_STATUS = 0)
BEGIN
	IF (@GRID_NAME = 'RadGridEUDashboard' )
	BEGIN			
		SET @COLUMN_NAME = 'EmployeeOffice';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 1, 150);
		END

		SET @COLUMN_NAME = 'EmployeeOfficeName';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 2, 150);
		END

		SET @COLUMN_NAME = 'EmployeeCode';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 3, 150);
		END

		SET @COLUMN_NAME = 'EmployeeName';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 4, 150);
		END

		SET @COLUMN_NAME = 'EmployeeDepartment';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 5, 150);
		END

		SET @COLUMN_NAME = 'EmployeeDepartmentName';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 6, 180);
		END

		SET @COLUMN_NAME = 'RequiredHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 7, 150);
		END

		SET @COLUMN_NAME = 'DirectHoursGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 8, 180);
		END

		SET @COLUMN_NAME = 'BillableHoursGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 9, 180);
		END

		SET @COLUMN_NAME = 'BillableHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 10, 150);
		END

		SET @COLUMN_NAME = 'NonBillableHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 11, 170);
		END

		SET @COLUMN_NAME = 'AgencyHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 12, 150);
		END

		SET @COLUMN_NAME = 'NewBusinessHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 13, 200);
		END

		SET @COLUMN_NAME = 'TotalDirectHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 14, 170);
		END

		SET @COLUMN_NAME = 'NonDirectHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 15, 150);
		END

		SET @COLUMN_NAME = 'OOOHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 16, 150);
		END

		SET @COLUMN_NAME = 'TotalHours';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 17, 190);
		END

		SET @COLUMN_NAME = 'Variance';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 18, 150);
		END

		SET @COLUMN_NAME = 'BillableHoursPercent';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 19, 160);
		END

		SET @COLUMN_NAME = 'BillablePercentGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 20, 170);
		END

		SET @COLUMN_NAME = 'BillableVariance';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 21, 170);
		END

		SET @COLUMN_NAME = 'DirectPercentGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 22, 170);
		END

		SET @COLUMN_NAME = 'NonBillableHoursPercent';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 23, 180);
		END

		SET @COLUMN_NAME = 'NewBusinessPercent';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 24, 150);
		END

		SET @COLUMN_NAME = 'PercentDirect';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 25, 150);
		END

		SET @COLUMN_NAME = 'PercentNonDirect';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 26, 150);
		END

		SET @COLUMN_NAME = 'OOOPercent';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 27, 100);
		END

		SET @COLUMN_NAME = 'PercentOfDirectHoursGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 28, 200);
		END

		SET @COLUMN_NAME = 'PercentOfBillableHoursGoal';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 29, 200);
		END

		SET @COLUMN_NAME = 'TotalUtilization';
		SET @COLUMN_IS_EDITABLE = 1;
		IF NOT EXISTS (SELECT GRID_COLUMN_ID FROM GRID_COLUMN WITH(NOLOCK) WHERE GRID_ID = @GRID_ID AND NAME = @COLUMN_NAME)
		BEGIN
			INSERT INTO GRID_COLUMN (GRID_ID, [NAME], IS_EDITABLE, DEFAULT_ORDER_ID, DEFAULT_COLUMN_WIDTH) VALUES (@GRID_ID, @COLUMN_NAME, @COLUMN_IS_EDITABLE, 30, 170);
		END
	END

	FETCH NEXT FROM GRID_NAME_CURSOR INTO @GRID_ID, @GRID_NAME;

END
CLOSE GRID_NAME_CURSOR;
DEALLOCATE GRID_NAME_CURSOR;

