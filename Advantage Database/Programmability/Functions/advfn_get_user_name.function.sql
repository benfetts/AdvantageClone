CREATE  FUNCTION [dbo].[advfn_get_user_name] ( @user_code varchar(100) )  		  	
RETURNS VARCHAR(61) AS  	
BEGIN  
	DECLARE @EMP_NAME varchar(61)

	SELECT     @EMP_NAME = COALESCE (RTRIM(EMPLOYEE.EMP_FNAME) + ' ', '') + COALESCE (EMPLOYEE.EMP_MI + '. ', '') + COALESCE (EMPLOYEE.EMP_LNAME, '') 
	FROM         SEC_USER WITH(NOLOCK) INNER JOIN
							EMPLOYEE WITH(NOLOCK) ON SEC_USER.EMP_CODE = EMPLOYEE.EMP_CODE
	WHERE     (UPPER(SEC_USER.USER_CODE) = UPPER(@user_code));

	RETURN ISNULL(@EMP_NAME, @user_code); 
	
END