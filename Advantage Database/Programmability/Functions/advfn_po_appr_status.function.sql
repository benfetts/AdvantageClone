  CREATE FUNCTION dbo.advfn_po_appr_status ( @po_number integer )  		  	RETURNS smallint  	AS  	BEGIN  		DECLARE @appr_status smallint, @appr_count_tot smallint, @appr_count_pend smallint, @appr_count_acc smallint, @appr_count_rej smallint    		SELECT @appr_count_tot = ( SELECT COUNT(*) FROM dbo.PO_APPROVAL WHERE PO_NUMBER = @po_number )  		SELECT @appr_count_pend = ( SELECT COUNT(*) FROM dbo.PO_APPROVAL WHERE PO_NUMBER = @po_number AND PO_APPROVAL_FLAG IS NULL )  		SELECT @appr_count_rej = ( SELECT COUNT(*) FROM dbo.PO_APPROVAL WHERE PO_NUMBER = @po_number AND PO_APPROVAL_FLAG = 0 )  		SELECT @appr_count_acc = ( SELECT COUNT(*) FROM dbo.PO_APPROVAL WHERE PO_NUMBER = @po_number AND PO_APPROVAL_FLAG = 1 )    		IF @appr_count_tot > 0  		BEGIN  			IF @appr_count_acc = @appr_count_tot  				SELECT @appr_status = 2  			ELSE   			BEGIN  				IF @appr_count_rej > 0  					SELECT @appr_status = 3  				ELSE  				BEGIN  					IF @appr_count_pend > 0  						SELECT @appr_status = 1  				END  			END  		END    	RETURN @appr_status  	END