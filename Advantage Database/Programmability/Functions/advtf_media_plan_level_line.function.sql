CREATE FUNCTION [dbo].[advtf_media_plan_level_line]	(@ORDER_NUMBER int)
RETURNS @MEDIA_PLAN_LEVEL_LINE TABLE 
(
	[MEDIA_PLAN_ID] int NOT NULL,
	[MEDIA_PLAN_DTL_ID] int NOT NULL,
	[DESCRIPTION] varchar(MAX) NULL,
	[ROW_INDEX] int NOT NULL
)
WITH SCHEMABINDING 
BEGIN

	INSERT INTO @MEDIA_PLAN_LEVEL_LINE
	SELECT 
			MPDLL.MEDIA_PLAN_ID,
			MPDLL.MEDIA_PLAN_DTL_ID,
			MPDLL.[DESCRIPTION],
			MPDLL.ROW_INDEX
		FROM 
			[dbo].[MEDIA_PLAN_DTL_LEVEL_LINE] AS MPDLL INNER JOIN
			[dbo].[MEDIA_PLAN_DTL_LEVEL] AS MPDL ON MPDL.MEDIA_PLAN_ID = MPDLL.MEDIA_PLAN_ID
													AND MPDL.MEDIA_PLAN_DTL_ID = MPDLL.MEDIA_PLAN_DTL_ID
													AND MPDL.MEDIA_PLAN_DTL_LEVEL_ID = MPDLL.MEDIA_PLAN_DTL_LEVEL_ID
		WHERE
			MPDL.ORDER_NUMBER = @ORDER_NUMBER

	RETURN 

END
GO



