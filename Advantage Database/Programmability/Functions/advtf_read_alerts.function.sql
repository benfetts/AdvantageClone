--DROP FUNCTION [dbo].[advtf_read_alerts]
CREATE FUNCTION [dbo].[advtf_read_alerts] (@EMP_CODE VARCHAR(6))
RETURNS @ALERT TABLE (ALERT_ID INT)
AS
BEGIN

	INSERT INTO @ALERT
	SELECT RSLT.ALERT_ID
	FROM (
		SELECT
			A.ALERT_ID
		FROM 
			ALERT A 
			INNER JOIN ALERT_RCPT AR ON A.ALERT_ID = AR.ALERT_ID
		WHERE
			READ_ALERT = 1
			AND AR.EMP_CODE = @EMP_CODE
		UNION
		SELECT
			A.ALERT_ID
		FROM 
			ALERT A 
			INNER JOIN ALERT_RCPT_DISMISSED AR ON A.ALERT_ID = AR.ALERT_ID
		WHERE
			READ_ALERT = 1
			AND AR.EMP_CODE = @EMP_CODE
		) AS RSLT

	RETURN

END
