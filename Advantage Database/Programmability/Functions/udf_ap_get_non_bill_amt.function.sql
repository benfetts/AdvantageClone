  CREATE FUNCTION [dbo].udf_ap_get_non_bill_amt (@al_ap_id INT)  RETURNS decimal(14,2)  /*Returns non billable amount for given AP */  AS  BEGIN     DECLARE @ldec_prod_amt decimal(14,2)     DECLARE @ldec_gl_amt decimal(14,2)     DECLARE @ldec_total_amt decimal(14,2)    SET @ldec_gl_amt = (  SELECT COALESCE(SUM(AP_GL_AMT) , 0)  FROM AP_GL_DIST  WHERE AP_ID = @al_ap_id  )    SET @ldec_prod_amt = (  SELECT COALESCE(SUM(AP.AP_PROD_EXT_AMT), 0) + COALESCE(SUM(EXT_NONRESALE_TAX), 0)  FROM AP_PRODUCTION AP  WHERE AP.AP_ID = @al_ap_id  	AND AP_PROD_NOBILL_FLG = 1  )    IF @ldec_gl_amt IS NULL  	SET @ldec_gl_amt = 0    IF @ldec_prod_amt IS NULL  	SET @ldec_prod_amt = 0    SET @ldec_total_amt = @ldec_gl_amt + @ldec_prod_amt    RETURN @ldec_total_amt  END