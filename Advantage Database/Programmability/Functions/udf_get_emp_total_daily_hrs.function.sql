
CREATE FUNCTION [dbo].[udf_get_emp_total_daily_hrs]
(
	@EMP_CODE     VARCHAR(6),
	@THE_DATE     SMALLDATETIME
)
RETURNS DECIMAL(18,6)
AS
BEGIN
	DECLARE 
		@THE_HOURS DECIMAL(18,6),
		@THE_DAY_OF_THE_WEEK INT
		
	BEGIN
		SET @THE_DAY_OF_THE_WEEK =  DATEPART(weekday,@THE_DATE)

		IF @THE_DAY_OF_THE_WEEK = 1
		BEGIN
			SELECT @THE_HOURS = ISNULL(SUN_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 2
		BEGIN
			SELECT @THE_HOURS = ISNULL(MON_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 3
		BEGIN
			SELECT @THE_HOURS = ISNULL(TUE_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 4
		BEGIN
			SELECT @THE_HOURS = ISNULL(WED_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 5
		BEGIN
			SELECT @THE_HOURS = ISNULL(THU_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 6
		BEGIN
			SELECT @THE_HOURS = ISNULL(FRI_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
		IF @THE_DAY_OF_THE_WEEK = 7
		BEGIN
			SELECT @THE_HOURS = ISNULL(SAT_HRS,0) FROM EMPLOYEE WITH(NOLOCK) WHERE EMP_CODE = @EMP_CODE;
		END
	END
	RETURN @THE_HOURS
END
