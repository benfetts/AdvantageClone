CREATE PROCEDURE advsp_bcc_get_coop_jobs @BillingUser varchar(100)

AS

SELECT DISTINCT
		[JobNumber] = W.JOB_NUMBER,
		[JobComponentNumber] = W.JOB_COMPONENT_NBR,
		[ClientCode] = W.CL_CODE,
		[ClientName] = C.CL_NAME,
		[DivisionCode] = W.DIV_CODE,
		[DivisionName] = D.DIV_NAME,
		[ProductCode] = W.PRD_CODE,
		[ProductName] = P.PRD_DESCRIPTION,
		[OfficeName] = O.OFFICE_NAME,
		[CampaignCode] = CMP.CMP_CODE,
		[CampaignName] = CMP.CMP_NAME
FROM W_AR_FUNCTION W
	LEFT OUTER JOIN dbo.CLIENT C ON W.CL_CODE = C.CL_CODE
	LEFT OUTER JOIN dbo.DIVISION D ON W.CL_CODE = D.CL_CODE AND W.DIV_CODE = D.DIV_CODE 
	LEFT OUTER JOIN dbo.PRODUCT P ON W.CL_CODE = P.CL_CODE AND W.DIV_CODE = P.DIV_CODE AND W.PRD_CODE = P.PRD_CODE 
	LEFT OUTER JOIN dbo.OFFICE O ON W.OFFICE_CODE = O.OFFICE_CODE 
	LEFT OUTER JOIN dbo.CAMPAIGN CMP ON W.CMP_IDENTIFIER = CMP.CMP_IDENTIFIER 
WHERE
		W.BILLING_USER = @BillingUser 
AND		W.SUMMARY_FLAG = 1
AND		W.JOB_NUMBER IS NOT NULL
GO
