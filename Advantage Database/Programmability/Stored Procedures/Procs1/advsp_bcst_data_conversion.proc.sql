--Stored procedure to convert old broadcast data needed for AR Summary conversion from columns to rows
--#00 7/11/13 - initial (JR)

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING OFF
GO

CREATE PROCEDURE [dbo].[advsp_bcst_data_conversion] ( @user_code varchar(100))
AS
BEGIN
	SET NOCOUNT ON;

--============================================================================
--BEGIN CREATE TABLES
--============================================================================
--BRDCAST DATA
CREATE TABLE #bcst_data(
	ORDER_TYPE				varchar(1) COLLATE SQL_Latin1_General_CP1_CS_AS,
	ORDER_NBR				int NOT NULL,
	BILL_COOP_CODE			varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	CL_CODE					varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	DIV_CODE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	PRD_CODE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	MEDIA_TYPE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	CMP_IDENTIFIER			int NULL,
	CLIENT_PO				varchar(25) COLLATE SQL_Latin1_General_CP1_CS_AS,
	BILL_TYPE_FLAG			smallint NULL,
	MARKET_CODE				varchar(10) COLLATE SQL_Latin1_General_CP1_CS_AS,
	FLIGHT_FROM				smalldatetime NULL,
	FLIGHT_TO				smalldatetime NULL,
	LINE_NBR				smallint NOT NULL,
	REV_NBR					smallint NOT NULL,
	SEQ_NBR					smallint NOT NULL,
	BRDCAST_YEAR			int NOT NULL,
	MONTH_IND				int NOT NULL,
	AR_INV_NBR				int NULL,
	AR_INV_SEQ				smallint NULL,
	AR_TYPE					varchar(3) COLLATE SQL_Latin1_General_CP1_CS_AS,
	SPOTS					int NULL,
	COMM_AMT				decimal (15,2) NULL,
	REBATE_AMT				decimal (15,2) NULL,
	LINE_NET				decimal (15,2) NULL,
	VENDOR_TAX				decimal (15,2) NULL,
	DISCOUNT				decimal (15,2) NULL,
	CITY_TAX				decimal (15,2) NULL,
	COUNTY_TAX				decimal (15,2) NULL,
	STATE_TAX				decimal (15,2) NULL,
	BILLING_AMT				decimal (15,2) NULL,
	GLEXACT					int NULL,
	GLEXACT_DEF				int NULL,
	GLACODE_SALES			varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	GLACODE_COS				varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	GLACODE_WIP				varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	GLACODE_STATE			varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	GLACODE_COUNTY			varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	GLACODE_CITY			varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS)

--HEADER DATA
CREATE TABLE #bcst_hdr(
	ORDER_TYPE				varchar(1) COLLATE SQL_Latin1_General_CP1_CS_AS,
	ORDER_NBR				int NOT NULL,
	BILL_COOP_CODE			varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	CL_CODE					varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	DIV_CODE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	PRD_CODE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	MEDIA_TYPE				varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	CMP_IDENTIFIER			int NULL,
	CLIENT_PO				varchar(25) COLLATE SQL_Latin1_General_CP1_CS_AS,
	BILL_TYPE_FLAG			smallint NULL,
	MARKET_CODE				varchar(10) COLLATE SQL_Latin1_General_CP1_CS_AS,
	FLIGHT_FROM				smalldatetime NULL,
	FLIGHT_TO				smalldatetime NULL)

--HEADER MAX REV
CREATE TABLE #hdr_max_rev(
	ORDER_NBR				int NOT NULL,
	MAX_REV					smallint NULL)
	
--============================================================================
--END CREATE TABLES
--============================================================================
--BEGIN GET DATA
--============================================================================
--GET RADIO HDR MAX REV
BEGIN
	INSERT INTO #hdr_max_rev
		SELECT h.ORDER_NBR,
		Max(h.REV_NBR)
	FROM dbo.RADIO_HEADER AS h
	GROUP BY h.ORDER_NBR
END

--GET TV HDR MAX REV
BEGIN
	INSERT INTO #hdr_max_rev
		SELECT h.ORDER_NBR,
		MAX(h.REV_NBR)
	FROM dbo.TV_HEADER AS h
	GROUP BY h.ORDER_NBR
END
		
--GET RADIO HDR DATA
BEGIN
	INSERT INTO #bcst_hdr
		SELECT 'R' AS ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO
	FROM #hdr_max_rev AS r
	INNER JOIN dbo.RADIO_HEADER AS h
		ON r.ORDER_NBR = h.ORDER_NBR
		AND r.MAX_REV = h.REV_NBR
END

--GET TV HDR DATA
BEGIN
	INSERT INTO #bcst_hdr
		SELECT 'T' AS ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO
	FROM #hdr_max_rev AS r
	INNER JOIN dbo.TV_HEADER AS h
		ON r.ORDER_NBR = h.ORDER_NBR
		AND r.MAX_REV = h.REV_NBR
END		

--BEGIN RADIO_DATA
--JAN RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		1 AS MONTH_IND,
		d.JAN_AR_INV_NBR,
		d.JAN_AR_INV_SEQ,
		d.JAN_AR_TYPE,
		SUM(ISNULL(d.JAN_SPOTS,0)),
		SUM(ISNULL(d.JAN_COMM_AMT,0)),
		SUM(ISNULL(d.JAN_REBATE_AMT,0)),
		SUM(ISNULL(d.JAN_LINE_NET,0)),
		SUM(ISNULL(d.JAN_VENDOR_TAX,0)),
		SUM(ISNULL(d.JAN_DISCOUNT,0)),
		SUM(ISNULL(d.JAN_CITY_TAX,0)),
		SUM(ISNULL(d.JAN_COUNTY_TAX,0)),
		SUM(ISNULL(d.JAN_STATE_TAX,0)),
		SUM(ISNULL(d.JAN_BILLING_AMT,0)),
		g.JAN_GLEXACT,
		g.JAN_GLEXACT_DEF,
		g.JAN_GLACODE_SALES,
		g.JAN_GLACODE_COS,
		g.JAN_GLACODE_WIP,
		g.JAN_GLACODE_STATE,
		g.JAN_GLACODE_COUNTY,
		g.JAN_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JAN_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JAN_AR_INV_NBR, d.JAN_AR_INV_SEQ, d.JAN_AR_TYPE,
		g.JAN_GLEXACT, g.JAN_GLEXACT_DEF, g.JAN_GLACODE_SALES, g.JAN_GLACODE_COS, g.JAN_GLACODE_WIP,
		g.JAN_GLACODE_STATE, g.JAN_GLACODE_COUNTY, g.JAN_GLACODE_CITY
END

--FEB RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		2 AS MONTH_IND,
		d.FEB_AR_INV_NBR,
		d.FEB_AR_INV_SEQ,
		d.FEB_AR_TYPE,
		SUM(ISNULL(d.FEB_SPOTS,0)),
		SUM(ISNULL(d.FEB_COMM_AMT,0)),
		SUM(ISNULL(d.FEB_REBATE_AMT,0)),
		SUM(ISNULL(d.FEB_LINE_NET,0)),
		SUM(ISNULL(d.FEB_VENDOR_TAX,0)),
		SUM(ISNULL(d.FEB_DISCOUNT,0)),
		SUM(ISNULL(d.FEB_CITY_TAX,0)),
		SUM(ISNULL(d.FEB_COUNTY_TAX,0)),
		SUM(ISNULL(d.FEB_STATE_TAX,0)),
		SUM(ISNULL(d.FEB_BILLING_AMT,0)),
		g.FEB_GLEXACT,
		g.FEB_GLEXACT_DEF,
		g.FEB_GLACODE_SALES,
		g.FEB_GLACODE_COS,
		g.FEB_GLACODE_WIP,
		g.FEB_GLACODE_STATE,
		g.FEB_GLACODE_COUNTY,
		g.FEB_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE FEB_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.FEB_AR_INV_NBR, d.FEB_AR_INV_SEQ, d.FEB_AR_TYPE,
		g.FEB_GLEXACT, g.FEB_GLEXACT_DEF, g.FEB_GLACODE_SALES, g.FEB_GLACODE_COS, g.FEB_GLACODE_WIP,
		g.FEB_GLACODE_STATE, g.FEB_GLACODE_COUNTY, g.FEB_GLACODE_CITY
END

--MAR RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		3 AS MONTH_IND,
		d.MAR_AR_INV_NBR,
		d.MAR_AR_INV_SEQ,
		d.MAR_AR_TYPE,
		SUM(ISNULL(d.MAR_SPOTS,0)),
		SUM(ISNULL(d.MAR_COMM_AMT,0)),
		SUM(ISNULL(d.MAR_REBATE_AMT,0)),
		SUM(ISNULL(d.MAR_LINE_NET,0)),
		SUM(ISNULL(d.MAR_VENDOR_TAX,0)),
		SUM(ISNULL(d.MAR_DISCOUNT,0)),
		SUM(ISNULL(d.MAR_CITY_TAX,0)),
		SUM(ISNULL(d.MAR_COUNTY_TAX,0)),
		SUM(ISNULL(d.MAR_STATE_TAX,0)),
		SUM(ISNULL(d.MAR_BILLING_AMT,0)),
		g.MAR_GLEXACT,
		g.MAR_GLEXACT_DEF,
		g.MAR_GLACODE_SALES,
		g.MAR_GLACODE_COS,
		g.MAR_GLACODE_WIP,
		g.MAR_GLACODE_STATE,
		g.MAR_GLACODE_COUNTY,
		g.MAR_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE MAR_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.MAR_AR_INV_NBR, d.MAR_AR_INV_SEQ, d.MAR_AR_TYPE,
		g.MAR_GLEXACT, g.MAR_GLEXACT_DEF, g.MAR_GLACODE_SALES, g.MAR_GLACODE_COS, g.MAR_GLACODE_WIP,
		g.MAR_GLACODE_STATE, g.MAR_GLACODE_COUNTY, g.MAR_GLACODE_CITY
END

--APR RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		4 AS MONTH_IND,
		d.APR_AR_INV_NBR,
		d.APR_AR_INV_SEQ,
		d.APR_AR_TYPE,
		SUM(ISNULL(d.APR_SPOTS,0)),
		SUM(ISNULL(d.APR_COMM_AMT,0)),
		SUM(ISNULL(d.APR_REBATE_AMT,0)),
		SUM(ISNULL(d.APR_LINE_NET,0)),
		SUM(ISNULL(d.APR_VENDOR_TAX,0)),
		SUM(ISNULL(d.APR_DISCOUNT,0)),
		SUM(ISNULL(d.APR_CITY_TAX,0)),
		SUM(ISNULL(d.APR_COUNTY_TAX,0)),
		SUM(ISNULL(d.APR_STATE_TAX,0)),
		SUM(ISNULL(d.APR_BILLING_AMT,0)),
		g.APR_GLEXACT,
		g.APR_GLEXACT_DEF,
		g.APR_GLACODE_SALES,
		g.APR_GLACODE_COS,
		g.APR_GLACODE_WIP,
		g.APR_GLACODE_STATE,
		g.APR_GLACODE_COUNTY,
		g.APR_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE APR_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.APR_AR_INV_NBR, d.APR_AR_INV_SEQ, d.APR_AR_TYPE,
		g.APR_GLEXACT, g.APR_GLEXACT_DEF, g.APR_GLACODE_SALES, g.APR_GLACODE_COS, g.APR_GLACODE_WIP,
		g.APR_GLACODE_STATE, g.APR_GLACODE_COUNTY, g.APR_GLACODE_CITY
END

--MAY RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		5 AS MONTH_IND,
		d.MAY_AR_INV_NBR,
		d.MAY_AR_INV_SEQ,
		d.MAY_AR_TYPE,
		SUM(ISNULL(d.MAY_SPOTS,0)),
		SUM(ISNULL(d.MAY_COMM_AMT,0)),
		SUM(ISNULL(d.MAY_REBATE_AMT,0)),
		SUM(ISNULL(d.MAY_LINE_NET,0)),
		SUM(ISNULL(d.MAY_VENDOR_TAX,0)),
		SUM(ISNULL(d.MAY_DISCOUNT,0)),
		SUM(ISNULL(d.MAY_CITY_TAX,0)),
		SUM(ISNULL(d.MAY_COUNTY_TAX,0)),
		SUM(ISNULL(d.MAY_STATE_TAX,0)),
		SUM(ISNULL(d.MAY_BILLING_AMT,0)),
		g.MAY_GLEXACT,
		g.MAY_GLEXACT_DEF,
		g.MAY_GLACODE_SALES,
		g.MAY_GLACODE_COS,
		g.MAY_GLACODE_WIP,
		g.MAY_GLACODE_STATE,
		g.MAY_GLACODE_COUNTY,
		g.MAY_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE MAY_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.MAY_AR_INV_NBR, d.MAY_AR_INV_SEQ, d.MAY_AR_TYPE,
		g.MAY_GLEXACT, g.MAY_GLEXACT_DEF, g.MAY_GLACODE_SALES, g.MAY_GLACODE_COS, g.MAY_GLACODE_WIP,
		g.MAY_GLACODE_STATE, g.MAY_GLACODE_COUNTY, g.MAY_GLACODE_CITY
END

--JUN RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		6 AS MONTH_IND,
		d.JUN_AR_INV_NBR,
		d.JUN_AR_INV_SEQ,
		d.JUN_AR_TYPE,
		SUM(ISNULL(d.JUN_SPOTS,0)),
		SUM(ISNULL(d.JUN_COMM_AMT,0)),
		SUM(ISNULL(d.JUN_REBATE_AMT,0)),
		SUM(ISNULL(d.JUN_LINE_NET,0)),
		SUM(ISNULL(d.JUN_VENDOR_TAX,0)),
		SUM(ISNULL(d.JUN_DISCOUNT,0)),
		SUM(ISNULL(d.JUN_CITY_TAX,0)),
		SUM(ISNULL(d.JUN_COUNTY_TAX,0)),
		SUM(ISNULL(d.JUN_STATE_TAX,0)),
		SUM(ISNULL(d.JUN_BILLING_AMT,0)),
		g.JUN_GLEXACT,
		g.JUN_GLEXACT_DEF,
		g.JUN_GLACODE_SALES,
		g.JUN_GLACODE_COS,
		g.JUN_GLACODE_WIP,
		g.JUN_GLACODE_STATE,
		g.JUN_GLACODE_COUNTY,
		g.JUN_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JUN_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JUN_AR_INV_NBR, d.JUN_AR_INV_SEQ, d.JUN_AR_TYPE,
		g.JUN_GLEXACT, g.JUN_GLEXACT_DEF, g.JUN_GLACODE_SALES, g.JUN_GLACODE_COS, g.JUN_GLACODE_WIP,
		g.JUN_GLACODE_STATE, g.JUN_GLACODE_COUNTY, g.JUN_GLACODE_CITY
END

--JUL RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		7 AS MONTH_IND,
		d.JUL_AR_INV_NBR,
		d.JUL_AR_INV_SEQ,
		d.JUL_AR_TYPE,
		SUM(ISNULL(d.JUL_SPOTS,0)),
		SUM(ISNULL(d.JUL_COMM_AMT,0)),
		SUM(ISNULL(d.JUL_REBATE_AMT,0)),
		SUM(ISNULL(d.JUL_LINE_NET,0)),
		SUM(ISNULL(d.JUL_VENDOR_TAX,0)),
		SUM(ISNULL(d.JUL_DISCOUNT,0)),
		SUM(ISNULL(d.JUL_CITY_TAX,0)),
		SUM(ISNULL(d.JUL_COUNTY_TAX,0)),
		SUM(ISNULL(d.JUL_STATE_TAX,0)),
		SUM(ISNULL(d.JUL_BILLING_AMT,0)),
		g.JUL_GLEXACT,
		g.JUL_GLEXACT_DEF,
		g.JUL_GLACODE_SALES,
		g.JUL_GLACODE_COS,
		g.JUL_GLACODE_WIP,
		g.JUL_GLACODE_STATE,
		g.JUL_GLACODE_COUNTY,
		g.JUL_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JUL_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JUL_AR_INV_NBR, d.JUL_AR_INV_SEQ, d.JUL_AR_TYPE,
		g.JUL_GLEXACT, g.JUL_GLEXACT_DEF, g.JUL_GLACODE_SALES, g.JUL_GLACODE_COS, g.JUL_GLACODE_WIP,
		g.JUL_GLACODE_STATE, g.JUL_GLACODE_COUNTY, g.JUL_GLACODE_CITY
END

--AUG RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		8 AS MONTH_IND,
		d.AUG_AR_INV_NBR,
		d.AUG_AR_INV_SEQ,
		d.AUG_AR_TYPE,
		SUM(ISNULL(d.AUG_SPOTS,0)),
		SUM(ISNULL(d.AUG_COMM_AMT,0)),
		SUM(ISNULL(d.AUG_REBATE_AMT,0)),
		SUM(ISNULL(d.AUG_LINE_NET,0)),
		SUM(ISNULL(d.AUG_VENDOR_TAX,0)),
		SUM(ISNULL(d.AUG_DISCOUNT,0)),
		SUM(ISNULL(d.AUG_CITY_TAX,0)),
		SUM(ISNULL(d.AUG_COUNTY_TAX,0)),
		SUM(ISNULL(d.AUG_STATE_TAX,0)),
		SUM(ISNULL(d.AUG_BILLING_AMT,0)),
		g.AUG_GLEXACT,
		g.AUG_GLEXACT_DEF,
		g.AUG_GLACODE_SALES,
		g.AUG_GLACODE_COS,
		g.AUG_GLACODE_WIP,
		g.AUG_GLACODE_STATE,
		g.AUG_GLACODE_COUNTY,
		g.AUG_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE AUG_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.AUG_AR_INV_NBR, d.AUG_AR_INV_SEQ, d.AUG_AR_TYPE,
		g.AUG_GLEXACT, g.AUG_GLEXACT_DEF, g.AUG_GLACODE_SALES, g.AUG_GLACODE_COS, g.AUG_GLACODE_WIP,
		g.AUG_GLACODE_STATE, g.AUG_GLACODE_COUNTY, g.AUG_GLACODE_CITY
END

--SEP RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		9 AS MONTH_IND,
		d.SEP_AR_INV_NBR,
		d.SEP_AR_INV_SEQ,
		d.SEP_AR_TYPE,
		SUM(ISNULL(d.SEP_SPOTS,0)),
		SUM(ISNULL(d.SEP_COMM_AMT,0)),
		SUM(ISNULL(d.SEP_REBATE_AMT,0)),
		SUM(ISNULL(d.SEP_LINE_NET,0)),
		SUM(ISNULL(d.SEP_VENDOR_TAX,0)),
		SUM(ISNULL(d.SEP_DISCOUNT,0)),
		SUM(ISNULL(d.SEP_CITY_TAX,0)),
		SUM(ISNULL(d.SEP_COUNTY_TAX,0)),
		SUM(ISNULL(d.SEP_STATE_TAX,0)),
		SUM(ISNULL(d.SEP_BILLING_AMT,0)),
		g.SEP_GLEXACT,
		g.SEP_GLEXACT_DEF,
		g.SEP_GLACODE_SALES,
		g.SEP_GLACODE_COS,
		g.SEP_GLACODE_WIP,
		g.SEP_GLACODE_STATE,
		g.SEP_GLACODE_COUNTY,
		g.SEP_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE SEP_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.SEP_AR_INV_NBR, d.SEP_AR_INV_SEQ, d.SEP_AR_TYPE,
		g.SEP_GLEXACT, g.SEP_GLEXACT_DEF, g.SEP_GLACODE_SALES, g.SEP_GLACODE_COS, g.SEP_GLACODE_WIP,
		g.SEP_GLACODE_STATE, g.SEP_GLACODE_COUNTY, g.SEP_GLACODE_CITY
END

--OCT RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		10 AS MONTH_IND,
		d.OCT_AR_INV_NBR,
		d.OCT_AR_INV_SEQ,
		d.OCT_AR_TYPE,
		SUM(ISNULL(d.OCT_SPOTS,0)),
		SUM(ISNULL(d.OCT_COMM_AMT,0)),
		SUM(ISNULL(d.OCT_REBATE_AMT,0)),
		SUM(ISNULL(d.OCT_LINE_NET,0)),
		SUM(ISNULL(d.OCT_VENDOR_TAX,0)),
		SUM(ISNULL(d.OCT_DISCOUNT,0)),
		SUM(ISNULL(d.OCT_CITY_TAX,0)),
		SUM(ISNULL(d.OCT_COUNTY_TAX,0)),
		SUM(ISNULL(d.OCT_STATE_TAX,0)),
		SUM(ISNULL(d.OCT_BILLING_AMT,0)),
		g.OCT_GLEXACT,
		g.OCT_GLEXACT_DEF,
		g.OCT_GLACODE_SALES,
		g.OCT_GLACODE_COS,
		g.OCT_GLACODE_WIP,
		g.OCT_GLACODE_STATE,
		g.OCT_GLACODE_COUNTY,
		g.OCT_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE OCT_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.OCT_AR_INV_NBR, d.OCT_AR_INV_SEQ, d.OCT_AR_TYPE,
		g.OCT_GLEXACT, g.OCT_GLEXACT_DEF, g.OCT_GLACODE_SALES, g.OCT_GLACODE_COS, g.OCT_GLACODE_WIP,
		g.OCT_GLACODE_STATE, g.OCT_GLACODE_COUNTY, g.OCT_GLACODE_CITY
END

--NOV RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		11 AS MONTH_IND,
		d.NOV_AR_INV_NBR,
		d.NOV_AR_INV_SEQ,
		d.NOV_AR_TYPE,
		SUM(ISNULL(d.NOV_SPOTS,0)),
		SUM(ISNULL(d.NOV_COMM_AMT,0)),
		SUM(ISNULL(d.NOV_REBATE_AMT,0)),
		SUM(ISNULL(d.NOV_LINE_NET,0)),
		SUM(ISNULL(d.NOV_VENDOR_TAX,0)),
		SUM(ISNULL(d.NOV_DISCOUNT,0)),
		SUM(ISNULL(d.NOV_CITY_TAX,0)),
		SUM(ISNULL(d.NOV_COUNTY_TAX,0)),
		SUM(ISNULL(d.NOV_STATE_TAX,0)),
		SUM(ISNULL(d.NOV_BILLING_AMT,0)),
		g.NOV_GLEXACT,
		g.NOV_GLEXACT_DEF,
		g.NOV_GLACODE_SALES,
		g.NOV_GLACODE_COS,
		g.NOV_GLACODE_WIP,
		g.NOV_GLACODE_STATE,
		g.NOV_GLACODE_COUNTY,
		g.NOV_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE NOV_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.NOV_AR_INV_NBR, d.NOV_AR_INV_SEQ, d.NOV_AR_TYPE,
		g.NOV_GLEXACT, g.NOV_GLEXACT_DEF, g.NOV_GLACODE_SALES, g.NOV_GLACODE_COS, g.NOV_GLACODE_WIP,
		g.NOV_GLACODE_STATE, g.NOV_GLACODE_COUNTY, g.NOV_GLACODE_CITY
END

--DEC RADIO
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		12 AS MONTH_IND,
		d.DEC_AR_INV_NBR,
		d.DEC_AR_INV_SEQ,
		d.DEC_AR_TYPE,
		SUM(ISNULL(d.DEC_SPOTS,0)),
		SUM(ISNULL(d.DEC_COMM_AMT,0)),
		SUM(ISNULL(d.DEC_REBATE_AMT,0)),
		SUM(ISNULL(d.DEC_LINE_NET,0)),
		SUM(ISNULL(d.DEC_VENDOR_TAX,0)),
		SUM(ISNULL(d.DEC_DISCOUNT,0)),
		SUM(ISNULL(d.DEC_CITY_TAX,0)),
		SUM(ISNULL(d.DEC_COUNTY_TAX,0)),
		SUM(ISNULL(d.DEC_STATE_TAX,0)),
		SUM(ISNULL(d.DEC_BILLING_AMT,0)),
		g.DEC_GLEXACT,
		g.DEC_GLEXACT_DEF,
		g.DEC_GLACODE_SALES,
		g.DEC_GLACODE_COS,
		g.DEC_GLACODE_WIP,
		g.DEC_GLACODE_STATE,
		g.DEC_GLACODE_COUNTY,
		g.DEC_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.RADIO_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.RADIO_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE DEC_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.DEC_AR_INV_NBR, d.DEC_AR_INV_SEQ, d.DEC_AR_TYPE,
		g.DEC_GLEXACT, g.DEC_GLEXACT_DEF, g.DEC_GLACODE_SALES, g.DEC_GLACODE_COS, g.DEC_GLACODE_WIP,
		g.DEC_GLACODE_STATE, g.DEC_GLACODE_COUNTY, g.DEC_GLACODE_CITY
END
--END RADIO_DATA

--BEGIN TV_DATA
--JAN TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		1 AS MONTH_IND,
		d.JAN_AR_INV_NBR,
		d.JAN_AR_INV_SEQ,
		d.JAN_AR_TYPE,
		SUM(ISNULL(d.JAN_SPOTS,0)),
		SUM(ISNULL(d.JAN_COMM_AMT,0)),
		SUM(ISNULL(d.JAN_REBATE_AMT,0)),
		SUM(ISNULL(d.JAN_LINE_NET,0)),
		SUM(ISNULL(d.JAN_VENDOR_TAX,0)),
		SUM(ISNULL(d.JAN_DISCOUNT,0)),
		SUM(ISNULL(d.JAN_CITY_TAX,0)),
		SUM(ISNULL(d.JAN_COUNTY_TAX,0)),
		SUM(ISNULL(d.JAN_STATE_TAX,0)),
		SUM(ISNULL(d.JAN_BILLING_AMT,0)),
		g.JAN_GLEXACT,
		g.JAN_GLEXACT_DEF,
		g.JAN_GLACODE_SALES,
		g.JAN_GLACODE_COS,
		g.JAN_GLACODE_WIP,
		g.JAN_GLACODE_STATE,
		g.JAN_GLACODE_COUNTY,
		g.JAN_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JAN_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JAN_AR_INV_NBR, d.JAN_AR_INV_SEQ, d.JAN_AR_TYPE,
		g.JAN_GLEXACT, g.JAN_GLEXACT_DEF, g.JAN_GLACODE_SALES, g.JAN_GLACODE_COS, g.JAN_GLACODE_WIP,
		g.JAN_GLACODE_STATE, g.JAN_GLACODE_COUNTY, g.JAN_GLACODE_CITY
END

--FEB TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		2 AS MONTH_IND,
		d.FEB_AR_INV_NBR,
		d.FEB_AR_INV_SEQ,
		d.FEB_AR_TYPE,
		SUM(ISNULL(d.FEB_SPOTS,0)),
		SUM(ISNULL(d.FEB_COMM_AMT,0)),
		SUM(ISNULL(d.FEB_REBATE_AMT,0)),
		SUM(ISNULL(d.FEB_LINE_NET,0)),
		SUM(ISNULL(d.FEB_VENDOR_TAX,0)),
		SUM(ISNULL(d.FEB_DISCOUNT,0)),
		SUM(ISNULL(d.FEB_CITY_TAX,0)),
		SUM(ISNULL(d.FEB_COUNTY_TAX,0)),
		SUM(ISNULL(d.FEB_STATE_TAX,0)),
		SUM(ISNULL(d.FEB_BILLING_AMT,0)),
		g.FEB_GLEXACT,
		g.FEB_GLEXACT_DEF,
		g.FEB_GLACODE_SALES,
		g.FEB_GLACODE_COS,
		g.FEB_GLACODE_WIP,
		g.FEB_GLACODE_STATE,
		g.FEB_GLACODE_COUNTY,
		g.FEB_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE FEB_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.FEB_AR_INV_NBR, d.FEB_AR_INV_SEQ, d.FEB_AR_TYPE,
		g.FEB_GLEXACT, g.FEB_GLEXACT_DEF, g.FEB_GLACODE_SALES, g.FEB_GLACODE_COS, g.FEB_GLACODE_WIP,
		g.FEB_GLACODE_STATE, g.FEB_GLACODE_COUNTY, g.FEB_GLACODE_CITY
END

--MAR TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		3 AS MONTH_IND,
		d.MAR_AR_INV_NBR,
		d.MAR_AR_INV_SEQ,
		d.MAR_AR_TYPE,
		SUM(ISNULL(d.MAR_SPOTS,0)),
		SUM(ISNULL(d.MAR_COMM_AMT,0)),
		SUM(ISNULL(d.MAR_REBATE_AMT,0)),
		SUM(ISNULL(d.MAR_LINE_NET,0)),
		SUM(ISNULL(d.MAR_VENDOR_TAX,0)),
		SUM(ISNULL(d.MAR_DISCOUNT,0)),
		SUM(ISNULL(d.MAR_CITY_TAX,0)),
		SUM(ISNULL(d.MAR_COUNTY_TAX,0)),
		SUM(ISNULL(d.MAR_STATE_TAX,0)),
		SUM(ISNULL(d.MAR_BILLING_AMT,0)),
		g.MAR_GLEXACT,
		g.MAR_GLEXACT_DEF,
		g.MAR_GLACODE_SALES,
		g.MAR_GLACODE_COS,
		g.MAR_GLACODE_WIP,
		g.MAR_GLACODE_STATE,
		g.MAR_GLACODE_COUNTY,
		g.MAR_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE MAR_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.MAR_AR_INV_NBR, d.MAR_AR_INV_SEQ, d.MAR_AR_TYPE,
		g.MAR_GLEXACT, g.MAR_GLEXACT_DEF, g.MAR_GLACODE_SALES, g.MAR_GLACODE_COS, g.MAR_GLACODE_WIP,
		g.MAR_GLACODE_STATE, g.MAR_GLACODE_COUNTY, g.MAR_GLACODE_CITY
END

--APR TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		4 AS MONTH_IND,
		d.APR_AR_INV_NBR,
		d.APR_AR_INV_SEQ,
		d.APR_AR_TYPE,
		SUM(ISNULL(d.APR_SPOTS,0)),
		SUM(ISNULL(d.APR_COMM_AMT,0)),
		SUM(ISNULL(d.APR_REBATE_AMT,0)),
		SUM(ISNULL(d.APR_LINE_NET,0)),
		SUM(ISNULL(d.APR_VENDOR_TAX,0)),
		SUM(ISNULL(d.APR_DISCOUNT,0)),
		SUM(ISNULL(d.APR_CITY_TAX,0)),
		SUM(ISNULL(d.APR_COUNTY_TAX,0)),
		SUM(ISNULL(d.APR_STATE_TAX,0)),
		SUM(ISNULL(d.APR_BILLING_AMT,0)),
		g.APR_GLEXACT,
		g.APR_GLEXACT_DEF,
		g.APR_GLACODE_SALES,
		g.APR_GLACODE_COS,
		g.APR_GLACODE_WIP,
		g.APR_GLACODE_STATE,
		g.APR_GLACODE_COUNTY,
		g.APR_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE APR_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.APR_AR_INV_NBR, d.APR_AR_INV_SEQ, d.APR_AR_TYPE,
		g.APR_GLEXACT, g.APR_GLEXACT_DEF, g.APR_GLACODE_SALES, g.APR_GLACODE_COS, g.APR_GLACODE_WIP,
		g.APR_GLACODE_STATE, g.APR_GLACODE_COUNTY, g.APR_GLACODE_CITY
END

--MAY TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		5 AS MONTH_IND,
		d.MAY_AR_INV_NBR,
		d.MAY_AR_INV_SEQ,
		d.MAY_AR_TYPE,
		SUM(ISNULL(d.MAY_SPOTS,0)),
		SUM(ISNULL(d.MAY_COMM_AMT,0)),
		SUM(ISNULL(d.MAY_REBATE_AMT,0)),
		SUM(ISNULL(d.MAY_LINE_NET,0)),
		SUM(ISNULL(d.MAY_VENDOR_TAX,0)),
		SUM(ISNULL(d.MAY_DISCOUNT,0)),
		SUM(ISNULL(d.MAY_CITY_TAX,0)),
		SUM(ISNULL(d.MAY_COUNTY_TAX,0)),
		SUM(ISNULL(d.MAY_STATE_TAX,0)),
		SUM(ISNULL(d.MAY_BILLING_AMT,0)),
		g.MAY_GLEXACT,
		g.MAY_GLEXACT_DEF,
		g.MAY_GLACODE_SALES,
		g.MAY_GLACODE_COS,
		g.MAY_GLACODE_WIP,
		g.MAY_GLACODE_STATE,
		g.MAY_GLACODE_COUNTY,
		g.MAY_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE MAY_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO, d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.MAY_AR_INV_NBR, d.MAY_AR_INV_SEQ, d.MAY_AR_TYPE,
		g.MAY_GLEXACT, g.MAY_GLEXACT_DEF, g.MAY_GLACODE_SALES, g.MAY_GLACODE_COS, g.MAY_GLACODE_WIP,
		g.MAY_GLACODE_STATE, g.MAY_GLACODE_COUNTY, g.MAY_GLACODE_CITY
END

--JUN TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		6 AS MONTH_IND,
		d.JUN_AR_INV_NBR,
		d.JUN_AR_INV_SEQ,
		d.JUN_AR_TYPE,
		SUM(ISNULL(d.JUN_SPOTS,0)),
		SUM(ISNULL(d.JUN_COMM_AMT,0)),
		SUM(ISNULL(d.JUN_REBATE_AMT,0)),
		SUM(ISNULL(d.JUN_LINE_NET,0)),
		SUM(ISNULL(d.JUN_VENDOR_TAX,0)),
		SUM(ISNULL(d.JUN_DISCOUNT,0)),
		SUM(ISNULL(d.JUN_CITY_TAX,0)),
		SUM(ISNULL(d.JUN_COUNTY_TAX,0)),
		SUM(ISNULL(d.JUN_STATE_TAX,0)),
		SUM(ISNULL(d.JUN_BILLING_AMT,0)),
		g.JUN_GLEXACT,
		g.JUN_GLEXACT_DEF,
		g.JUN_GLACODE_SALES,
		g.JUN_GLACODE_COS,
		g.JUN_GLACODE_WIP,
		g.JUN_GLACODE_STATE,
		g.JUN_GLACODE_COUNTY,
		g.JUN_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JUN_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JUN_AR_INV_NBR, d.JUN_AR_INV_SEQ, d.JUN_AR_TYPE,
		g.JUN_GLEXACT, g.JUN_GLEXACT_DEF, g.JUN_GLACODE_SALES, g.JUN_GLACODE_COS, g.JUN_GLACODE_WIP,
		g.JUN_GLACODE_STATE, g.JUN_GLACODE_COUNTY, g.JUN_GLACODE_CITY
END

--JUL TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		7 AS MONTH_IND,
		d.JUL_AR_INV_NBR,
		d.JUL_AR_INV_SEQ,
		d.JUL_AR_TYPE,
		SUM(ISNULL(d.JUL_SPOTS,0)),
		SUM(ISNULL(d.JUL_COMM_AMT,0)),
		SUM(ISNULL(d.JUL_REBATE_AMT,0)),
		SUM(ISNULL(d.JUL_LINE_NET,0)),
		SUM(ISNULL(d.JUL_VENDOR_TAX,0)),
		SUM(ISNULL(d.JUL_DISCOUNT,0)),
		SUM(ISNULL(d.JUL_CITY_TAX,0)),
		SUM(ISNULL(d.JUL_COUNTY_TAX,0)),
		SUM(ISNULL(d.JUL_STATE_TAX,0)),
		SUM(ISNULL(d.JUL_BILLING_AMT,0)),
		g.JUL_GLEXACT,
		g.JUL_GLEXACT_DEF,
		g.JUL_GLACODE_SALES,
		g.JUL_GLACODE_COS,
		g.JUL_GLACODE_WIP,
		g.JUL_GLACODE_STATE,
		g.JUL_GLACODE_COUNTY,
		g.JUL_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE JUL_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.JUL_AR_INV_NBR, d.JUL_AR_INV_SEQ, d.JUL_AR_TYPE,
		g.JUL_GLEXACT, g.JUL_GLEXACT_DEF, g.JUL_GLACODE_SALES, g.JUL_GLACODE_COS, g.JUL_GLACODE_WIP,
		g.JUL_GLACODE_STATE, g.JUL_GLACODE_COUNTY, g.JUL_GLACODE_CITY
END

--AUG TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		8 AS MONTH_IND,
		d.AUG_AR_INV_NBR,
		d.AUG_AR_INV_SEQ,
		d.AUG_AR_TYPE,
		SUM(ISNULL(d.AUG_SPOTS,0)),
		SUM(ISNULL(d.AUG_COMM_AMT,0)),
		SUM(ISNULL(d.AUG_REBATE_AMT,0)),
		SUM(ISNULL(d.AUG_LINE_NET,0)),
		SUM(ISNULL(d.AUG_VENDOR_TAX,0)),
		SUM(ISNULL(d.AUG_DISCOUNT,0)),
		SUM(ISNULL(d.AUG_CITY_TAX,0)),
		SUM(ISNULL(d.AUG_COUNTY_TAX,0)),
		SUM(ISNULL(d.AUG_STATE_TAX,0)),
		SUM(ISNULL(d.AUG_BILLING_AMT,0)),
		g.AUG_GLEXACT,
		g.AUG_GLEXACT_DEF,
		g.AUG_GLACODE_SALES,
		g.AUG_GLACODE_COS,
		g.AUG_GLACODE_WIP,
		g.AUG_GLACODE_STATE,
		g.AUG_GLACODE_COUNTY,
		g.AUG_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE AUG_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.AUG_AR_INV_NBR, d.AUG_AR_INV_SEQ, d.AUG_AR_TYPE,
		g.AUG_GLEXACT, g.AUG_GLEXACT_DEF, g.AUG_GLACODE_SALES, g.AUG_GLACODE_COS, g.AUG_GLACODE_WIP,
		g.AUG_GLACODE_STATE, g.AUG_GLACODE_COUNTY, g.AUG_GLACODE_CITY
END

--SEP TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		9 AS MONTH_IND,
		d.SEP_AR_INV_NBR,
		d.SEP_AR_INV_SEQ,
		d.SEP_AR_TYPE,
		SUM(ISNULL(d.SEP_SPOTS,0)),
		SUM(ISNULL(d.SEP_COMM_AMT,0)),
		SUM(ISNULL(d.SEP_REBATE_AMT,0)),
		SUM(ISNULL(d.SEP_LINE_NET,0)),
		SUM(ISNULL(d.SEP_VENDOR_TAX,0)),
		SUM(ISNULL(d.SEP_DISCOUNT,0)),
		SUM(ISNULL(d.SEP_CITY_TAX,0)),
		SUM(ISNULL(d.SEP_COUNTY_TAX,0)),
		SUM(ISNULL(d.SEP_STATE_TAX,0)),
		SUM(ISNULL(d.SEP_BILLING_AMT,0)),
		g.SEP_GLEXACT,
		g.SEP_GLEXACT_DEF,
		g.SEP_GLACODE_SALES,
		g.SEP_GLACODE_COS,
		g.SEP_GLACODE_WIP,
		g.SEP_GLACODE_STATE,
		g.SEP_GLACODE_COUNTY,
		g.SEP_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE SEP_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.SEP_AR_INV_NBR, d.SEP_AR_INV_SEQ, d.SEP_AR_TYPE,
		g.SEP_GLEXACT, g.SEP_GLEXACT_DEF, g.SEP_GLACODE_SALES, g.SEP_GLACODE_COS, g.SEP_GLACODE_WIP,
		g.SEP_GLACODE_STATE, g.SEP_GLACODE_COUNTY, g.SEP_GLACODE_CITY
END

--OCT TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		10 AS MONTH_IND,
		d.OCT_AR_INV_NBR,
		d.OCT_AR_INV_SEQ,
		d.OCT_AR_TYPE,
		SUM(ISNULL(d.OCT_SPOTS,0)),
		SUM(ISNULL(d.OCT_COMM_AMT,0)),
		SUM(ISNULL(d.OCT_REBATE_AMT,0)),
		SUM(ISNULL(d.OCT_LINE_NET,0)),
		SUM(ISNULL(d.OCT_VENDOR_TAX,0)),
		SUM(ISNULL(d.OCT_DISCOUNT,0)),
		SUM(ISNULL(d.OCT_CITY_TAX,0)),
		SUM(ISNULL(d.OCT_COUNTY_TAX,0)),
		SUM(ISNULL(d.OCT_STATE_TAX,0)),
		SUM(ISNULL(d.OCT_BILLING_AMT,0)),
		g.OCT_GLEXACT,
		g.OCT_GLEXACT_DEF,
		g.OCT_GLACODE_SALES,
		g.OCT_GLACODE_COS,
		g.OCT_GLACODE_WIP,
		g.OCT_GLACODE_STATE,
		g.OCT_GLACODE_COUNTY,
		g.OCT_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE OCT_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.OCT_AR_INV_NBR, d.OCT_AR_INV_SEQ, d.OCT_AR_TYPE,
		g.OCT_GLEXACT, g.OCT_GLEXACT_DEF, g.OCT_GLACODE_SALES, g.OCT_GLACODE_COS, g.OCT_GLACODE_WIP,
		g.OCT_GLACODE_STATE, g.OCT_GLACODE_COUNTY, g.OCT_GLACODE_CITY
END

--NOV TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		11 AS MONTH_IND,
		d.NOV_AR_INV_NBR,
		d.NOV_AR_INV_SEQ,
		d.NOV_AR_TYPE,
		SUM(ISNULL(d.NOV_SPOTS,0)),
		SUM(ISNULL(d.NOV_COMM_AMT,0)),
		SUM(ISNULL(d.NOV_REBATE_AMT,0)),
		SUM(ISNULL(d.NOV_LINE_NET,0)),
		SUM(ISNULL(d.NOV_VENDOR_TAX,0)),
		SUM(ISNULL(d.NOV_DISCOUNT,0)),
		SUM(ISNULL(d.NOV_CITY_TAX,0)),
		SUM(ISNULL(d.NOV_COUNTY_TAX,0)),
		SUM(ISNULL(d.NOV_STATE_TAX,0)),
		SUM(ISNULL(d.NOV_BILLING_AMT,0)),
		g.NOV_GLEXACT,
		g.NOV_GLEXACT_DEF,
		g.NOV_GLACODE_SALES,
		g.NOV_GLACODE_COS,
		g.NOV_GLACODE_WIP,
		g.NOV_GLACODE_STATE,
		g.NOV_GLACODE_COUNTY,
		g.NOV_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE NOV_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.NOV_AR_INV_NBR, d.NOV_AR_INV_SEQ, d.NOV_AR_TYPE,
		g.NOV_GLEXACT, g.NOV_GLEXACT_DEF, g.NOV_GLACODE_SALES, g.NOV_GLACODE_COS, g.NOV_GLACODE_WIP,
		g.NOV_GLACODE_STATE, g.NOV_GLACODE_COUNTY, g.NOV_GLACODE_CITY
END

--DEC TV
BEGIN
	INSERT INTO #bcst_data
		SELECT h.ORDER_TYPE,
		h.ORDER_NBR,
		h.BILL_COOP_CODE,
		h.CL_CODE,
		h.DIV_CODE,
		h.PRD_CODE,
		h.MEDIA_TYPE,
		h.CMP_IDENTIFIER,
		h.CLIENT_PO,
		h.BILL_TYPE_FLAG,
		h.MARKET_CODE,
		h.FLIGHT_FROM,
		h.FLIGHT_TO,
		d.LINE_NBR,
		d.REV_NBR,
		d.SEQ_NBR,
		d.BRDCAST_YEAR,
		12 AS MONTH_IND,
		d.DEC_AR_INV_NBR,
		d.DEC_AR_INV_SEQ,
		d.DEC_AR_TYPE,
		SUM(ISNULL(d.DEC_SPOTS,0)),
		SUM(ISNULL(d.DEC_COMM_AMT,0)),
		SUM(ISNULL(d.DEC_REBATE_AMT,0)),
		SUM(ISNULL(d.DEC_LINE_NET,0)),
		SUM(ISNULL(d.DEC_VENDOR_TAX,0)),
		SUM(ISNULL(d.DEC_DISCOUNT,0)),
		SUM(ISNULL(d.DEC_CITY_TAX,0)),
		SUM(ISNULL(d.DEC_COUNTY_TAX,0)),
		SUM(ISNULL(d.DEC_STATE_TAX,0)),
		SUM(ISNULL(d.DEC_BILLING_AMT,0)),
		g.DEC_GLEXACT,
		g.DEC_GLEXACT_DEF,
		g.DEC_GLACODE_SALES,
		g.DEC_GLACODE_COS,
		g.DEC_GLACODE_WIP,
		g.DEC_GLACODE_STATE,
		g.DEC_GLACODE_COUNTY,
		g.DEC_GLACODE_CITY
	FROM #bcst_hdr AS h
	INNER JOIN dbo.TV_DETAIL1 AS d
		ON h.ORDER_NBR = d.ORDER_NBR
	INNER JOIN dbo.TV_GL AS g
		ON d.ORDER_NBR = g.ORDER_NBR
		AND d.LINE_NBR = g.LINE_NBR
		AND d.REV_NBR = g.REV_NBR
		AND d.SEQ_NBR = g.SEQ_NBR
		AND d.BRDCAST_YEAR = g.BRDCAST_YEAR
	WHERE DEC_AR_INV_NBR IS NOT NULL
	GROUP BY h.ORDER_TYPE, h.ORDER_NBR, h.BILL_COOP_CODE, h.CL_CODE, h.DIV_CODE, h.PRD_CODE,
		h.MEDIA_TYPE, h.CMP_IDENTIFIER,	h.CLIENT_PO, h.BILL_TYPE_FLAG, h.MARKET_CODE, h.FLIGHT_FROM, h.FLIGHT_TO,
		d.LINE_NBR, d.REV_NBR, d.SEQ_NBR, d.BRDCAST_YEAR, d.DEC_AR_INV_NBR, d.DEC_AR_INV_SEQ, d.DEC_AR_TYPE,
		g.DEC_GLEXACT, g.DEC_GLEXACT_DEF, g.DEC_GLACODE_SALES, g.DEC_GLACODE_COS, g.DEC_GLACODE_WIP,
		g.DEC_GLACODE_STATE, g.DEC_GLACODE_COUNTY, g.DEC_GLACODE_CITY
END
--END TV_DATA

--============================================================================
--END GET DATA
--============================================================================

SELECT * FROM #bcst_data

END
GO

