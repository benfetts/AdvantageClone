CREATE PROCEDURE [dbo].[advsp_comscore_precache_demographics]
	@COMSCORE_PRECACHE_MARKET_ID int
AS

SELECT 
	[IsSelected] = CAST(CASE WHEN b.COMSCORE_DEMO_NUMBER IS NOT NULL THEN 1 ELSE 0 END as bit),
    [Description] = a.[DESCRIPTION],
    [ComscoreDemoNumber] = a.COMSCORE_DEMO_NUMBER,
    [MarketDemoID] = b.COMSCORE_PRECACHE_MARKET_DEMOGRAPHIC_ID 
FROM dbo.MEDIA_DEMO a
	LEFT OUTER JOIN dbo.COMSCORE_PRECACHE_MARKET_DEMOGRAPHIC b ON b.COMSCORE_PRECACHE_MARKET_ID = @COMSCORE_PRECACHE_MARKET_ID AND a.COMSCORE_DEMO_NUMBER = b.COMSCORE_DEMO_NUMBER 
WHERE a.COMSCORE_DEMO_NUMBER IS NOT NULL
AND a.IS_INACTIVE = 0
ORDER BY a.COMSCORE_GROUP_NUMBER, a.COMSCORE_SORT_ORDER 
