CREATE PROCEDURE advsp_media_manager_ad_serving_additional_ad_server_size_ids
	@ORDER_NBR int,
	@LINE_NUMBERS varchar(max),
	@AD_SIZE_CODE varchar(6)
AS

SELECT DISTINCT AD_SIZE.AD_SERVER_SIZE_ID
FROM dbo.INTERNET_DETAIL id
	INNER JOIN dbo.INTERNET_PACKAGE_DETAIL ipd ON id.ORDER_NBR = ipd.ORDER_NBR AND id.LINE_NBR = ipd.LINE_NBR AND ipd.ACTIVE_REV = 1
	INNER JOIN dbo.AD_SIZE ON AD_SIZE.SIZE_CODE = ipd.AD_SIZE_CODE 
WHERE id.ORDER_NBR = @ORDER_NBR 
AND id.LINE_NBR IN (SELECT * FROM dbo.udf_split_list(@LINE_NUMBERS, ',')) 
AND ipd.AD_SIZE_CODE <> @AD_SIZE_CODE

GO
