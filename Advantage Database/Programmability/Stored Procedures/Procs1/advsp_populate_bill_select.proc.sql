
CREATE PROCEDURE [dbo].[advsp_populate_bill_select]
	@bill_user_in varchar(100),
	@ret_val integer OUTPUT 
AS

SET NOCOUNT ON

DECLARE @billing_exists BIT

SELECT @billing_exists = ( SELECT COUNT(*) FROM dbo.BILLING WHERE BILLING_USER = @bill_user_in )

IF ( @billing_exists = 1 ) 
BEGIN
	 SELECT CONVERT( VARCHAR(10), INV_DATE, 101 ), POST_PERIOD, MEDIA, PRODUCTION, SELECTION, SELECT_BY, 
			SERVICE_FEES, INV_ASSIGN, M_SELECT_BY, CONVERT( VARCHAR(10), M_CUTOFF_DATE, 101 ), 
			CONVERT( VARCHAR(10), M_CUTOFF_MONTH1, 101 ), CONVERT( VARCHAR(10), M_CUTOFF_MONTH2, 101 ), 
			NEWSPAPER, MAGAZINE, RADIO, TELEVISION, OUTDOOR, INTERNET,
			CONVERT( VARCHAR(10), P_EMPTIME_DATE, 101 ), CONVERT( VARCHAR(10), P_INCOMEONLY_DATE, 101 ), 
			CONVERT( VARCHAR(10), P_ADVBILL_DATE, 101 ), P_CUTOFF_PP, INC_NO_DTL, AB_JOBS_ONLY 
	   FROM dbo.BILLING 
	  WHERE BILLING_USER = @bill_user_in
	  
	SELECT @ret_val = 1
END	  
ELSE
BEGIN	
	 SELECT CONVERT( VARCHAR(10), GETDATE( ), 101 ), NULL, 0, 1, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, 
			NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1, 0
			
	SELECT @ret_val = 0		
END			 
