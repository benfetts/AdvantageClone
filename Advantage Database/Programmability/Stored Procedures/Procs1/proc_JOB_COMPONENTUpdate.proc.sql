

CREATE PROCEDURE [dbo].[proc_JOB_COMPONENTUpdate]
(
	@JOB_NUMBER int,
	@JOB_COMPONENT_NBR smallint,
	@JOB_BILL_HOLD smallint = NULL,
	@EMP_CODE varchar(6),
	@JOB_COMP_DATE smalldatetime = NULL,
	@JOB_FIRST_USE_DATE smalldatetime = NULL,
	@START_DATE smalldatetime = NULL,
	@JOB_AD_SIZE varchar(60) = NULL,
	@JOB_SPEC_TYPE varchar(1),
	@DP_TM_CODE varchar(4) = NULL,
	@JOB_MARKUP_PCT decimal(7,3) = NULL,
	@CREATIVE_INSTR text = NULL,
	@JOB_LAYOUT_THUMB smallint = NULL,
	@JOB_LAYOUT_ROUGH smallint = NULL,
	@JOB_LAYOUT_COMP smallint = NULL,
	@JOB_LAYOUT_NONE smallint = NULL,
	@JOB_LAYOUT_SPECIAL smallint = NULL,
	@JOB_LAYOUT_SPC_EXP varchar(60) = NULL,
	@JOB_PROCESS_CONTRL smallint = NULL,
	@JOB_COMP_DESC varchar(60),
	@JOB_COMP_COMMENTS text = NULL,
	@JOB_COMP_BUDGET_AM decimal(11,2) = NULL,
	@ESTIMATE_NUMBER int = NULL,
	@EST_COMPONENT_NBR smallint = NULL,
	@BILLING_USER varchar(100) = NULL,
	@AB_FLAG smallint = NULL,
	@JOB_DEL_INSTRUCT text = NULL,
	@JT_CODE varchar(10) = NULL,
	@TAX_FLAG smallint = NULL,
	@TAX_CODE varchar(4) = NULL,
	@NOBILL_FLAG smallint = NULL,
	@EMAIL_GR_CODE varchar(50) = NULL,
	@AD_NBR varchar(30) = NULL,
	@ACCT_NBR varchar(30) = NULL,
	@PRD_AB_INCOME smallint = NULL,
	@MARKET_CODE varchar(10) = NULL,
	@SERVICE_FEE_FLAG smallint = NULL,
	@ARCHIVE_FLAG smallint = NULL,
	@ROWID int,
	@ADJUST_USER varchar(100) = NULL,
	@TRF_SCHEDULE_BY smallint = NULL,
	@TRF_SCHEDULE_REQ smallint = NULL,
	@JOB_CL_PO_NBR varchar(40) = NULL,
	@UDV1_CODE varchar(10) = NULL,
	@UDV2_CODE varchar(10) = NULL,
	@UDV3_CODE varchar(10) = NULL,
	@UDV4_CODE varchar(10) = NULL,
	@UDV5_CODE varchar(10) = NULL,
	@JOB_TMPLT_CODE varchar(6) = NULL,
	@FEE_TIME smallint = NULL,
	@FISCAL_PERIOD_CODE varchar(6) = NULL,
	@JOB_QTY int = NULL,
	@BLACKPLT_VER_CODE varchar(6) = NULL,
	@BLACKPLT_VER_DESC varchar(60) = NULL,
	@BLACKPLT_VER2_CODE varchar(6) = NULL,
	@BLACKPLT_VER2_DESC varchar(60) = NULL,
	@CDP_CONTACT_ID int = NULL,
	@PRD_CONT_CODE varchar(6) = NULL output
)
AS
BEGIN

	SET NOCOUNT OFF
	DECLARE @Err int

	UPDATE [JOB_COMPONENT]
	SET
		[JOB_BILL_HOLD] = @JOB_BILL_HOLD,
		[EMP_CODE] = @EMP_CODE,
		[JOB_COMP_DATE] = @JOB_COMP_DATE,
		[JOB_FIRST_USE_DATE] = @JOB_FIRST_USE_DATE,
		[START_DATE] = @START_DATE,
		[JOB_AD_SIZE] = @JOB_AD_SIZE,
		[JOB_SPEC_TYPE] = @JOB_SPEC_TYPE,
		[DP_TM_CODE] = @DP_TM_CODE,
		[JOB_MARKUP_PCT] = @JOB_MARKUP_PCT,
		[CREATIVE_INSTR] = @CREATIVE_INSTR,
		[JOB_LAYOUT_THUMB] = @JOB_LAYOUT_THUMB,
		[JOB_LAYOUT_ROUGH] = @JOB_LAYOUT_ROUGH,
		[JOB_LAYOUT_COMP] = @JOB_LAYOUT_COMP,
		[JOB_LAYOUT_NONE] = @JOB_LAYOUT_NONE,
		[JOB_LAYOUT_SPECIAL] = @JOB_LAYOUT_SPECIAL,
		[JOB_LAYOUT_SPC_EXP] = @JOB_LAYOUT_SPC_EXP,
		[JOB_PROCESS_CONTRL] = @JOB_PROCESS_CONTRL,
		[JOB_COMP_DESC] = @JOB_COMP_DESC,
		[JOB_COMP_COMMENTS] = @JOB_COMP_COMMENTS,
		[JOB_COMP_BUDGET_AM] = @JOB_COMP_BUDGET_AM,
		[ESTIMATE_NUMBER] = @ESTIMATE_NUMBER,
		[EST_COMPONENT_NBR] = @EST_COMPONENT_NBR,
		[BILLING_USER] = @BILLING_USER,
		[AB_FLAG] = @AB_FLAG,
		[JOB_DEL_INSTRUCT] = @JOB_DEL_INSTRUCT,
		[JT_CODE] = @JT_CODE,
		[TAX_FLAG] = @TAX_FLAG,
		[TAX_CODE] = @TAX_CODE,
		[NOBILL_FLAG] = @NOBILL_FLAG,
		[EMAIL_GR_CODE] = @EMAIL_GR_CODE,
		[AD_NBR] = @AD_NBR,
		[ACCT_NBR] = @ACCT_NBR,
		[PRD_AB_INCOME] = @PRD_AB_INCOME,
		[MARKET_CODE] = @MARKET_CODE,
		[SERVICE_FEE_FLAG] = @SERVICE_FEE_FLAG,
		[ARCHIVE_FLAG] = @ARCHIVE_FLAG,
		[ADJUST_USER] = @ADJUST_USER,
		[TRF_SCHEDULE_BY] = @TRF_SCHEDULE_BY,
		[TRF_SCHEDULE_REQ] = @TRF_SCHEDULE_REQ,
		[JOB_CL_PO_NBR] = @JOB_CL_PO_NBR,
		[UDV1_CODE] = @UDV1_CODE,
		[UDV2_CODE] = @UDV2_CODE,
		[UDV3_CODE] = @UDV3_CODE,
		[UDV4_CODE] = @UDV4_CODE,
		[UDV5_CODE] = @UDV5_CODE,
		[JOB_TMPLT_CODE] = @JOB_TMPLT_CODE,
		[FEE_TIME] = @FEE_TIME,
		[FISCAL_PERIOD_CODE] = @FISCAL_PERIOD_CODE,
		[JOB_QTY] = @JOB_QTY,
		[BLACKPLT_VER_CODE] = @BLACKPLT_VER_CODE,
		[BLACKPLT_VER_DESC] = @BLACKPLT_VER_DESC,
		[BLACKPLT_VER2_CODE] = @BLACKPLT_VER2_CODE,
		[BLACKPLT_VER2_DESC] = @BLACKPLT_VER2_DESC,
		[CDP_CONTACT_ID] = @CDP_CONTACT_ID
	WHERE
		[JOB_COMPONENT_NBR] = @JOB_COMPONENT_NBR
	AND	[JOB_NUMBER] = @JOB_NUMBER


	SET @Err = @@Error

    SELECT @PRD_CONT_CODE = [PRD_CONT_CODE]
      FROM [JOB_COMPONENT]
     WHERE [JOB_NUMBER] = @JOB_NUMBER AND [JOB_COMPONENT_NBR] = @JOB_COMPONENT_NBR


	RETURN @Err
END

