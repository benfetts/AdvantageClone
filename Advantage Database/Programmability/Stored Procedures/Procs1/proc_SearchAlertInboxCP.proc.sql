
CREATE PROCEDURE [dbo].[proc_SearchAlertInboxCP]
@SearchCriteria VARCHAR(100), 
@CDPCode INT

AS
SELECT     
ALERT_ID, SUBJECT, GENERATED, PROCESSED, [USER_NAME], CDP_CONTACT_ID, PRIORITY, TYPE, CATEGORY, ALERT_TYPE_ID, ALERT_CAT_ID, 
ATTACHMENTCOUNT, ALERT_LEVEL, OFFICE_CODE, CL_CODE, DIV_CODE, PRD_CODE, CMP_CODE, JOB_NUMBER, JOB_COMPONENT_NBR, 
SENDER_EMP_CODE, DISMISSED_DATE, CL_NAME, DIV_NAME, PRD_DESCRIPTION, CMP_NAME, BODY, LOWER_SUBJECT, LOWER_BODY, 
OFFICE_NAME, JOB_DESC, JOB_COMP_DESC
FROM         CP_ALERTLIST
WHERE     ((LOWER_SUBJECT LIKE '%' + LOWER(@SearchCriteria) +'%') OR
(LOWER(USER_NAME) LIKE '%' + LOWER(@SearchCriteria) + '%') OR LOWER_BODY LIKE '%' + LOWER(@SearchCriteria)) AND (CDP_CONTACT_ID = @CDPCode)

