
CREATE PROCEDURE [dbo].[sp_media_brdcast_gl]
AS
BEGIN
	SET NOCOUNT ON;

--MAIN DATA TABLE - Media Brdcast GL Info
CREATE TABLE #media_brdcast_gl(
	[ORDER_NBR]		int NOT NULL,
	[LINE_NBR]		smallint NOT NULL,
	[BRDCAST_YEAR]	smallint NOT NULL,
	[GLACODE_SALES]	varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	[GLACODE_COS]	varchar(30) COLLATE SQL_Latin1_General_CP1_CS_AS,
	[GLESEQ_SALES]	smallint NULL,
	[GLESEQ_COS]	smallint NULL,
	[GLEXACT]		int NULL,
	[MONTH]			varchar(3) COLLATE SQL_Latin1_General_CP1_CS_AS,
	[PERIOD]		varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS,
	[GLEXACT_DEF]	int NULL,
	[DEFSALEPER]	varchar(6) COLLATE SQL_Latin1_General_CP1_CS_AS)

--BRDCAST MAX SEQ TABLE
CREATE TABLE #brdcast_max_seq(
	[ORDER_NBR]		int NOT NULL,
	[LINE_NBR]		smallint NOT NULL,
	[REV_NBR]		smallint NOT NULL,
	[BRDCAST_YEAR]	smallint NOT NULL,
	[SEQ_NBR]		int NOT NULL)

--RADIO MAX SEQ=================================================
INSERT INTO #brdcast_max_seq
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.REV_NBR,
	g.BRDCAST_YEAR,
	g.SEQ_NBR
FROM dbo.RADIO_GL g
WHERE g.SEQ_NBR = (SELECT MAX(g2.SEQ_NBR) FROM dbo.RADIO_GL g2
	WHERE g.ORDER_NBR = g2.ORDER_NBR
		AND g.LINE_NBR = g2.LINE_NBR
		AND g.REV_NBR = g2.REV_NBR
		AND	g.BRDCAST_YEAR = g2.BRDCAST_YEAR)

--TV MAX SEQ=====================================================
INSERT INTO #brdcast_max_seq
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.REV_NBR,
	g.BRDCAST_YEAR,
	g.SEQ_NBR
FROM dbo.TV_GL g
WHERE g.SEQ_NBR = (SELECT MAX(g2.SEQ_NBR) FROM dbo.TV_GL g2
	WHERE g.ORDER_NBR = g2.ORDER_NBR
		AND g.LINE_NBR = g2.LINE_NBR
		AND g.REV_NBR = g2.REV_NBR
		AND	g.BRDCAST_YEAR = g2.BRDCAST_YEAR)

--RADIO GL INFO===================================================
--JAN GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JAN_GLACODE_SALES,
	g.JAN_GLACODE_COS,
	g.JAN_GLESEQ_SALES,
	g.JAN_GLESEQ_COS,
	g.JAN_GLEXACT,
	'JAN',
	gh1.GLEHPP,
	g.JAN_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JAN_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JAN_GLEXACT_DEF = gh.GLEHXACT)

--FEB GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.FEB_GLACODE_SALES,
	g.FEB_GLACODE_COS,
	g.FEB_GLESEQ_SALES,
	g.FEB_GLESEQ_COS,
	g.FEB_GLEXACT,
	'FEB',
	gh1.GLEHPP,
	g.FEB_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.FEB_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.FEB_GLEXACT_DEF = gh.GLEHXACT)

--MAR GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.MAR_GLACODE_SALES,
	g.MAR_GLACODE_COS,
	g.MAR_GLESEQ_SALES,
	g.MAR_GLESEQ_COS,
	g.MAR_GLEXACT,
	'MAR',
	gh1.GLEHPP,
	g.MAR_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.MAR_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.MAR_GLEXACT_DEF = gh.GLEHXACT)

--APR GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.APR_GLACODE_SALES,
	g.APR_GLACODE_COS,
	g.APR_GLESEQ_SALES,
	g.APR_GLESEQ_COS,
	g.APR_GLEXACT,
	'APR',
	gh1.GLEHPP,
	g.APR_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.APR_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.APR_GLEXACT_DEF = gh.GLEHXACT)

--MAY GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.MAY_GLACODE_SALES,
	g.MAY_GLACODE_COS,
	g.MAY_GLESEQ_SALES,
	g.MAY_GLESEQ_COS,
	g.MAY_GLEXACT,
	'MAY',
	gh1.GLEHPP,
	g.MAY_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.MAY_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.MAY_GLEXACT_DEF = gh.GLEHXACT)

--JUN GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JUN_GLACODE_SALES,
	g.JUN_GLACODE_COS,
	g.JUN_GLESEQ_SALES,
	g.JUN_GLESEQ_COS,
	g.JUN_GLEXACT,
	'JUN',
	gh1.GLEHPP,
	g.JUN_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JUN_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JUN_GLEXACT_DEF = gh.GLEHXACT)

--JUL GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JUL_GLACODE_SALES,
	g.JUL_GLACODE_COS,
	g.JUL_GLESEQ_SALES,
	g.JUL_GLESEQ_COS,
	g.JUL_GLEXACT,
	'JUL',
	gh1.GLEHPP,
	g.JUL_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JUL_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JUL_GLEXACT_DEF = gh.GLEHXACT)

--AUG GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.AUG_GLACODE_SALES,
	g.AUG_GLACODE_COS,
	g.AUG_GLESEQ_SALES,
	g.AUG_GLESEQ_COS,
	g.AUG_GLEXACT,
	'AUG',
	gh1.GLEHPP,
	g.AUG_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.AUG_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.AUG_GLEXACT_DEF = gh.GLEHXACT)

--SEP GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.SEP_GLACODE_SALES,
	g.SEP_GLACODE_COS,
	g.SEP_GLESEQ_SALES,
	g.SEP_GLESEQ_COS,
	g.SEP_GLEXACT,
	'SEP',
	gh1.GLEHPP,
	g.SEP_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.SEP_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.SEP_GLEXACT_DEF = gh.GLEHXACT)

--OCT GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.OCT_GLACODE_SALES,
	g.OCT_GLACODE_COS,
	g.OCT_GLESEQ_SALES,
	g.OCT_GLESEQ_COS,
	g.OCT_GLEXACT,
	'OCT',
	gh1.GLEHPP,
	g.OCT_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.OCT_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.OCT_GLEXACT_DEF = gh.GLEHXACT)

--NOV GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.NOV_GLACODE_SALES,
	g.NOV_GLACODE_COS,
	g.NOV_GLESEQ_SALES,
	g.NOV_GLESEQ_COS,
	g.NOV_GLEXACT,
	'NOV',
	gh1.GLEHPP,
	g.NOV_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.NOV_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.NOV_GLEXACT_DEF = gh.GLEHXACT)

--DEC GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.DEC_GLACODE_SALES,
	g.DEC_GLACODE_COS,
	g.DEC_GLESEQ_SALES,
	g.DEC_GLESEQ_COS,
	g.DEC_GLEXACT,
	'DEC',
	gh1.GLEHPP,
	g.DEC_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.RADIO_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.DEC_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.DEC_GLEXACT_DEF = gh.GLEHXACT)

--TV GL INFO===================================================
--JAN GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JAN_GLACODE_SALES,
	g.JAN_GLACODE_COS,
	g.JAN_GLESEQ_SALES,
	g.JAN_GLESEQ_COS,
	g.JAN_GLEXACT,
	'JAN',
	gh1.GLEHPP,
	g.JAN_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JAN_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JAN_GLEXACT_DEF = gh.GLEHXACT)

--FEB GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.FEB_GLACODE_SALES,
	g.FEB_GLACODE_COS,
	g.FEB_GLESEQ_SALES,
	g.FEB_GLESEQ_COS,
	g.FEB_GLEXACT,
	'FEB',
	gh1.GLEHPP,
	g.FEB_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.FEB_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.FEB_GLEXACT_DEF = gh.GLEHXACT)

--MAR GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.MAR_GLACODE_SALES,
	g.MAR_GLACODE_COS,
	g.MAR_GLESEQ_SALES,
	g.MAR_GLESEQ_COS,
	g.MAR_GLEXACT,
	'MAR',
	gh1.GLEHPP,
	g.MAR_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.MAR_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.MAR_GLEXACT_DEF = gh.GLEHXACT)

--APR GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.APR_GLACODE_SALES,
	g.APR_GLACODE_COS,
	g.APR_GLESEQ_SALES,
	g.APR_GLESEQ_COS,
	g.APR_GLEXACT,
	'APR',
	gh1.GLEHPP,
	g.APR_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.APR_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.APR_GLEXACT_DEF = gh.GLEHXACT)

--MAY GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.MAY_GLACODE_SALES,
	g.MAY_GLACODE_COS,
	g.MAY_GLESEQ_SALES,
	g.MAY_GLESEQ_COS,
	g.MAY_GLEXACT,
	'MAY',
	gh1.GLEHPP,
	g.MAY_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.MAY_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.MAY_GLEXACT_DEF = gh.GLEHXACT)

--JUN GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JUN_GLACODE_SALES,
	g.JUN_GLACODE_COS,
	g.JUN_GLESEQ_SALES,
	g.JUN_GLESEQ_COS,
	g.JUN_GLEXACT,
	'JUN',
	gh1.GLEHPP,
	g.JUN_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JUN_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JUN_GLEXACT_DEF = gh.GLEHXACT)

--JUL GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.JUL_GLACODE_SALES,
	g.JUL_GLACODE_COS,
	g.JUL_GLESEQ_SALES,
	g.JUL_GLESEQ_COS,
	g.JUL_GLEXACT,
	'JUL',
	gh1.GLEHPP,
	g.JUL_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.JUL_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.JUL_GLEXACT_DEF = gh.GLEHXACT)

--AUG GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.AUG_GLACODE_SALES,
	g.AUG_GLACODE_COS,
	g.AUG_GLESEQ_SALES,
	g.AUG_GLESEQ_COS,
	g.AUG_GLEXACT,
	'AUG',
	gh1.GLEHPP,
	g.AUG_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.AUG_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.AUG_GLEXACT_DEF = gh.GLEHXACT)

--SEP GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.SEP_GLACODE_SALES,
	g.SEP_GLACODE_COS,
	g.SEP_GLESEQ_SALES,
	g.SEP_GLESEQ_COS,
	g.SEP_GLEXACT,
	'SEP',
	gh1.GLEHPP,
	g.SEP_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.SEP_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.SEP_GLEXACT_DEF = gh.GLEHXACT)

--OCT GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.OCT_GLACODE_SALES,
	g.OCT_GLACODE_COS,
	g.OCT_GLESEQ_SALES,
	g.OCT_GLESEQ_COS,
	g.OCT_GLEXACT,
	'OCT',
	gh1.GLEHPP,
	g.OCT_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.OCT_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.OCT_GLEXACT_DEF = gh.GLEHXACT)

--NOV GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.NOV_GLACODE_SALES,
	g.NOV_GLACODE_COS,
	g.NOV_GLESEQ_SALES,
	g.NOV_GLESEQ_COS,
	g.NOV_GLEXACT,
	'NOV',
	gh1.GLEHPP,
	g.NOV_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.NOV_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.NOV_GLEXACT_DEF = gh.GLEHXACT)

--DEC GL Info
INSERT INTO #media_brdcast_gl
SELECT g.ORDER_NBR,
	g.LINE_NBR,
	g.BRDCAST_YEAR,
	g.DEC_GLACODE_SALES,
	g.DEC_GLACODE_COS,
	g.DEC_GLESEQ_SALES,
	g.DEC_GLESEQ_COS,
	g.DEC_GLEXACT,
	'DEC',
	gh1.GLEHPP,
	g.DEC_GLEXACT_DEF,
	gh.GLEHPP
FROM dbo.TV_GL AS g
INNER JOIN #brdcast_max_seq AS ms
	ON (g.ORDER_NBR = ms.ORDER_NBR
	AND g.LINE_NBR = ms.LINE_NBR
	AND g.REV_NBR = ms.REV_NBR
	AND g.SEQ_NBR = ms.SEQ_NBR
	AND g.BRDCAST_YEAR = ms.BRDCAST_YEAR)
INNER JOIN dbo.GLENTHDR AS gh1
	ON (g.DEC_GLEXACT = gh1.GLEHXACT)
LEFT JOIN dbo.GLENTHDR AS gh
	ON (g.DEC_GLEXACT_DEF = gh.GLEHXACT)

SELECT * FROM #media_brdcast_gl
 WHERE GLACODE_SALES IS NOT NULL

END

