
CREATE PROCEDURE [dbo].[usp_wv_ALERT_EXCLUDE_SELF_FROM_EMAIL] /*WITH ENCRYPTION*/
	@ALERT_ID INT
AS
/*=========== QUERY ===========*/
DECLARE
	@EXCLUDE_SELF_FROM_ALERT_EMAIL TINYINT,
	@ALERT_TYPE_ID INT,
	@ALERT_CAT_ID INT
	
	SET @EXCLUDE_SELF_FROM_ALERT_EMAIL = 0;
	
	SELECT @ALERT_TYPE_ID = ALERT_TYPE_ID, @ALERT_CAT_ID = ALERT_CAT_ID
	  FROM ALERT WITH(NOLOCK) WHERE ALERT_ID = @ALERT_ID;
	
	IF 
	(@ALERT_TYPE_ID = 4 AND @ALERT_CAT_ID = 41) OR -- Billing Batch Created
	(@ALERT_TYPE_ID = 4 AND @ALERT_CAT_ID = 40) OR -- Billing Batch Approved 
	(@ALERT_TYPE_ID = 8 AND @ALERT_CAT_ID = 47) OR -- Missing Time
	(@ALERT_TYPE_ID = 3 AND @ALERT_CAT_ID = 43) OR -- Timesheet Supervisor Approval Request
	(@ALERT_TYPE_ID = 3 AND @ALERT_CAT_ID = 45) OR -- Expense Report Approval
	(@ALERT_TYPE_ID = 3 AND @ALERT_CAT_ID = 38) OR -- PO Approval Request 
	(@ALERT_TYPE_ID = 3 AND @ALERT_CAT_ID = 39)    -- PO Approval Reply
	BEGIN
		SET @EXCLUDE_SELF_FROM_ALERT_EMAIL = 1;
	END
	
	SELECT ISNULL(@EXCLUDE_SELF_FROM_ALERT_EMAIL,0);

/*=========== QUERY ===========*/
