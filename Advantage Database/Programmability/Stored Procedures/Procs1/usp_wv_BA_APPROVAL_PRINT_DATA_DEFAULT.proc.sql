--DROP PROCEDURE [dbo].[usp_wv_BA_APPROVAL_PRINT_DATA_DEFAULT]
CREATE PROCEDURE [dbo].[usp_wv_BA_APPROVAL_PRINT_DATA_DEFAULT]
@BA_ID AS INT,
@REPORT AS INT,
@IncludeZero AS Bit
AS
--Default
IF @REPORT = 1
BEGIN
    IF @IncludeZero = 1
        BEGIN
            SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, JOB_LOG.CMP_IDENTIFIER, CAMPAIGN.CMP_CODE, 
								  CAMPAIGN.CMP_NAME, BILL_APPR_DTL.APPR_TAX_CODE, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_MINUS_RESALE_TAX
            FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID LEFT OUTER JOIN
								  CAMPAIGN ON JOB_LOG.CMP_IDENTIFIER = CAMPAIGN.CMP_IDENTIFIER
            WHERE BILL_APPR_CL.BA_ID = @BA_ID
            ORDER BY BILL_APPR_CL.BA_ID, BILL_APPR_HDR.JOB_NUMBER, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER, BILL_APPR_HDR.JOB_COMPONENT_NBR	        
        END
    ELSE
        BEGIN
            SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, JOB_LOG.CMP_IDENTIFIER, CAMPAIGN.CMP_CODE, 
								  CAMPAIGN.CMP_NAME, BILL_APPR_DTL.APPR_TAX_CODE, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
 								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_MINUS_RESALE_TAX 
           FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID LEFT OUTER JOIN
								  CAMPAIGN ON JOB_LOG.CMP_IDENTIFIER = CAMPAIGN.CMP_IDENTIFIER
            WHERE BILL_APPR_CL.BA_ID = @BA_ID AND BILL_APPR_DTL.APPROVED_AMT <> 0
            ORDER BY BILL_APPR_CL.BA_ID, BILL_APPR_HDR.JOB_NUMBER, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER, BILL_APPR_HDR.JOB_COMPONENT_NBR	        
        END
END
--Component/Function Heading
IF @REPORT = 2
BEGIN
    IF @IncludeZero = 1
        BEGIN
            SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_MINUS_RESALE_TAX
            FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID
            WHERE BILL_APPR_CL.BA_ID = @BA_ID
            ORDER BY BILL_APPR_CL.BA_ID, BILL_APPR_HDR.JOB_NUMBER, BILL_APPR_HDR.JOB_COMPONENT_NBR, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER	        
        END
    ELSE
        BEGIN
             SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_MINUS_RESALE_TAX
            FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID
            WHERE BILL_APPR_CL.BA_ID = @BA_ID AND BILL_APPR_DTL.APPROVED_AMT <> 0
            ORDER BY BILL_APPR_CL.BA_ID, BILL_APPR_HDR.JOB_NUMBER, BILL_APPR_HDR.JOB_COMPONENT_NBR, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER	       
        END
END
--Campaign Component		
IF @REPORT = 3
BEGIN
    IF @IncludeZero = 1
        BEGIN
            SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, JOB_LOG.CMP_IDENTIFIER, CAMPAIGN.CMP_CODE, 
								  CAMPAIGN.CMP_NAME, BILL_APPR_DTL.APPR_TAX_CODE, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
 								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_RESALE_TAX
           FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID LEFT OUTER JOIN
								  CAMPAIGN ON JOB_LOG.CMP_IDENTIFIER = CAMPAIGN.CMP_IDENTIFIER
            WHERE BILL_APPR_CL.BA_ID = @BA_ID 
            ORDER BY BILL_APPR_CL.BA_ID, JOB_LOG.CMP_IDENTIFIER, BILL_APPR_HDR.JOB_NUMBER, BILL_APPR_HDR.JOB_COMPONENT_NBR, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER
        END
    ELSE
        BEGIN
            SELECT     BILL_APPR_CL.BA_ID, BILL_APPR_CL.BA_CL_DESC, BILL_APPR_CL.BA_CL_DATE, BILL_APPR_HDR.JOB_NUMBER, 
                                  JOB_LOG.JOB_DESC, BILL_APPR_HDR.JOB_COMPONENT_NBR, JOB_COMPONENT.JOB_COMP_DESC, 
                                  FNC_HEADING.FNC_HEADING_SEQ, ISNULL(FNC_HEADING.FNC_HEADING_DESC,'') AS FNC_HEADING_DESC, BILL_APPR_DTL.QTY_HRS, BILL_APPR_DTL.BILLING_RATE, 
								  BILL_APPR_DTL.APPROVED_AMT AS APPROVED_AMT, 
								  BILL_APPR_DTL.CLIENT_COMMENTS AS DTL_CLIENT_COMMENTS, BILL_APPR_HDR.CLIENT_COMMENTS AS HDR_CLIENT_COMMENTS,
                                  CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_NUMBER) + CONVERT(VARCHAR(6),JOB_COMPONENT.JOB_COMPONENT_NBR) AS JOBCOMP, BILL_APPR_CL.CLIENT_PO,
                                  ISNULL(JOB_LOG.JOB_BILL_COMMENT,'') AS JOB_BILL_COMMENT, ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0) AS APPR_RESALE_TAX, ISNULL(CDP_CONTACT_HDR.CONT_FML,'') AS CONT_FML, BILL_APPR_DTL.FNC_CODE,
					              BILL_APPR_DTL.FNC_DESC, JOB_LOG.CMP_IDENTIFIER, CAMPAIGN.CMP_CODE, 
								  CAMPAIGN.CMP_NAME, BILL_APPR_DTL.APPR_TAX_CODE, CDP_CONTACT_HDR.CONT_ADDRESS1, 
                                  CDP_CONTACT_HDR.CONT_ADDRESS2, CDP_CONTACT_HDR.CONT_CITY, CDP_CONTACT_HDR.CONT_STATE, 
                                  CDP_CONTACT_HDR.CONT_ZIP, CDP_CONTACT_HDR.CONT_TITLE,
 								  (BILL_APPR_DTL.APPROVED_AMT - ISNULL(BILL_APPR_DTL.APPR_RESALE_TAX,0)) AS APPROVED_AMT_RESALE_TAX
           FROM         FUNCTIONS INNER JOIN
                                  BILL_APPR_DTL ON FUNCTIONS.FNC_CODE = BILL_APPR_DTL.FNC_CODE INNER JOIN
                                  JOB_LOG INNER JOIN
                                  JOB_COMPONENT ON JOB_LOG.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER INNER JOIN
                                  BILL_APPR_HDR ON JOB_COMPONENT.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  JOB_COMPONENT.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR ON 
                                  BILL_APPR_DTL.BA_ID = BILL_APPR_HDR.BA_ID AND BILL_APPR_DTL.JOB_NUMBER = BILL_APPR_HDR.JOB_NUMBER AND 
                                  BILL_APPR_DTL.JOB_COMPONENT_NBR = BILL_APPR_HDR.JOB_COMPONENT_NBR INNER JOIN
                                  BILL_APPR_CL ON BILL_APPR_HDR.BA_ID = BILL_APPR_CL.BA_ID LEFT OUTER JOIN
                                  FNC_HEADING ON FUNCTIONS.FNC_HEADING_ID = FNC_HEADING.FNC_HEADING_ID LEFT OUTER JOIN
                                  CDP_CONTACT_HDR ON BILL_APPR_CL.CDP_CONTACT_ID = CDP_CONTACT_HDR.CDP_CONTACT_ID LEFT OUTER JOIN
								  CAMPAIGN ON JOB_LOG.CMP_IDENTIFIER = CAMPAIGN.CMP_IDENTIFIER
            WHERE BILL_APPR_CL.BA_ID = @BA_ID AND BILL_APPR_DTL.APPROVED_AMT <> 0
            ORDER BY BILL_APPR_CL.BA_ID, JOB_LOG.CMP_IDENTIFIER, BILL_APPR_HDR.JOB_NUMBER, BILL_APPR_HDR.JOB_COMPONENT_NBR, FNC_HEADING.FNC_HEADING_SEQ, FUNCTIONS.FNC_ORDER	        
        END
END