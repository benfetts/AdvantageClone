

CREATE PROCEDURE [dbo].[usp_wv_Dashboard_Project_GetData]
(
	@Start varchar(12),
	@End varchar(12)
)
AS
BEGIN
	SET NOCOUNT OFF
	
	DECLARE 
	@ERR INT, @PPStart int, @PPEnd int, @startdate datetime, @enddate datetime

	SET @startdate = '1/1/' + @Start
	SET @enddate = '12/31/' + @End

	--SELECT @PPStart = PPPERIOD, @startdate = PPSRTDATE 
	--FROM POSTPERIOD
	--WHERE PPGLMONTH = 1 AND PPGLYEAR  = @Start

	--if @startdate IS NULL
	--Begin
	--	SELECT @PPStart = PPPERIOD, @startdate = PPSRTDATE 
	--	FROM POSTPERIOD
	--	WHERE PPGLMONTH = 1 AND PPGLYEAR  = @End
	--End

	--SELECT @PPEnd = PPPERIOD, @enddate = PPENDDATE 
	--FROM POSTPERIOD
	--WHERE PPGLMONTH = 12 AND PPGLYEAR  = @End

	DELETE FROM DASH_DATA_PROJ_HDR
		
	INSERT INTO DASH_DATA_PROJ_HDR (
		OFFICE_CODE,
		OFFICE_NAME,
		CL_CODE,
		CL_NAME,
		DIV_CODE,
		DIV_NAME,
		PRD_CODE,
		PRD_DESCRIPTION,
		CMP_CODE,
		CMP_IDENTIFIER,
		CMP_NAME,
		CMP_BEGIN_DATE,
		CMP_END_DATE,
		CMP_BILL,
		CMP_INC,
		SC_CODE,
		SC_DESCRIPTION,
		JOB,
		JOB_DESC,
		JOB_COMMENTS,
		BILL_COMMENT,
		JOB_CLI_REF,
		JOB_UDV1_CODE,
		JOB_UDV1_DESC,
		JOB_UDV2_CODE,
		JOB_UDV2_DESC,
		JOB_UDV3_CODE,
		JOB_UDV3_DESC,
		JOB_UDV4_CODE,
		JOB_UDV4_DESC,
		JOB_UDV5_CODE,
		JOB_UDV5_DESC,
		JOB_COMPONENT_NBR,
		JOB_COMP_DESC,
		JOB_COMP_DATE,
		JOB_FIRST_USE_DATE,
		JOB_COMP_COMMENTS,
		APPR_COMMENT,
		ACCT_EXEC,
		EMP_LNAME,
		EMP_FNAME,
		EMP_MI,
		CLIENT_PO,
		DP_TM_CODE,
		DP_TM_DESC,
		JOB_TYPE,
		JT_DESC,
		BUDGET_AMT,
		APPR_REQ_TYPE,
		APPR_TOTAL,
		COMP_UDV1_CODE,
		COMP_UDV1_DESC,
		COMP_UDV2_CODE,
		COMP_UDV2_DESC,
		COMP_UDV3_CODE,
		COMP_UDV3_DESC,
		COMP_UDV4_CODE,
		COMP_UDV4_DESC,
		COMP_UDV5_CODE,
		COMP_UDV5_DESC,
		JOB_PROCESS_CONTRL,
		COMPLETED_DATE)
	EXEC advsp_job_comp_header_info @startdate, @enddate

    
	SET @ERR = @@Error

	--RETURN @ERR
END



