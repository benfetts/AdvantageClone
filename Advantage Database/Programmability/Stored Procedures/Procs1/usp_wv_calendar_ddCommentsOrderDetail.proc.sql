





CREATE PROCEDURE [dbo].[usp_wv_calendar_ddCommentsOrderDetail]
@OrderNumber int,
@LineNumber int,
@RevNumber int,
@Type varchar(2)
AS

if @Type = 'M'
SELECT INSTRUCTIONS, ORDER_COPY, MATL_NOTES, POSITION_INFO, CLOSE_INFO, RATE_INFO, MISC_INFO, IN_HOUSE_CMTS
FROM MAGAZINE_COMMENTS
WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber

if @Type = 'N'
SELECT INSTRUCTIONS, ORDER_COPY, MATL_NOTES, POSITION_INFO, CLOSE_INFO, RATE_INFO, MISC_INFO, IN_HOUSE_CMTS
FROM NEWSPAPER_COMMENTS
WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber

if @Type = 'I'
SELECT INSTRUCTIONS, ORDER_COPY, MATL_NOTES, MISC_INFO
FROM INTERNET_COMMENTS
WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber

if @Type = 'O'
SELECT INSTRUCTIONS, ORDER_COPY, MATL_NOTES, MISC_INFO
FROM OUTDOOR_COMMENTS
WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber

if @Type = 'R'
Begin
 IF EXISTS(SELECT ORDER_NBR FROM RADIO_DETAIL2 WHERE ORDER_NBR = @OrderNumber  AND LINE_NBR = @LineNumber AND REV_NBR = @RevNumber)
 BEGIN
	SELECT CLOSE_INFO, MISC_INFO, ORDER_COMMENT, HOUSE_COMMENT, RATE_INFO, POSITION_INFO, '' AS INSTRUCTIONS, '' AS MATL_NOTES, '' AS IN_HOUSE_CMTS, 'old' AS [Table]
	FROM RADIO_DETAIL2
	WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber AND REV_NBR = @RevNumber
 END
 ELSE
 BEGIN
	SELECT INSTRUCTIONS, MATL_NOTES, CLOSE_INFO, MISC_INFO, IN_HOUSE_CMTS AS HOUSE_COMMENT, RATE_INFO, POSITION_INFO, 'new' AS [Table], '' AS ORDER_COMMENT
	FROM RADIO_COMMENTS
	WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber
 END
End


if @Type = 'T'   
Begin
 IF EXISTS(SELECT ORDER_NBR FROM TV_DETAIL2 WHERE ORDER_NBR = @OrderNumber  AND LINE_NBR = @LineNumber AND REV_NBR = @RevNumber)
 BEGIN
	SELECT CLOSE_INFO, MISC_INFO, ORDER_COMMENT, HOUSE_COMMENT, RATE_INFO, POSITION_INFO, '' AS INSTRUCTIONS, '' AS MATL_NOTES, '' AS IN_HOUSE_CMTS, 'old' AS [Table]
	FROM TV_DETAIL2
	WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber AND REV_NBR = @RevNumber
 END
 ELSE
 BEGIN
	SELECT INSTRUCTIONS, MATL_NOTES, CLOSE_INFO, MISC_INFO, IN_HOUSE_CMTS AS HOUSE_COMMENT, RATE_INFO, POSITION_INFO, 'new' AS [Table], '' AS ORDER_COMMENT
	FROM TV_COMMENTS
	WHERE ORDER_NBR = @OrderNumber AND LINE_NBR = @LineNumber
 END
End                                               




