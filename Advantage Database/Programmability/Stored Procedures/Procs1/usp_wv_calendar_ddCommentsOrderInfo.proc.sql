





CREATE PROCEDURE [dbo].[usp_wv_calendar_ddCommentsOrderInfo]
@OrderNumber int,
@RevNumber int,
@Type varchar(2)
AS

if @Type = 'M'
SELECT ORDER_COMMENT, HOUSE_COMMENT
FROM MAGAZINE_HEADER
WHERE ORDER_NBR = @OrderNumber

if @Type = 'N'
SELECT ORDER_COMMENT, HOUSE_COMMENT
FROM NEWSPAPER_HEADER
WHERE ORDER_NBR = @OrderNumber

if @Type = 'I'
SELECT ORDER_COMMENT, HOUSE_COMMENT
FROM INTERNET_HEADER
WHERE ORDER_NBR = @OrderNumber

if @Type = 'O'
SELECT ORDER_COMMENT, HOUSE_COMMENT
FROM OUTDOOR_HEADER
WHERE ORDER_NBR = @OrderNumber

if @Type = 'R'
Begin
 IF EXISTS(SELECT ORDER_NBR FROM RADIO_HEADER WHERE ORDER_NBR = @OrderNumber AND REV_NBR = @RevNumber)
 BEGIN
	SELECT ORDER_COMMENT, HOUSE_COMMENT
	FROM RADIO_HEADER
	WHERE ORDER_NBR = @OrderNumber AND REV_NBR = @RevNumber
 END
 ELSE
 BEGIN
	SELECT ORDER_COMMENT, HOUSE_COMMENT
	FROM RADIO_HDR
	WHERE ORDER_NBR = @OrderNumber
 END
End


if @Type = 'T'      
Begin
 IF EXISTS(SELECT ORDER_NBR FROM TV_HEADER WHERE ORDER_NBR = @OrderNumber AND REV_NBR = @RevNumber)
 BEGIN
	SELECT ORDER_COMMENT, HOUSE_COMMENT
	FROM TV_HEADER
	WHERE ORDER_NBR = @OrderNumber AND REV_NBR = @RevNumber
 END
 ELSE
 BEGIN
	SELECT ORDER_COMMENT, HOUSE_COMMENT
	FROM TV_HDR
	WHERE ORDER_NBR = @OrderNumber
 END
End                                            




