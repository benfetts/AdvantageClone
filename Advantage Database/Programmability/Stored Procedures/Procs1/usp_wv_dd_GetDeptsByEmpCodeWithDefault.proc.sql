
CREATE PROCEDURE [dbo].[usp_wv_dd_GetDeptsByEmpCodeWithDefault] /*WITH ENCRYPTION*/
@EMP_CODE VARCHAR(6)
AS
/*=========== QUERY ===========*/
	SELECT EMP_DP_TM.DP_TM_CODE AS [Code],
		   CASE 
				WHEN EMPLOYEE.DP_TM_CODE = EMP_DP_TM.DP_TM_CODE THEN DEPT_TEAM.DP_TM_DESC 
					 + '*'
				ELSE DEPT_TEAM.DP_TM_DESC
		   END AS [Description]
	FROM   EMPLOYEE WITH(NOLOCK)
		   RIGHT OUTER JOIN EMP_DP_TM WITH(NOLOCK)
				ON  EMPLOYEE.EMP_CODE = EMP_DP_TM.EMP_CODE JOIN
			dbo.DEPT_TEAM ON EMP_DP_TM.DP_TM_CODE = DEPT_TEAM.DP_TM_CODE
	WHERE  (EMP_DP_TM.EMP_CODE = @EMP_CODE)
	ORDER BY
		   EMP_DP_TM.DP_TM_CODE;
/*=========== QUERY ===========*/


