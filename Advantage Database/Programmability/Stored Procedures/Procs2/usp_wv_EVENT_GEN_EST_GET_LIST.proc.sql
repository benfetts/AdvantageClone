
CREATE PROCEDURE [dbo].[usp_wv_EVENT_GEN_EST_GET_LIST] 
	@EST_NUMBER INT,
	@EST_COMPONENT_NBR SMALLINT,
	@EST_QUOTE_NUMBER SMALLINT,
	@JOB_NUMBER INT,
	@JOB_COMPONENT_NBR SMALLINT

AS


SELECT 
	[EVENT_GEN_ID]
	,CAST([EVENT_GEN_ID] AS VARCHAR(50))+' - '+[EVENT_GEN_LABEL] AS EVENT_GEN_LABEL
	,[EVENT_GEN_DESC_LONG]
FROM 
	EVENT_GEN WITH(NOLOCK)
WHERE 
    (
	    EST_NUMBER = @EST_NUMBER
	    AND EST_COMPONENT_NBR = @EST_COMPONENT_NBR
	    AND EST_QUOTE_NUMBER = @EST_QUOTE_NUMBER
	)
	OR
	(
        JOB_NUMBER = @JOB_NUMBER
        AND JOB_COMPONENT_NBR = @JOB_COMPONENT_NBR
	)
ORDER BY
    [EVENT_GEN_LABEL];
	
	
