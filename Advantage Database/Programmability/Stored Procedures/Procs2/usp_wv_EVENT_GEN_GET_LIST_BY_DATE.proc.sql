
CREATE PROCEDURE [dbo].[usp_wv_EVENT_GEN_GET_LIST_BY_DATE] /*WITH ENCRYPTION*/
	@START_DATE SMALLDATETIME,
	@END_DATE SMALLDATETIME
AS
/*=========== QUERY ===========*/
	SET @START_DATE = CONVERT(
			DATETIME,
			CONVERT(CHAR(10), DATEPART(yyyy, @START_DATE), 101) 
			+
			'-' +
			CONVERT(CHAR(10), DATEPART(mm, @START_DATE), 101) +
			'-' +
			CONVERT(CHAR(10), DATEPART(dd, @START_DATE), 101) +
			' 00:00:00'
		) 
	
	SET @END_DATE = CONVERT(
			DATETIME,
			CONVERT(CHAR(10), DATEPART(yyyy, @END_DATE), 101) 
			+
			'-' +
			CONVERT(CHAR(10), DATEPART(mm, @END_DATE), 101) +
			'-' +
			CONVERT(CHAR(10), DATEPART(dd, @END_DATE), 101) +
			' 23:59:00'
		) 

	SELECT DISTINCT EVENT_GEN.EVENT_GEN_ID,
		   EVENT_GEN.EVENT_GEN_LABEL
	FROM   EVENT_GEN WITH(NOLOCK)
		   INNER JOIN EVENT WITH(NOLOCK)
				ON  EVENT_GEN.EVENT_GEN_ID = EVENT.EVENT_GEN_ID
	WHERE  EVENT.EVENT_DATE BETWEEN @START_DATE AND @END_DATE ORDER BY EVENT_GEN.EVENT_GEN_LABEL;
/*=========== QUERY ===========*/
