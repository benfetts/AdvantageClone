





CREATE PROCEDURE [dbo].[usp_wv_Estimating_GetQuotesForImport]
@EstNumber int,
@EstCompNumber int,
@EstQuote int
AS

SELECT     ESTIMATE_QUOTE.ESTIMATE_NUMBER, ESTIMATE_QUOTE.EST_COMPONENT_NBR, ESTIMATE_QUOTE.EST_QUOTE_NBR, 
                      ESTIMATE_QUOTE.EST_QUOTE_DESC, ESTIMATE_REV.EST_REV_NBR, ESTIMATE_REV.SPEC_VER, ESTIMATE_REV.SPEC_REV, 
                      JOB_SPECS.SPEC_TYPE_CODE, JOB_SPECS.SPEC_VER_DESC, JOB_COMPONENT.JOB_NUMBER, JOB_COMPONENT.JOB_COMPONENT_NBR
FROM         ESTIMATE_QUOTE INNER JOIN
                      ESTIMATE_REV ON ESTIMATE_QUOTE.ESTIMATE_NUMBER = ESTIMATE_REV.ESTIMATE_NUMBER AND 
                      ESTIMATE_QUOTE.EST_COMPONENT_NBR = ESTIMATE_REV.EST_COMPONENT_NBR AND 
                      ESTIMATE_QUOTE.EST_QUOTE_NBR = ESTIMATE_REV.EST_QUOTE_NBR INNER JOIN
                      JOB_SPECS ON ESTIMATE_REV.SPEC_VER = JOB_SPECS.SPEC_VER AND 
                      ESTIMATE_REV.SPEC_REV = JOB_SPECS.SPEC_REV INNER JOIN
                      ESTIMATE_COMPONENT ON ESTIMATE_QUOTE.ESTIMATE_NUMBER = ESTIMATE_COMPONENT.ESTIMATE_NUMBER AND 
                      ESTIMATE_QUOTE.EST_COMPONENT_NBR = ESTIMATE_COMPONENT.EST_COMPONENT_NBR INNER JOIN
                      ESTIMATE_LOG ON ESTIMATE_COMPONENT.ESTIMATE_NUMBER = ESTIMATE_LOG.ESTIMATE_NUMBER INNER JOIN
                      JOB_COMPONENT ON ESTIMATE_COMPONENT.ESTIMATE_NUMBER = JOB_COMPONENT.ESTIMATE_NUMBER AND 
                      ESTIMATE_COMPONENT.EST_COMPONENT_NBR = JOB_COMPONENT.EST_COMPONENT_NBR AND 
                      JOB_SPECS.JOB_NUMBER = JOB_COMPONENT.JOB_NUMBER AND 
                      JOB_SPECS.JOB_COMPONENT_NBR = JOB_COMPONENT.JOB_COMPONENT_NBR LEFT OUTER JOIN
                      JOB_SPEC_APPR ON JOB_SPECS.JOB_NUMBER = JOB_SPEC_APPR.JOB_NUMBER AND 
                      JOB_SPECS.JOB_COMPONENT_NBR = JOB_SPEC_APPR.JOB_COMPONENT_NBR AND 
                      JOB_SPECS.SPEC_VER = JOB_SPEC_APPR.APPR_SPEC_VER
WHERE     (ESTIMATE_QUOTE.ESTIMATE_NUMBER = @EstNumber) AND (ESTIMATE_QUOTE.EST_COMPONENT_NBR = @EstCompNumber) AND 
                      (ESTIMATE_QUOTE.EST_QUOTE_NBR = @EstQuote)
                                                 




