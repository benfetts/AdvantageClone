
CREATE PROCEDURE [dbo].[usp_wv_SEC_EMP_RESTRICTED_TO_SELF] /*WITH ENCRYPTION*/
@USER_ID  VARCHAR(100)
AS
/*=========== QUERY ===========*/

	DECLARE @CT               INT,
			@SINGLE_EMP_CODE  VARCHAR(6),
			@SINGLE_EMP_NAME  VARCHAR(100)
	

	SELECT @CT = COUNT(1)
	FROM   SEC_EMP WITH(NOLOCK)
	WHERE  [USER_ID] = @USER_ID;

	IF @CT = 1
	BEGIN
		SELECT @SINGLE_EMP_CODE = EMP_CODE
		FROM   SEC_EMP WITH(NOLOCK)
		WHERE  [USER_ID] = @USER_ID;
		SELECT @SINGLE_EMP_NAME = (
				   ISNULL(EMP_FNAME + ' ', '') + ISNULL(EMP_MI + '. ', '') + EMP_LNAME
			   )
		FROM   EMPLOYEE WITH(NOLOCK)
		WHERE  EMP_CODE = @SINGLE_EMP_CODE;
	END

	SELECT ISNULL(@SINGLE_EMP_CODE, '') AS EMP_CODE,
		   ISNULL(@SINGLE_EMP_NAME, '') AS EMP_FML;

/*=========== QUERY ===========*/
