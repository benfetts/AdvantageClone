

CREATE PROCEDURE [dbo].[usp_wv_SaveAgencyImageSettings]
	@BINARY_IMAGE_CODE varchar(20),
	@BINARY_IMAGE_DESC varchar(100),
	@BINARY_IMAGE_VALUE image,
	@BINARY_IMAGE_APP smallint
AS

IF EXISTS (
           SELECT *
           FROM   AGY_BINARY_IMAGES WITH(NOLOCK)
           WHERE  BINARY_IMAGE_CODE = @BINARY_IMAGE_CODE
       )
		BEGIN
			--UPDATE
			UPDATE AGY_BINARY_IMAGES
			SET    BINARY_IMAGE_VALUE = @BINARY_IMAGE_VALUE
			WHERE  BINARY_IMAGE_CODE = @BINARY_IMAGE_CODE;
		END
    ELSE
		BEGIN
			--INSERT
			INSERT INTO AGY_BINARY_IMAGES
			  (
				BINARY_IMAGE_CODE,
				BINARY_IMAGE_DESC,
				BINARY_IMAGE_VALUE,
				BINARY_IMAGE_APP
			  )
			VALUES
			  (
				@BINARY_IMAGE_CODE,
				@BINARY_IMAGE_DESC,
				@BINARY_IMAGE_VALUE,
				@BINARY_IMAGE_APP
			  );
		END

