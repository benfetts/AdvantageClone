

CREATE PROCEDURE [dbo].[usp_wv_Vendor_Quote_GetRequestVendors]
(
	@EstNo Int,
	@EstCompNo Int,
	@VendorQteNo Int,
	@UserID varchar(100)
)
AS
Declare @Restrictions Int,
		@sql nvarchar(4000),
		@paramlist nvarchar(4000)

Select @Restrictions = Count(*) 
FROM SEC_CLIENT
WHERE UPPER(USER_ID) = UPPER(@UserID)


SELECT     VENDOR_QTE_HDR.ESTIMATE_NUMBER, VENDOR_QTE_HDR.EST_COMPONENT_NBR, VENDOR_QTE_HDR.VENDOR_QTE_NBR, 
                      VENDOR_QTE_VEN.VN_CODE, VENDOR.VN_NAME, VENDOR_QTE_VEN.VN_CONT_CODE, VEN_CONT.VC_FNAME, VEN_CONT.VC_MI, 
                      VEN_CONT.VC_LNAME, ISNULL(VEN_CONT.EMAIL_ADDRESS,'') AS EMAIL_ADDRESS, VEN_CONT.VC_ADDRESS1, VEN_CONT.VC_ADDRESS2, 
                      VEN_CONT.VC_CITY, VEN_CONT.VC_STATE, VEN_CONT.VC_ZIP, VEN_CONT.VC_TELEPHONE, 
                      VENDOR_QTE_VEN.VN_NOTES, VENDOR_QTE_VEN.DISPATCH_DATE, VENDOR_QTE_VEN.DUE_DATE, VENDOR_QTE_VEN.REPLY_DATE,
					  VENDOR_QTE_VEN.SUBMITTED_BY
FROM         VENDOR_QTE_HDR INNER JOIN
                      VENDOR_QTE_VEN ON VENDOR_QTE_HDR.ESTIMATE_NUMBER = VENDOR_QTE_VEN.ESTIMATE_NUMBER AND 
                      VENDOR_QTE_HDR.EST_COMPONENT_NBR = VENDOR_QTE_VEN.EST_COMPONENT_NBR AND 
                      VENDOR_QTE_HDR.VENDOR_QTE_NBR = VENDOR_QTE_VEN.VENDOR_QTE_NBR LEFT OUTER JOIN
                      VEN_CONT ON VENDOR_QTE_VEN.VN_CONT_CODE = VEN_CONT.VC_CODE AND 
						VENDOR_QTE_VEN.VN_CODE = VEN_CONT.VN_CODE LEFT OUTER JOIN
                      VENDOR ON VENDOR_QTE_VEN.VN_CODE = VENDOR.VN_CODE
WHERE     (VENDOR_QTE_HDR.ESTIMATE_NUMBER = @EstNo) AND (VENDOR_QTE_HDR.EST_COMPONENT_NBR = @EstCompNo) AND (VENDOR_QTE_HDR.VENDOR_QTE_NBR = @VendorQteNo)




