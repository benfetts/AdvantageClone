if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[usp_wv_Vendor_Quote_UpdateDetail]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
drop procedure [dbo].[usp_wv_Vendor_Quote_UpdateDetail]
GO

CREATE PROCEDURE [dbo].[usp_wv_Vendor_Quote_UpdateDetail]
(
	@ESTIMATE_NUMBER INT,
	@EST_COMPONENT_NBR SMALLINT,
	@VENDOR_QTE_NBR INT,
	@EST_QUOTE_NBR INT,
	@EST_REV_NBR INT,
	@EST_FNC_CODE VARCHAR(6),
	@VN_CODE VARCHAR(6),	
	@REPLY_RATE decimal(9, 4),
	@REPLY_AMT decimal(15, 2),
	@REPLY_NOTES TEXT,
	@APPROVED_FLAG SMALLINT,
	@APPROVAL_NOTES TEXT,
	@APPROVED_BY VARCHAR(100),
	@APPROVED_DATE SMALLDATETIME,
	@QTY INT,
	@CREATE_DATE SMALLDATETIME
)
AS
BEGIN
	SET NOCOUNT OFF
	
	DECLARE 
	@ERR INT--,
	--@NEXT_EST_NBR INT
	
    --SELECT @NEXT_EST_NBR = ISNULL(MAX(ESTIMATE_NUMBER),-1) + 1 FROM ESTIMATE_LOG 

	UPDATE [VENDOR_QTE_DTL]
	SET	[REPLY_RATE] = @REPLY_RATE,
		[REPLY_AMT] = @REPLY_AMT,
		[REPLY_NOTES] = @REPLY_NOTES,
		[APPROVED_FLAG] = @APPROVED_FLAG,
		[APPROVAL_NOTES] = @APPROVAL_NOTES,
		[APPROVED_BY] = @APPROVED_BY,
		[APPROVED_DATE] = @APPROVED_DATE,
		[QTY] = @QTY,
		[CREATE_DATE] = @CREATE_DATE
	WHERE [ESTIMATE_NUMBER] = @ESTIMATE_NUMBER AND
		  [EST_COMPONENT_NBR] = @EST_COMPONENT_NBR AND
		  [VENDOR_QTE_NBR] = @VENDOR_QTE_NBR AND	
		  [EST_QUOTE_NBR] = @EST_QUOTE_NBR AND
		  [EST_REV_NBR] = @EST_REV_NBR AND
		  [EST_FNC_CODE] = @EST_FNC_CODE AND
		  [VN_CODE] = @VN_CODE
    
 
	SET @ERR = @@Error

	--RETURN @ERR
END




