

CREATE PROCEDURE [dbo].[usp_wv_Vendor_UpdateContact]
(
	@VN_CODE VARCHAR(6),
	@VC_CODE VARCHAR(4),
	@VC_FNAME VARCHAR(30),
	@VC_LNAME VARCHAR(30),
	@VC_MI VARCHAR(1),
	@VC_TITLE VARCHAR(40),
	@VC_ADDRESS1 VARCHAR(40),
	@VC_ADDRESS2 VARCHAR(40),
	@VC_CITY VARCHAR(20),
	@VC_COUNTY VARCHAR(20),
	@VC_STATE VARCHAR(10),
	@VC_COUNTRY VARCHAR(20),
	@VC_ZIP VARCHAR(10),
	@VC_TELEPHONE VARCHAR(13),
	@VC_EXTENTION VARCHAR(4),
	@VC_FAX VARCHAR(13),
	@VC_FAX_EXTENTION VARCHAR(4),
	@EMAIL_ADDRESS VARCHAR(50),
	@VC_PHONE_CELL VARCHAR(13)
)
AS
BEGIN
	SET NOCOUNT OFF
	
	DECLARE 
	@ERR INT--,
	--@NEXT_EST_NBR INT
	
    --SELECT @NEXT_EST_NBR = ISNULL(MAX(ESTIMATE_NUMBER),-1) + 1 FROM ESTIMATE_LOG 

	UPDATE [VEN_CONT]
	SET [VC_FNAME] = @VC_FNAME,
		[VC_LNAME] = @VC_LNAME,
		[VC_MI] = @VC_MI,
		[VC_TITLE] = @VC_TITLE,
		[VC_ADDRESS1] = @VC_ADDRESS1,
		[VC_ADDRESS2] = @VC_ADDRESS2,
		[VC_CITY] = @VC_CITY,
		[VC_COUNTY] = @VC_COUNTY,
		[VC_STATE] = @VC_STATE,
		[VC_COUNTRY] = @VC_COUNTRY,
		[VC_ZIP] = @VC_ZIP,
		[VC_TELEPHONE] = @VC_TELEPHONE,
		[VC_EXTENTION] = @VC_EXTENTION,
		[VC_FAX] = @VC_FAX,
		[VC_FAX_EXTENTION] = @VC_FAX_EXTENTION,
		[EMAIL_ADDRESS] = @EMAIL_ADDRESS,
		[VC_PHONE_CELL] = @VC_PHONE_CELL
	WHERE [VN_CODE] = @VN_CODE AND
		  [VC_CODE] = @VC_CODE
    
 
	SET @ERR = @@Error

	--RETURN @ERR
END




