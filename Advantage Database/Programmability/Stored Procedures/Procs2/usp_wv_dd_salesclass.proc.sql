
CREATE PROCEDURE [dbo].[usp_wv_dd_salesclass] 
@FromApp varchar(6)
AS
DECLARE @NonMediaCount INT

SELECT @NonMediaCount = ISNULL(COUNT(1),0)
FROM SALES_CLASS
WHERE
(INACTIVE_FLAG IS NULL OR  INACTIVE_FLAG = 0) 
AND (SC_TYPE IS NULL OR SC_TYPE NOT IN ('T', 'M', 'N', 'I', 'R','O'))

IF @FromApp = 'DPS'
Begin
	IF @NonMediaCount > 0 
		BEGIN
			SELECT DISTINCT SC_CODE AS code, ISNULL(SC_DESCRIPTION, '') AS description
			,SC_DESCRIPTION as Name
			FROM         SALES_CLASS
			WHERE     (INACTIVE_FLAG IS NULL OR  INACTIVE_FLAG = 0) 
			AND (SC_TYPE IS NULL OR SC_TYPE NOT IN ('T', 'M', 'N', 'I', 'R','O'))
			ORDER BY ISNULL(SC_DESCRIPTION, '')
		END
	ELSE
	BEGIN
			SELECT DISTINCT SC_CODE AS code, ISNULL(SC_DESCRIPTION, '') AS description
			,SC_DESCRIPTION as Name
			FROM         SALES_CLASS
			WHERE     (INACTIVE_FLAG IS NULL OR  INACTIVE_FLAG = 0) 
			ORDER BY ISNULL(SC_DESCRIPTION, '')
	END
End
Else
Begin
	IF @NonMediaCount > 0 
		BEGIN
			SELECT DISTINCT SC_CODE AS code, SC_CODE + ' - ' + ISNULL(SC_DESCRIPTION, '') AS description
			,SC_DESCRIPTION as Name
			FROM         SALES_CLASS
			WHERE     (INACTIVE_FLAG IS NULL OR  INACTIVE_FLAG = 0) 
			AND (SC_TYPE IS NULL OR SC_TYPE NOT IN ('T', 'M', 'N', 'I', 'R','O'))
			ORDER BY SC_DESCRIPTION
		END
	ELSE
	BEGIN
			SELECT DISTINCT SC_CODE AS code, SC_CODE + ' - ' + ISNULL(SC_DESCRIPTION, '') AS description
			,SC_DESCRIPTION as Name
			FROM         SALES_CLASS
			WHERE     (INACTIVE_FLAG IS NULL OR  INACTIVE_FLAG = 0) 
			ORDER BY SC_DESCRIPTION
	END
END