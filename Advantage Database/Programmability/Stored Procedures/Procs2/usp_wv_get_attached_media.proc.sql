--DROP PROCEDURE [dbo].[usp_wv_get_attached_media]
CREATE PROCEDURE [dbo].[usp_wv_get_attached_media] 
@Type as varchar(3),
@CmpID as Integer
AS

DECLARE @CmpIDStr as varchar(10)
DECLARE @sql AS VARCHAR(4000)

set @CmpIDStr = CAST(@CmpID as VARCHAR(10))

If @Type = 'INT'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10)) + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD
		FROM INTERNET_HEADER XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr 

If @Type = 'MAG'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10))  + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD
		FROM MAGAZINE_HEADER XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr 
		
If @Type = 'NEW'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10)) + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD
		FROM NEWSPAPER_HEADER XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr 
		
If @Type = 'OOH'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10)) + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD
		FROM OUTDOOR_HEADER XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr
		
If @Type = 'RAD'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10)) + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD
		FROM RADIO_HDR XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr 
		
If @Type = 'TV'
	set @sql = 'SELECT CAST(ORDER_NBR AS VARCHAR(10)) AS Code, 
		SUBSTRING(''000000'', 1, 6 - LEN(ORDER_NBR)) + CAST(ORDER_NBR AS VARCHAR(10)) + ''-'' + ORDER_DESC + '' / '' + VENDOR.VN_CODE + ''-'' + VENDOR.VN_NAME AS Description,
		ORDER_NBR AS SORTFLD 
		FROM TV_HDR XX
		INNER JOIN VENDOR ON VENDOR.VN_CODE = XX.VN_CODE
		WHERE XX.CMP_IDENTIFIER = ' + @CmpIDStr 
		
If @Type = 'JOB'
	set @sql = 'SELECT CAST(JOB_NUMBER AS VARCHAR(10)) AS Code, 
			SUBSTRING(''000000'', 1, 6 - LEN(JOB_NUMBER)) + CAST(JOB_NUMBER AS VARCHAR(10)) + ''-'' + JOB_DESC AS Description,
		JOB_NUMBER AS SORTFLD
		FROM JOB_LOG XX
		WHERE CMP_IDENTIFIER = ' + @CmpIDStr

set @sql = @sql + ' ORDER BY SORTFLD'

EXEC(@sql)
--print(@sql)


