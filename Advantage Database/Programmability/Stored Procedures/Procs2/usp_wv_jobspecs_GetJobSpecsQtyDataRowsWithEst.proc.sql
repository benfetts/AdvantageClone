
CREATE PROCEDURE [dbo].[usp_wv_jobspecs_GetJobSpecsQtyDataRowsWithEst] 
@JobNumber Int,
@JobCompNumber Int,
@Version Int,
@Revision Int
AS

Set NoCount On
SELECT     JOB_SPEC_QTY.JOB_NUMBER, JOB_SPEC_QTY.JOB_COMPONENT_NBR, ISNULL(ESTIMATE_REV.ESTIMATE_NUMBER, '') AS EstimateNumber, 
                      ISNULL(ESTIMATE_REV.EST_COMPONENT_NBR, '') AS CompNum, ISNULL(ESTIMATE_REV.EST_QUOTE_NBR, '') AS QuoteNum, ISNULL(ESTIMATE_REV.EST_REV_NBR, '') AS RevNum, 
                      JOB_SPEC_QTY.SPEC_VER, JOB_SPEC_QTY.SPEC_REV, JOB_SPEC_QTY.SEQ_NBR AS SeqNum, ISNULL(JOB_SPEC_QTY.JOB_QTY, '') AS Quantity
FROM         JOB_COMPONENT INNER JOIN
                      ESTIMATE_QUOTE ON JOB_COMPONENT.ESTIMATE_NUMBER = ESTIMATE_QUOTE.ESTIMATE_NUMBER AND 
                      JOB_COMPONENT.EST_COMPONENT_NBR = ESTIMATE_QUOTE.EST_COMPONENT_NBR INNER JOIN
                      ESTIMATE_REV ON ESTIMATE_QUOTE.ESTIMATE_NUMBER = ESTIMATE_REV.ESTIMATE_NUMBER AND 
                      ESTIMATE_QUOTE.EST_COMPONENT_NBR = ESTIMATE_REV.EST_COMPONENT_NBR AND 
                      ESTIMATE_QUOTE.EST_QUOTE_NBR = ESTIMATE_REV.EST_QUOTE_NBR RIGHT OUTER JOIN
                      JOB_SPEC_QTY ON JOB_COMPONENT.JOB_NUMBER = JOB_SPEC_QTY.JOB_NUMBER AND 
                      JOB_COMPONENT.JOB_COMPONENT_NBR = JOB_SPEC_QTY.JOB_COMPONENT_NBR AND 
                      ESTIMATE_REV.SPEC_VER = JOB_SPEC_QTY.SPEC_VER AND ESTIMATE_REV.SPEC_REV = JOB_SPEC_QTY.SPEC_REV AND 
                      ESTIMATE_REV.SPEC_QTY_SEQ_NBR = JOB_SPEC_QTY.SEQ_NBR
WHERE     (JOB_SPEC_QTY.JOB_NUMBER = @JobNumber) AND (JOB_SPEC_QTY.JOB_COMPONENT_NBR = @JobCompNumber) AND (JOB_SPEC_QTY.SPEC_VER = @Version) AND 
                      (JOB_SPEC_QTY.SPEC_REV = @Revision)


	
