





CREATE PROCEDURE [dbo].[usp_wv_jobspecs_GetMediaSpecs]
@JobNumber int,
@JobCompNumber int,
@VendorCode varchar(50)
AS


SELECT    MEDIA_SPECS_HDR.AD_SIZE, ISNULL(MEDIA_SPECS_DTL.SPEC_DATA, '') AS DATA, AD_SIZE.SIZE_DESC, 
                      AD_SIZE_LABEL.LABEL_SEQ, AD_SIZE_LABEL.LABEL_DESC, VENDOR.VN_CODE, VENDOR.VN_NAME
FROM      MEDIA_SPECS_DTL INNER JOIN
                      MEDIA_SPECS_HDR ON MEDIA_SPECS_DTL.SPEC_ID = MEDIA_SPECS_HDR.SPEC_ID INNER JOIN
                      AD_SIZE ON MEDIA_SPECS_HDR.AD_SIZE = AD_SIZE.SIZE_CODE INNER JOIN
                      AD_SIZE_LABEL ON MEDIA_SPECS_DTL.MEDIA_TYPE = AD_SIZE_LABEL.MEDIA_TYPE AND 
                      MEDIA_SPECS_DTL.LABEL_ID = AD_SIZE_LABEL.LABEL_ID INNER JOIN
                      JOB_PUB_VENDOR ON dbo.MEDIA_SPECS_HDR.VN_CODE = JOB_PUB_VENDOR.VN_CODE INNER JOIN
                      VENDOR ON JOB_PUB_VENDOR.VN_CODE = VENDOR.VN_CODE
WHERE     AD_SIZE_LABEL.INACTIVE_FLAG <> 1 AND JOB_PUB_VENDOR.JOB_NUMBER = @JobNumber AND JOB_PUB_VENDOR.JOB_COMPONENT_NBR = @JobCompNumber      
			 AND MEDIA_SPECS_HDR.VN_CODE = @VendorCode                                            
ORDER BY  MEDIA_SPECS_HDR.SPEC_ID, AD_SIZE_LABEL.LABEL_SEQ



