if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[usp_wv_jobspecs_GetMediaSpecsData]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
drop procedure [dbo].[usp_wv_jobspecs_GetMediaSpecsData]
GO





CREATE PROCEDURE [dbo].[usp_wv_jobspecs_GetMediaSpecsData]
@JobNumber int,
@JobCompNumber int
AS


SELECT    MEDIA_SPECS_HDR.AD_SIZE, ISNULL(MEDIA_SPECS_DTL.SPEC_DATA, '') AS DATA, AD_SIZE.SIZE_DESC, 
                      AD_SIZE_LABEL.LABEL_SEQ, AD_SIZE_LABEL.LABEL_DESC, VENDOR.VN_CODE, VENDOR.VN_NAME, MEDIA_SPECS_HDR.SPEC_ID
FROM      MEDIA_SPECS_DTL INNER JOIN
                      MEDIA_SPECS_HDR ON MEDIA_SPECS_DTL.SPEC_ID = MEDIA_SPECS_HDR.SPEC_ID INNER JOIN
                      AD_SIZE ON MEDIA_SPECS_HDR.AD_SIZE = AD_SIZE.SIZE_CODE INNER JOIN
                      AD_SIZE_LABEL ON MEDIA_SPECS_DTL.MEDIA_TYPE = AD_SIZE_LABEL.MEDIA_TYPE AND 
                      MEDIA_SPECS_DTL.LABEL_ID = AD_SIZE_LABEL.LABEL_ID INNER JOIN
                      JOB_PUB_VENDOR ON dbo.MEDIA_SPECS_HDR.VN_CODE = JOB_PUB_VENDOR.VN_CODE AND MEDIA_SPECS_HDR.AD_SIZE = JOB_PUB_VENDOR.AD_SIZE INNER JOIN
                      VENDOR ON JOB_PUB_VENDOR.VN_CODE = VENDOR.VN_CODE
WHERE     AD_SIZE_LABEL.INACTIVE_FLAG <> 1 AND JOB_PUB_VENDOR.JOB_NUMBER = @JobNumber AND JOB_PUB_VENDOR.JOB_COMPONENT_NBR = @JobCompNumber 
--UNION
--SELECT    MEDIA_SPECS_HDR.AD_SIZE, ISNULL(MEDIA_SPECS_DTL.SPEC_DATA, '') AS DATA, AD_SIZE.SIZE_DESC, 
--                      AD_SIZE_LABEL.LABEL_SEQ, AD_SIZE_LABEL.LABEL_DESC, VENDOR.VN_CODE, VENDOR.VN_NAME, MEDIA_SPECS_HDR.SPEC_ID
--FROM      MEDIA_SPECS_DTL INNER JOIN
--                      MEDIA_SPECS_HDR ON MEDIA_SPECS_DTL.SPEC_ID = MEDIA_SPECS_HDR.SPEC_ID INNER JOIN
--                      AD_SIZE ON MEDIA_SPECS_HDR.AD_SIZE = AD_SIZE.SIZE_CODE INNER JOIN
--                      AD_SIZE_LABEL ON MEDIA_SPECS_DTL.MEDIA_TYPE = AD_SIZE_LABEL.MEDIA_TYPE AND 
--                      MEDIA_SPECS_DTL.LABEL_ID = AD_SIZE_LABEL.LABEL_ID INNER JOIN
--                      JOB_PUB_VENDOR ON dbo.MEDIA_SPECS_HDR.VN_CODE = JOB_PUB_VENDOR.VN_CODE INNER JOIN
--                      VENDOR ON JOB_PUB_VENDOR.VN_CODE = VENDOR.VN_CODE
--WHERE     AD_SIZE_LABEL.INACTIVE_FLAG <> 1 AND JOB_PUB_VENDOR.JOB_NUMBER = @JobNumber AND JOB_PUB_VENDOR.JOB_COMPONENT_NBR = @JobCompNumber AND (JOB_PUB_VENDOR.AD_SIZE IS NULL OR JOB_PUB_VENDOR.AD_SIZE = '')
--ORDER BY  MEDIA_SPECS_HDR.SPEC_ID, AD_SIZE_LABEL.LABEL_SEQ



