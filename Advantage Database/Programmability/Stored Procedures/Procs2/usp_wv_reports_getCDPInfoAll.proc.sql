

CREATE PROCEDURE [dbo].[usp_wv_reports_getCDPInfoAll]
@LEVEL varchar(25),
@CLIENT varchar(6),
@DIVISION varchar(6),
@PRODUCT varchar(6),
@CONTACT varchar(6)
AS

if @LEVEL = 'Client'
Begin
	SELECT     CL_CODE, CL_NAME, ISNULL(CL_BADDRESS1,'') AS CL_BADDRESS1, ISNULL(CL_BADDRESS2,'') AS CL_BADDRESS2, ISNULL(CL_BCITY,'') AS CL_BCITY, ISNULL(CL_BSTATE,'') AS CL_BSTATE, ISNULL(CL_BZIP,'') AS CL_BZIP, ISNULL(CL_FOOTER,'') AS CL_FOOTER, ISNULL(CL_ATTENTION,'') AS CL_ATTENTION
	FROM         CLIENT
	--WHERE     (CL_CODE = @CLIENT)
End

if @LEVEL = 'Division'
Begin
	SELECT     DIVISION.CL_CODE, CLIENT.CL_NAME, DIVISION.DIV_CODE, DIVISION.DIV_NAME, ISNULL(DIVISION.DIV_BADDRESS1,'') AS DIV_BADDRESS1, ISNULL(DIVISION.DIV_BADDRESS2,'') AS DIV_BADDRESS2, 
                      ISNULL(DIVISION.DIV_BCITY,'') AS DIV_BCITY, ISNULL(DIVISION.DIV_BSTATE,'') AS DIV_BSTATE, ISNULL(DIVISION.DIV_BZIP,'') AS DIV_BZIP, ISNULL(CLIENT.CL_FOOTER,'') AS CL_FOOTER, ISNULL(DIVISION.DIV_ATTENTION,'') AS DIV_ATTENTION
	FROM         DIVISION INNER JOIN
                      CLIENT ON DIVISION.CL_CODE = CLIENT.CL_CODE
	--WHERE     (DIVISION.CL_CODE = @CLIENT) AND (DIVISION.DIV_CODE = @DIVISION)
End

if @LEVEL = 'Product'
Begin
	SELECT     PRODUCT.CL_CODE, CLIENT.CL_NAME, PRODUCT.DIV_CODE, DIVISION.DIV_NAME, PRODUCT.PRD_CODE, 
                      PRODUCT.PRD_DESCRIPTION, ISNULL(PRODUCT.PRD_BILL_ADDRESS1,'') AS PRD_BILL_ADDRESS1, ISNULL(PRODUCT.PRD_BILL_ADDRESS2,'') AS PRD_BILL_ADDRESS2, ISNULL(PRODUCT.PRD_BILL_CITY,'') AS PRD_BILL_CITY, 
                      ISNULL(PRODUCT.PRD_BILL_STATE,'') AS PRD_BILL_STATE, ISNULL(PRODUCT.PRD_BILL_ZIP,'') AS PRD_BILL_ZIP, PRODUCT.PRD_BILL_TELEPHONE, PRODUCT.PRD_BILL_FAX, ISNULL(CLIENT.CL_FOOTER,'') AS CL_FOOTER, ISNULL(PRODUCT.PRD_ATTENTION,'') AS PRD_ATTENTION,
                      ISNULL(USER_DEFINED1, '') AS USER_DEFINED1, ISNULL(USER_DEFINED2, '') AS USER_DEFINED2
	FROM         DIVISION INNER JOIN
                      CLIENT ON DIVISION.CL_CODE = CLIENT.CL_CODE INNER JOIN
                      PRODUCT ON DIVISION.CL_CODE = PRODUCT.CL_CODE AND DIVISION.DIV_CODE = PRODUCT.DIV_CODE         
	--WHERE     (PRODUCT.CL_CODE = @CLIENT) AND (PRODUCT.DIV_CODE = @DIVISION) AND (PRODUCT.PRD_CODE = @PRODUCT)
End

        



