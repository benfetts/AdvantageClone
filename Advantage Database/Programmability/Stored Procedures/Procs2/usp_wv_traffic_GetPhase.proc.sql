







CREATE PROCEDURE [dbo].[usp_wv_traffic_GetPhase]
@PhaseID Int
 AS
/*
SELECT 0 AS Code,'[None] - 0' AS Description
UNION
SELECT TRAFFIC_PHASE_ID AS Code, ISNULL(PHASE_DESC,'') + ' - ' + CONVERT(VARCHAR(6), ISNULL(PHASE_ORDER,0)) AS Description
FROM TRAFFIC_PHASE
WHERE (INACTIVE_FLAG = 0) OR (INACTIVE_FLAG IS NULL)
*/
IF EXISTS (
	SELECT TRAFFIC_PHASE_ID 
	FROM TRAFFIC_PHASE
	WHERE TRAFFIC_PHASE_ID = @PhaseID
	AND (INACTIVE_FLAG = 0) OR (INACTIVE_FLAG IS NULL)
	)
	SELECT 0 AS Code,'[None] - 0' AS Description
	UNION
	SELECT TRAFFIC_PHASE_ID AS Code, ISNULL(PHASE_DESC,'') + ' - ' + CONVERT(VARCHAR(6), ISNULL(PHASE_ORDER,0)) AS Description
	FROM TRAFFIC_PHASE
	WHERE (INACTIVE_FLAG = 0) OR (INACTIVE_FLAG IS NULL)
ELSE
	SELECT 0 AS Code,'[None] - 0' AS Description
	UNION
	SELECT TRAFFIC_PHASE_ID AS Code, ISNULL(PHASE_DESC,'') + ' - ' + CONVERT(VARCHAR(6), ISNULL(PHASE_ORDER,0)) AS Description
	FROM TRAFFIC_PHASE                      
	WHERE (INACTIVE_FLAG = 0) OR (INACTIVE_FLAG IS NULL)
	UNION
	SELECT TRAFFIC_PHASE_ID AS Code, ISNULL(PHASE_DESC,'') + ' - ' + CONVERT(VARCHAR(6), ISNULL(PHASE_ORDER,0)) AS Description 
	FROM TRAFFIC_PHASE
	WHERE TRAFFIC_PHASE_ID = @PhaseID








