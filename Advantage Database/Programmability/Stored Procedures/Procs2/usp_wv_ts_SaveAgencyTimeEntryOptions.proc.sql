IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'[dbo].[usp_wv_ts_SaveAgencyTimeEntryOptions]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_wv_ts_SaveAgencyTimeEntryOptions]
GO
CREATE PROCEDURE [dbo].[usp_wv_ts_SaveAgencyTimeEntryOptions] /*WITH ENCRYPTION*/
@TS_MIN_TIME DECIMAL(7,2),
@TS_ROUND_TO DECIMAL(7,2),
@TS_STOP_MIN_TIME DECIMAL(7,2),
@TS_STOP_ROUND_TO DECIMAL(7,2),
@TS_REQ_CMT_APPR BIT,
@TS_START_WEEK_ON SMALLINT,
@TS_REQ_HRS_MET_APPR BIT,
@TS_REQ_HRS_APPR_TYPE SMALLINT
AS
/*=========== QUERY ===========*/
	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_MIN_TIME
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_MIN_TIME';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_ROUND_TO
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_ROUND_TO';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_STOP_MIN_TIME
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_STOP_MIN_TIME';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_STOP_ROUND_TO
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_STOP_ROUND_TO';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_REQ_CMT_APPR
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_REQ_CMT_APPR';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_START_WEEK_ON
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_START_WEEK_ON';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_REQ_HRS_MET_APPR
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_REQ_HRS_MET_APPR';

	UPDATE AGY_SETTINGS WITH(ROWLOCK)
	SET AGY_SETTINGS.AGY_SETTINGS_VALUE = @TS_REQ_HRS_APPR_TYPE
	WHERE AGY_SETTINGS.AGY_SETTINGS_CODE = 'TS_REQ_HRS_APPR_TYPE';

/*=========== QUERY ===========*/
GO
