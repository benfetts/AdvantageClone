
CREATE PROCEDURE [dbo].[usp_wv_update_missing_time_dtl] 
@EMP_CODE AS Varchar(6),
@WORK_DATE AS SMALLDATETIME,
@HOURS_WORKED DECIMAL(4,2)
AS

DECLARE @MISSING_TIME SMALLINT

SELECT @MISSING_TIME = MISSING_TIME_ONLY FROM MISSING_TIME_HDR

IF 	@MISSING_TIME = 1 
	DELETE MISSING_TIME_DTL
	WHERE EMP_CODE = @EMP_CODE AND WORKDATE = @WORK_DATE;

ELSE
	UPDATE MISSING_TIME_DTL
	SET HOURS_WORKED = @HOURS_WORKED, VARIANCE = STANDARD_HRS - @HOURS_WORKED
	WHERE EMP_CODE = @EMP_CODE AND WORKDATE = @WORK_DATE;



