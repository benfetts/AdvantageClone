if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[V_DRPT_CAMPAIGN]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[V_DRPT_CAMPAIGN]
GO

CREATE VIEW [dbo].[V_DRPT_CAMPAIGN]

WITH SCHEMABINDING 
AS

SELECT [ID] = NEWID(),
	   [ClientCode] = CAMPAIGN.CL_CODE, 
       [ClientDescription] = CLIENT.CL_NAME,
       [DivisionCode] = CAMPAIGN.DIV_CODE, 
       [DivisionDescription] = DIVISION.DIV_NAME,
       [ProductCode] = CAMPAIGN.PRD_CODE,
       [ProductDescription] = PRODUCT.PRD_DESCRIPTION,       
       [CampaignCode] = CAMPAIGN.CMP_CODE, 
       [CampaignName] = CAMPAIGN.CMP_NAME,  
       [CampaignID] = CAMPAIGN.CMP_IDENTIFIER,
	   [Closed] = CASE WHEN CAMPAIGN.CMP_CLOSED = 1 THEN 'Yes' ELSE 'No' END, 
	   [AlertGroup] = CAMPAIGN.ALERT_GROUP,
	   [AdNumber] = CAMPAIGN.AD_NBR, 
	   [Market] = CAMPAIGN.MARKET_CODE,
	   [MarketDescription] = MARKET.MARKET_DESC,
	   [JobNumber] = CAMPAIGN.JOB_NUMBER,
	   [JobDescription] = JOB_LOG.JOB_DESC,
	   [JobComponentNumber] = CAMPAIGN.JOB_COMPONENT_NBR,
	   [JobComponentDescription] = JOB_COMPONENT.JOB_COMP_DESC,
       [BeginDate] = CAMPAIGN.CMP_BEG_DATE, 
       [EndDate] = CAMPAIGN.CMP_END_DATE, 
       [TotalBilling] = CAMPAIGN.CMP_BILL_BUDGET, 
       [TotalIncome] = CAMPAIGN.CMP_INC_BUDGET, 
       [PostPeriod] = CAMPAIGN_DETAIL.POST_PERIOD,
	   [DetailType] = CAMPAIGN_DETAIL.DTL_CMP_TYPE,
	   [SalesClassCode] = CAMPAIGN_DETAIL.SC_CODE,
	   [SalesClassDescription] = SALES_CLASS.SC_DESCRIPTION,
       [DepartmentTeamCode] = CAMPAIGN_DETAIL.DP_TM_CODE,
	   [DepartmentTeam] = DEPT_TEAM.DP_TM_DESC,
	   [FunctionCode] = CAMPAIGN_DETAIL.FNC_CODE,
	   [FunctionDescription] = FUNCTIONS.FNC_DESCRIPTION,
	   [BillingBudget] = CAMPAIGN_DETAIL.CMP_BILL_BUDGET, 
       [IncomeBuget] = CAMPAIGN_DETAIL.CMP_INC_BUDGET 
FROM dbo.CAMPAIGN LEFT OUTER JOIN
	 dbo.CAMPAIGN_DETAIL ON dbo.CAMPAIGN.CMP_IDENTIFIER = dbo.CAMPAIGN_DETAIL.CMP_IDENTIFIER LEFT OUTER JOIN
	 dbo.CLIENT ON dbo.CAMPAIGN.CL_CODE = dbo.CLIENT.CL_CODE LEFT OUTER JOIN
	 dbo.DIVISION ON dbo.DIVISION.CL_CODE = dbo.CAMPAIGN.CL_CODE AND dbo.DIVISION.DIV_CODE = dbo.CAMPAIGN.DIV_CODE LEFT OUTER JOIN
	 dbo.PRODUCT ON dbo.CAMPAIGN.CL_CODE = dbo.PRODUCT.CL_CODE AND dbo.CAMPAIGN.DIV_CODE = dbo.PRODUCT.DIV_CODE AND dbo.CAMPAIGN.PRD_CODE = dbo.PRODUCT.PRD_CODE LEFT OUTER JOIN
	 dbo.JOB_COMPONENT ON dbo.JOB_COMPONENT.JOB_COMPONENT_NBR = dbo.CAMPAIGN.JOB_COMPONENT_NBR AND dbo.JOB_COMPONENT.JOB_NUMBER = dbo.CAMPAIGN.JOB_NUMBER LEFT OUTER JOIN
     dbo.JOB_LOG ON dbo.JOB_LOG.JOB_NUMBER = dbo.JOB_COMPONENT.JOB_NUMBER LEFT OUTER JOIN
     dbo.MARKET ON dbo.CAMPAIGN.MARKET_CODE = dbo.MARKET.MARKET_CODE LEFT OUTER JOIN
     dbo.DEPT_TEAM ON dbo.DEPT_TEAM.DP_TM_CODE = dbo.CAMPAIGN_DETAIL.DP_TM_CODE LEFT OUTER JOIN
     dbo.SALES_CLASS ON dbo.CAMPAIGN_DETAIL.SC_CODE = dbo.SALES_CLASS.SC_CODE LEFT OUTER JOIN
	 dbo.FUNCTIONS ON dbo.FUNCTIONS.FNC_CODE = dbo.CAMPAIGN_DETAIL.FNC_CODE

GO
