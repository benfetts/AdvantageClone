CREATE VIEW [dbo].[V_ETF_OFFDTLCAT_EMP]

AS

	SELECT 
		[EmployeeTimeForecastID] = OFFDTLCAT_EMP.ETF_ID,
		[EmployeeTimeForecastOfficeDetailID] = OFFDTLCAT_EMP.ETF_OFFDTL_ID,
		[EmployeeTimeForecastOfficeDetailIndirectCategoryID] = OFFDTLCAT_EMP.ETF_OFFDTLCAT_ID,
		[EmployeeTimeForecastOfficeDetailIndirectCategoryEmployeeID] = OFFDTLCAT_EMP.ETF_OFFDTLCAT_EMP_ID,
		[EmployeeTimeForecastOfficeDetailEmployeeID] = OFFDTLCAT_EMP.ETF_OFFDTLEMP_ID,
		[EmployeeCode] = OFFDTLEMP.EMP_CODE,
		[EmployeeName] = CASE WHEN E.EMP_MI IS NULL OR E.EMP_MI = '' THEN RTRIM(LTRIM(ISNULL(E.EMP_FNAME, '') + ' ' + ISNULL(E.EMP_LNAME, ''))) ELSE E.EMP_FNAME + ' ' + E.EMP_MI + '. ' + E.EMP_LNAME END,
		[EmployeeOfficeCode] = E.OFFICE_CODE,
		[EmployeeOfficeDescription] = O.OFFICE_NAME,
		[Hours] = OFFDTLCAT_EMP.[HOURS],
		[BillRate] = OFFDTLEMP.BILL_RATE,
		[CostRate] = OFFDTLEMP.COST_RATE
	FROM 
		dbo.ETF_OFFDTLCAT_EMP OFFDTLCAT_EMP INNER JOIN 
		dbo.ETF_OFFDTLEMP OFFDTLEMP ON OFFDTLEMP.ETF_ID = OFFDTLCAT_EMP.ETF_ID AND
									   OFFDTLEMP.ETF_OFFDTL_ID = OFFDTLCAT_EMP.ETF_OFFDTL_ID AND 
									   OFFDTLEMP.ETF_OFFDTLEMP_ID = OFFDTLCAT_EMP.ETF_OFFDTLEMP_ID INNER JOIN
		dbo.EMPLOYEE E ON E.EMP_CODE = OFFDTLEMP.EMP_CODE LEFT JOIN 
		dbo.OFFICE O ON O.OFFICE_CODE = E.OFFICE_CODE

GO