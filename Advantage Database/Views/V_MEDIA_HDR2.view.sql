
CREATE VIEW dbo.V_MEDIA_HDR2( ORDER_NBR, ORDER_DESC, CL_CODE, DIV_CODE, PRD_CODE, OFFICE_CODE, MEDIA_TYPE, 
		VN_CODE, CLIENT_PO, CLIENT_REF, STATUS, ORDER_DATE, BUYER, BILL_COOP_CODE, ORD_PROCESS_CONTRL, 
		MARKET_CODE, [START_DATE], END_DATE, NET_GROSS, CREATE_DATE, CANCELLED_DATE, MODIFIED_DATE, 
		RECONCILE_FLAG, CMP_CODE, CMP_IDENTIFIER, PRINTED)
AS

--Magazine
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.MAGAZINE_HEADER AS h

--Newspaper
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.NEWSPAPER_HEADER AS h

--Internet
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.INTERNET_HEADER AS h

--Outdoor
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.OUTDOOR_HEADER AS h

--Mag (old)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, p.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, NULL AS CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		NULL AS MARKET_CODE, NULL AS START_DATE, NULL AS END_DATE, NULL AS NET_GROSS, h.CREATE_DATE, NULL AS CANCELLED_DATE, NULL AS MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, NULL AS PRINTED
   FROM dbo.MAG_HEADER AS h INNER JOIN dbo.PRODUCT AS p ON ( h.CL_CODE = p.CL_CODE	AND h.DIV_CODE = p.DIV_CODE	AND h.PRD_CODE = p.PRD_CODE )
		
--News (old)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, p.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, NULL AS CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		NULL AS MARKET_CODE, NULL AS START_DATE, NULL AS END_DATE, NULL AS NET_GROSS, h.CREATE_DATE, NULL AS CANCELLED_DATE, NULL AS MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, NULL AS PRINTED
   FROM dbo.NEWS_HEADER AS h INNER JOIN dbo.PRODUCT AS p ON ( h.CL_CODE = p.CL_CODE AND h.DIV_CODE = p.DIV_CODE AND h.PRD_CODE = p.PRD_CODE )

--Radio (old)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, p.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, NULL AS CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, FLIGHT_FROM, FLIGHT_TO, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, NULL AS MODIFIED_DATE, 
		h.RECONCILE_FLAG, NULL AS CMP_CODE, h.CMP_IDENTIFIER, NULL AS PRINTED
   FROM dbo.RADIO_HEADER AS h INNER JOIN dbo.PRODUCT AS p ON ( h.CL_CODE = p.CL_CODE AND h.DIV_CODE = p.DIV_CODE AND h.PRD_CODE = p.PRD_CODE )
WHERE h.REV_NBR = ( SELECT MAX(h1.REV_NBR) FROM dbo.RADIO_HEADER AS h1 WHERE h.ORDER_NBR = h1.ORDER_NBR )

--Television (old)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, p.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, NULL AS CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, FLIGHT_FROM, FLIGHT_TO, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, NULL AS MODIFIED_DATE, 
		h.RECONCILE_FLAG, NULL AS CMP_CODE, h.CMP_IDENTIFIER, NULL AS PRINTED
   FROM dbo.TV_HEADER AS h INNER JOIN dbo.PRODUCT AS p ON ( h.CL_CODE = p.CL_CODE AND h.DIV_CODE = p.DIV_CODE AND h.PRD_CODE = p.PRD_CODE )
  WHERE h.REV_NBR = ( SELECT MAX( h1.REV_NBR ) FROM dbo.TV_HEADER AS h1 WHERE h.ORDER_NBR = h1.ORDER_NBR )

-- Radio (new)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.RADIO_HDR AS h

-- Television (new)
UNION 
 SELECT h.ORDER_NBR, h.ORDER_DESC, h.CL_CODE, h.DIV_CODE, h.PRD_CODE, h.OFFICE_CODE, h.MEDIA_TYPE, 
		h.VN_CODE, h.CLIENT_PO, h.CLIENT_REF, h.STATUS, h.ORDER_DATE, h.BUYER, h.BILL_COOP_CODE, h.ORD_PROCESS_CONTRL, 
		h.MARKET_CODE, h.START_DATE, h.END_DATE, h.NET_GROSS, h.CREATE_DATE, h.CANCELLED_DATE, h.MODIFIED_DATE, 
		h.RECONCILE_FLAG, h.CMP_CODE, h.CMP_IDENTIFIER, h.PRINTED
   FROM dbo.TV_HDR AS h
