CREATE VIEW [dbo].[WV_ALERTRECIPIENTLIST]
AS

	SELECT TOP 100 PERCENT A.* 
	FROM   (
			   SELECT TOP 100 PERCENT ALERT_RCPT.ALERT_ID AS AlertID,
					  ALERT_RCPT.ALERT_RCPT_ID AS AlertRecipientID,
					  ALERT_RCPT.EMP_CODE AS EmpCode,
					  ALERT_RCPT.EMAIL_ADDRESS AS Email,
					  ALERT_RCPT.PROCESSED AS DismissedTS,
					  ALERT_RCPT.NEW_ALERT,
					  ALERT_RCPT.READ_ALERT,
					  ISNULL(EMPLOYEE.EMP_FNAME + ' ', '') + ISNULL(EMPLOYEE.EMP_MI + '. ', '') + ISNULL(EMPLOYEE.EMP_LNAME, '') AS UserName,
					  ISNULL(ALERT_RCPT.CURRENT_RCPT, 0) AS CURRENT_RCPT
			   FROM   ALERT_RCPT WITH(NOLOCK)
					  INNER JOIN EMPLOYEE WITH(NOLOCK)
						   ON  ALERT_RCPT.EMP_CODE = EMPLOYEE.EMP_CODE
			   UNION
			   SELECT TOP 100 PERCENT ALERT_RCPT_DISMISSED.ALERT_ID AS AlertID,
					  ALERT_RCPT_DISMISSED.ALERT_RCPT_ID AS AlertRecipientID,
					  ALERT_RCPT_DISMISSED.EMP_CODE AS EmpCode,
					  ALERT_RCPT_DISMISSED.EMAIL_ADDRESS AS Email,
					  ALERT_RCPT_DISMISSED.PROCESSED AS DismissedTS,
					  ALERT_RCPT_DISMISSED.NEW_ALERT,
					  ALERT_RCPT_DISMISSED.READ_ALERT,
					  ISNULL(EMPLOYEE.EMP_FNAME + ' ', '') + ISNULL(EMPLOYEE.EMP_MI + '. ', '') + ISNULL(EMPLOYEE.EMP_LNAME, '') AS UserName,
					  ISNULL(ALERT_RCPT_DISMISSED.CURRENT_RCPT, 0) AS CURRENT_RCPT
			   FROM   ALERT_RCPT_DISMISSED WITH(NOLOCK)
					  INNER JOIN EMPLOYEE WITH(NOLOCK)
						   ON  ALERT_RCPT_DISMISSED.EMP_CODE = EMPLOYEE.EMP_CODE
		   ) AS A
	ORDER BY
		   A.UserName


