CREATE PROC [dbo].[advsp_hosted_validate_ncc_data]
AS

UPDATE h SET h.VALIDATED = 1
FROM NIELSENHOSTED.dbo.NCC_TV_FUSION_UE h
	INNER JOIN NIELSENDATASTORE.dbo.NCC_TV_FUSION_UE h2 ON h.NCC_TV_FUSION_UE_ID = h2.NCC_TV_FUSION_UE_ID
WHERE h.VALIDATED = 0
AND NIELSENHOSTED.[dbo].[advfn_ncc_rowcount_by_fusion_ue_id](h.NCC_TV_FUSION_UE_ID) = NIELSENDATASTORE.[dbo].[advfn_ncc_rowcount_by_fusion_ue_id](h.NCC_TV_FUSION_UE_ID)

UPDATE h SET h.VALIDATED = 1
FROM NIELSENHOSTED.dbo.NCC_TV_AI_UE_LOG h
	INNER JOIN NIELSENDATASTORE.dbo.NCC_TV_AI_UE_LOG h2 ON h.NCC_TV_AI_UE_LOG_ID = h2.NCC_TV_AI_UE_LOG_ID
WHERE h.VALIDATED = 0
AND NIELSENHOSTED.[dbo].[advfn_ncc_rowcount_by_ai_ue_log_id](h.NCC_TV_AI_UE_LOG_ID) = NIELSENDATASTORE.[dbo].[advfn_ncc_rowcount_by_ai_ue_log_id](h.NCC_TV_AI_UE_LOG_ID)

UPDATE h SET h.VALIDATED = 1
FROM NIELSENHOSTED.dbo.NCC_TV_CARRIAGE_UE_LOG h
	INNER JOIN NIELSENDATASTORE.dbo.NCC_TV_CARRIAGE_UE_LOG h2 ON h.NCC_TV_CARRIAGE_UE_LOG_ID = h2.NCC_TV_CARRIAGE_UE_LOG_ID
WHERE h.VALIDATED = 0
AND NIELSENHOSTED.[dbo].[advfn_ncc_rowcount_by_carriage_ue_log_id](h.NCC_TV_CARRIAGE_UE_LOG_ID) = NIELSENDATASTORE.[dbo].[advfn_ncc_rowcount_by_carriage_ue_log_id](h.NCC_TV_CARRIAGE_UE_LOG_ID)

GO

GRANT EXEC ON [advsp_hosted_validate_ncc_data] TO PUBLIC
GO