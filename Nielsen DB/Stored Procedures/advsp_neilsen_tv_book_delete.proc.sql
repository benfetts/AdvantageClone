CREATE PROCEDURE advsp_neilsen_tv_book_delete
	@NIELSEN_TV_BOOK_ID int
AS

DECLARE	@NIELSEN_MARKET_NUM int,
		@YEAR				smallint,
		@MONTH				smallint,
        @REPORTING_SERVICE  varchar(1),
        @EXCLUSION          varchar(2),
        @ETHNICITY          varchar(5)

SELECT @NIELSEN_MARKET_NUM = [NIELSEN_MARKET_NUM], @YEAR = [YEAR], @MONTH = [MONTH], @REPORTING_SERVICE = REPORTING_SERVICE, @EXCLUSION = EXCLUSION, @ETHNICITY = ETHNICITY
FROM dbo.NIELSEN_TV_BOOK 
WHERE NIELSEN_TV_BOOK_ID = @NIELSEN_TV_BOOK_ID

DELETE dbo.NIELSEN_TV_AUDIENCE 
WHERE NIELSEN_TV_BOOK_ID = @NIELSEN_TV_BOOK_ID

DELETE dbo.NIELSEN_TV_HUTPUT
WHERE NIELSEN_TV_BOOK_ID = @NIELSEN_TV_BOOK_ID

DELETE dbo.NIELSEN_TV_INTAB
WHERE NIELSEN_TV_BOOK_ID = @NIELSEN_TV_BOOK_ID

--DELETE dbo.NIELSEN_TV_UNIVERSE 
--WHERE @NIELSEN_MARKET_NUM = [NIELSEN_MARKET_NUM]
--AND @YEAR = [YEAR]
--AND @MONTH = [MONTH]
--AND @REPORTING_SERVICE = REPORTING_SERVICE
--AND @EXCLUSION = EXCLUSION
--AND @ETHNICITY = ETHNICITY

DELETE dbo.NIELSEN_TV_BOOK
WHERE NIELSEN_TV_BOOK_ID = @NIELSEN_TV_BOOK_ID
GO

GRANT EXEC ON advsp_neilsen_tv_book_delete TO PUBLIC
GO