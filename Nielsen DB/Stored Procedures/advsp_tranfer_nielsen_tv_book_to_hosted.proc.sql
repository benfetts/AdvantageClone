CREATE PROC [dbo].[advsp_tranfer_nielsen_tv_book_to_hosted]
AS

BEGIN TRAN

SET IDENTITY_INSERT NIELSENHOSTED.dbo.NIELSEN_TV_BOOK ON

INSERT INTO NIELSENHOSTED.dbo.NIELSEN_TV_BOOK ( NIELSEN_TV_BOOK_ID, NIELSEN_MARKET_NUM, [YEAR], [MONTH], STREAM, START_DATETIME, END_DATETIME, MARKET_TIME_ZONE, MARKET_CLASS_CODE,
IS_DST_MARKET, CREATE_DATE, VALIDATED, COLLECTION_METHOD, REPORTING_SERVICE, EXCLUSION, ETHNICITY, DOWNLOAD_FILE_ID )
SELECT NIELSEN_TV_BOOK_ID, NIELSEN_MARKET_NUM, [YEAR], [MONTH], STREAM, START_DATETIME, END_DATETIME, MARKET_TIME_ZONE, MARKET_CLASS_CODE,
IS_DST_MARKET, CREATE_DATE, VALIDATED, COLLECTION_METHOD, REPORTING_SERVICE, EXCLUSION, ETHNICITY, DOWNLOAD_FILE_ID
FROM NIELSENDATASTORE.dbo.NIELSEN_TV_BOOK
WHERE NIELSEN_TV_BOOK_ID NOT IN (SELECT NIELSEN_TV_BOOK_ID FROM NIELSENHOSTED.dbo.NIELSEN_TV_BOOK)

SET IDENTITY_INSERT NIELSENHOSTED.dbo.NIELSEN_TV_BOOK OFF

COMMIT TRAN

GO
