CREATE PROC [dbo].[advsp_tranfer_nielsen_tv_program_book_to_hosted]
AS

BEGIN TRAN

SET IDENTITY_INSERT NIELSENHOSTED.dbo.NIELSEN_TV_PROGRAM_BOOK ON

INSERT INTO NIELSENHOSTED.dbo.NIELSEN_TV_PROGRAM_BOOK ( NIELSEN_TV_PROGRAM_BOOK_ID, NIELSEN_MARKET_NUM, [YEAR], [MONTH], VALIDATED,
REPORTING_SERVICE, EXCLUSION, ETHNICITY, DOWNLOAD_FILE_ID )
SELECT NIELSEN_TV_PROGRAM_BOOK_ID, NIELSEN_MARKET_NUM, [YEAR], [MONTH], VALIDATED,
REPORTING_SERVICE, EXCLUSION, ETHNICITY, DOWNLOAD_FILE_ID
FROM NIELSENDATASTORE.dbo.NIELSEN_TV_PROGRAM_BOOK
WHERE NIELSEN_TV_PROGRAM_BOOK_ID NOT IN (SELECT NIELSEN_TV_PROGRAM_BOOK_ID FROM NIELSENHOSTED.dbo.NIELSEN_TV_PROGRAM_BOOK)

SET IDENTITY_INSERT NIELSENHOSTED.dbo.NIELSEN_TV_PROGRAM_BOOK OFF

COMMIT TRAN

GO
