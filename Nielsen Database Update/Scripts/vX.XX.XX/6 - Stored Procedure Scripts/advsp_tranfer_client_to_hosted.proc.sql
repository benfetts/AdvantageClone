IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[advsp_tranfer_client_to_hosted]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[advsp_tranfer_client_to_hosted]
GO

CREATE PROC advsp_tranfer_client_to_hosted
AS

BEGIN TRAN

DELETE NIELSENHOSTED.dbo.CLIENT_ORDER_MARKET 
DELETE NIELSENHOSTED.dbo.CLIENT_ORDER
DELETE NIELSENHOSTED.dbo.CLIENT

SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT ON

INSERT INTO NIELSENHOSTED.dbo.CLIENT (CLIENT_ID, CODE, CLIENT_NAME, IS_INACTIVE, IS_NCC_SUBSCRIBED)
SELECT CLIENT_ID, CODE, CLIENT_NAME, IS_INACTIVE, IS_NCC_SUBSCRIBED
FROM dbo.CLIENT

SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT OFF
SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT_ORDER ON

INSERT INTO NIELSENHOSTED.dbo.CLIENT_ORDER (CLIENT_ORDER_ID, CLIENT_ID, ORDER_TYPE, ORDER_NUMBER, ORDER_DATETIME, LAST_CHANGED_DATETIME, START_YEAR, END_YEAR, ORDER_DURATION, REPORT, ALL_MARKETS, CLIENT_ALIAS, IS_SUSPENDED)
SELECT CLIENT_ORDER_ID, CLIENT_ID, ORDER_TYPE, ORDER_NUMBER, ORDER_DATETIME, LAST_CHANGED_DATETIME, START_YEAR, END_YEAR, ORDER_DURATION, REPORT, ALL_MARKETS, CLIENT_ALIAS, IS_SUSPENDED
FROM dbo.CLIENT_ORDER

SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT_ORDER OFF
SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT_ORDER_MARKET ON

INSERT INTO NIELSENHOSTED.dbo.CLIENT_ORDER_MARKET (CLIENT_ORDER_MARKET_ID, CLIENT_ORDER_ID, MARKET_NUMBER, SEPTEMBER, OCTOBER, NOVEMBER, DECEMBER, JANUARY, FEBRUARY, MARCH, APRIL, MAY, JUNE, JULY, AUGUST, 
	WINTER_QUARTERLY, SPRING_QUARTERLY, SUMMER_QUARTERLY, FALL_QUARTERLY) --, WINTER_SPRING_ETHNIC_QUARTERLY, FALL_WINTER_SPRING_ETHNIC_QUARTERLY, SUMMER_FALL_ETHNIC_SURVEY, SPRING_SMALL_MARKET, FALL_SMALL_MARKET)
SELECT CLIENT_ORDER_MARKET_ID, CLIENT_ORDER_ID, MARKET_NUMBER, SEPTEMBER, OCTOBER, NOVEMBER, DECEMBER, JANUARY, FEBRUARY, MARCH, APRIL, MAY, JUNE, JULY, AUGUST,
	WINTER_QUARTERLY, SPRING_QUARTERLY, SUMMER_QUARTERLY, FALL_QUARTERLY --, WINTER_SPRING_ETHNIC_QUARTERLY, FALL_WINTER_SPRING_ETHNIC_QUARTERLY, SUMMER_FALL_ETHNIC_SURVEY, SPRING_SMALL_MARKET, FALL_SMALL_MARKET
FROM dbo.CLIENT_ORDER_MARKET

SET IDENTITY_INSERT NIELSENHOSTED.dbo.CLIENT_ORDER_MARKET OFF

COMMIT TRAN
GO

GRANT EXECUTE
    ON OBJECT::[dbo].[advsp_tranfer_client_to_hosted] TO PUBLIC;
GO

