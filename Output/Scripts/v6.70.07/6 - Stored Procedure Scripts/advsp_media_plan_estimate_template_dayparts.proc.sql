CREATE PROCEDURE [dbo].[advsp_media_plan_estimate_template_dayparts]
	@MEDIA_PLAN_ESTIMATE_TEMPLATE_ID int,
	@MEDIA_TYPE char(1)
AS

SELECT
	Selected = CAST(CASE WHEN dp.DAY_PART_ID IS NOT NULL THEN 1 ELSE 0 END as bit),
	--ID = dp.MEDIA_PLAN_ESTIMATE_TEMPLATE_DAYPART_ID,
	--MediaPlanEstimateTemplateID = dp.MEDIA_PLAN_ESTIMATE_TEMPLATE_ID,
	DaypartID = dpd.DAY_PART_ID,
	--Percentage = CAST(COALESCE(dp.PERCENTAGE,0) as smallint),
	--MediaPlanEstimateTemplateMarketID = m.MEDIA_PLAN_ESTIMATE_TEMPLATE_MARKET_ID,
	--Market = mkt.MARKET_DESC,
	DaypartDescription = dpd.[DESCRIPTION]
FROM dbo.DAY_PART dpd
	LEFT OUTER JOIN dbo.MEDIA_PLAN_ESTIMATE_TEMPLATE_DAYPART dp on dpd.DAY_PART_ID = dp.DAY_PART_ID AND dp.MEDIA_PLAN_ESTIMATE_TEMPLATE_ID = @MEDIA_PLAN_ESTIMATE_TEMPLATE_ID
	--LEFT OUTER JOIN dbo.MEDIA_PLAN_ESTIMATE_TEMPLATE_MARKET m on dp.MEDIA_PLAN_ESTIMATE_TEMPLATE_ID = m.MEDIA_PLAN_ESTIMATE_TEMPLATE_ID 
	--LEFT OUTER JOIN dbo.MARKET mkt ON m.MARKET_CODE = mkt.MARKET_CODE 
WHERE dpd.DAY_PART_TYPE_ID = CASE WHEN @MEDIA_TYPE = 'T' THEN 1 ELSE 2 END
AND dpd.IS_INACTIVE = 0
GO
