IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS_TAB WHERE AGY_SETTINGS_APP = 7 AND AGY_SETTINGS_TAB = 10) BEGIN

	INSERT INTO dbo.AGY_SETTINGS_TAB 
		(AGY_SETTINGS_APP, AGY_SETTINGS_TAB, TAB_DESC)
	VALUES
		(7, 10, 'QuickBooks')

END ELSE BEGIN

	UPDATE dbo.AGY_SETTINGS_TAB SET TAB_DESC = 'QuickBooks'
	WHERE AGY_SETTINGS_APP = 7
    AND AGY_SETTINGS_TAB = 10

END

IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS WHERE AGY_SETTINGS_CODE = 'QB_ENABLED') BEGIN

	INSERT INTO dbo.AGY_SETTINGS 
		(AGY_SETTINGS_CODE, AGY_SETTINGS_DESC, AGY_SETTINGS_VALUE, AGY_SETTINGS_DEF, AGY_SETTINGS_MIN, AGY_SETTINGS_MAX, AGY_SETTINGS_APP, AGY_SETTINGS_TAB, AGY_SETTINGS_ORDER, DTYPE_ID)
	VALUES 
		('QB_ENABLED', 'Enabled', '', '', NULL, NULL, 7, 10, 3, 16)

END

IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS WHERE AGY_SETTINGS_CODE = 'QB_ACCESS_TOKEN') BEGIN

	INSERT INTO dbo.AGY_SETTINGS 
		(AGY_SETTINGS_CODE, AGY_SETTINGS_DESC, AGY_SETTINGS_VALUE, AGY_SETTINGS_DEF, AGY_SETTINGS_MIN, AGY_SETTINGS_MAX, AGY_SETTINGS_APP, AGY_SETTINGS_TAB, AGY_SETTINGS_ORDER, DTYPE_ID)
	VALUES 
		('QB_ACCESS_TOKEN', 'Quickbooks Access Token', '', '', NULL, NULL, NULL, NULL, NULL, NULL)

END

IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS WHERE AGY_SETTINGS_CODE = 'QB_REALM_ID') BEGIN

	INSERT INTO dbo.AGY_SETTINGS 
		(AGY_SETTINGS_CODE, AGY_SETTINGS_DESC, AGY_SETTINGS_VALUE, AGY_SETTINGS_DEF, AGY_SETTINGS_MIN, AGY_SETTINGS_MAX, AGY_SETTINGS_APP, AGY_SETTINGS_TAB, AGY_SETTINGS_ORDER, DTYPE_ID)
	VALUES 
		('QB_REALM_ID', 'Quickbooks Realm ID', '', '', NULL, NULL, NULL, NULL, NULL, NULL)

END

IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS WHERE AGY_SETTINGS_CODE = 'QB_AUTH_CODE') BEGIN

	INSERT INTO dbo.AGY_SETTINGS 
		(AGY_SETTINGS_CODE, AGY_SETTINGS_DESC, AGY_SETTINGS_VALUE, AGY_SETTINGS_DEF, AGY_SETTINGS_MIN, AGY_SETTINGS_MAX, AGY_SETTINGS_APP, AGY_SETTINGS_TAB, AGY_SETTINGS_ORDER, DTYPE_ID)
	VALUES 
		('QB_AUTH_CODE', 'Quickbooks Authorization Code - used to get refresh and access tokens', '', '', NULL, NULL, NULL, NULL, NULL, NULL)

END

IF NOT EXISTS(SELECT * FROM dbo.AGY_SETTINGS WHERE AGY_SETTINGS_CODE = 'QB_REFRESH_TOKEN') BEGIN

	INSERT INTO dbo.AGY_SETTINGS 
		(AGY_SETTINGS_CODE, AGY_SETTINGS_DESC, AGY_SETTINGS_VALUE, AGY_SETTINGS_DEF, AGY_SETTINGS_MIN, AGY_SETTINGS_MAX, AGY_SETTINGS_APP, AGY_SETTINGS_TAB, AGY_SETTINGS_ORDER, DTYPE_ID)
	VALUES 
		('QB_REFRESH_TOKEN', 'Quickbooks Refresh Token - used to refresh access token', '', '', NULL, NULL, NULL, NULL, NULL, NULL)

END
