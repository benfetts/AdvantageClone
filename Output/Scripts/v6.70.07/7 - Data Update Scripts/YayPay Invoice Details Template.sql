DECLARE @EXPORT_TEMPLATE_ID smallint,
		@ADV_SERVICE_EXPORT_ID int
DECLARE @USER_CREATED AS varchar(100) = 'SYSADM'

IF NOT EXISTS(SELECT [NAME] FROM [dbo].[EXPORT_TEMPLATE] WHERE [TYPE] = 9 AND [SYSTEM_TEMPLATE] = 1) BEGIN

	INSERT [dbo].[EXPORT_TEMPLATE] ([TYPE], [NAME], [FILE_TYPE], [DELIMITER], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE], [SYSTEM_TEMPLATE], [DEFAULT_DIRECTORY], [INCLUDE_COLUMN_HEADERS]) 
	VALUES (9, N'YayPay Export', 1, N',', @USER_CREATED, GETDATE(), NULL, NULL, 1, NULL, 1)

	SELECT @EXPORT_TEMPLATE_ID = IDENT_CURRENT('EXPORT_TEMPLATE')

END ELSE BEGIN

	UPDATE
		[dbo].[EXPORT_TEMPLATE]
	SET
		[NAME] = 'YayPay Export'
	WHERE 
		[TYPE] = 9 
		AND [SYSTEM_TEMPLATE] = 1
		
	SELECT 
		@EXPORT_TEMPLATE_ID = EXPORT_TEMPLATE_ID
	FROM
		[dbo].[EXPORT_TEMPLATE] 
	WHERE 
		[TYPE] = 9 
		AND [SYSTEM_TEMPLATE] = 1

END

DELETE FROM [dbo].[EXPORT_TEMPLATE_DTL] WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID

INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'itemId', 0, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'invoiceId', 1, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'name', 2, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'description', 3, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'rate', 4, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'quantity', 5, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE]) 
VALUES (@EXPORT_TEMPLATE_ID, N'amount', 6, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)


IF NOT EXISTS (SELECT EXPORT_TEMPLATE_ID FROM ADV_SERVICE_EXPORT WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID) BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT (EXPORT_TEMPLATE_ID) 
	VALUES (@EXPORT_TEMPLATE_ID)
	
	SELECT @ADV_SERVICE_EXPORT_ID = @@IDENTITY

END ELSE BEGIN

	SELECT @ADV_SERVICE_EXPORT_ID = ADV_SERVICE_EXPORT_ID FROM ADV_SERVICE_EXPORT WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'Enabled') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'Enabled', 'Enabled', 0, 0);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'RunAt') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'RunAt', 'Run At', CAST('2020-08-06 01:00:00.000' AS datetime), CAST('2020-08-06 01:00:00.000' AS datetime));

END

IF EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'NextRunAt') BEGIN

	DELETE FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE CODE = 'NextRunAt' AND ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'NextRunAt') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'NextRunAt', 'Next Run At', '01/01/2001 01:00:00', '01/01/2001 01:00:00');

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'ExportPath') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'ExportPath', 'Export Path', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'UseSSLForFTP') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'UseSSLForFTP', 'Use SSL', 0, 0);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'FTPAddress') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'FTPAddress', 'FTP Address', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'FTPPort') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'FTPPort', 'FTP Port', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'FTPFolder') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'FTPFolder', 'FTP Folder', NULL, '/');

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'FTPUserName') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'FTPUserName', 'FTP UserName', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'FTPPassword') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'FTPPassword', 'FTP Password', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'SSLModeForFTP') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'SSLModeForFTP', 'SSL Mode', NULL, 0);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'EmailAddress') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'EmailAddress', 'Email Address', NULL, NULL);

END

IF NOT EXISTS(SELECT [ADV_SERVICE_EXPORT_SETTING_ID] FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID AND CODE = 'ProcessNowTransactionDate') BEGIN

	INSERT INTO dbo.ADV_SERVICE_EXPORT_SETTING (ADV_SERVICE_EXPORT_ID, CODE, [DESCRIPTION], VALUE, DEFAULT_VALUE)
	VALUES (@ADV_SERVICE_EXPORT_ID, 'ProcessNowTransactionDate', 'Process Now Transaction Date', GETDATE(), GETDATE());

END