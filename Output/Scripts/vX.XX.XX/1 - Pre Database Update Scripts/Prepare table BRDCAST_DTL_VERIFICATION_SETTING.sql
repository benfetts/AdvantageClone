IF EXISTS(SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'BRDCAST_DTL_VERIFICATION_SETTING' AND COLUMN_NAME = 'OFFICE_CODE') BEGIN

	DELETE dbo.TIME_SEPARATION_SETTING
	WHERE BRDCAST_DTL_VERIFICATION_SETTING_ID <> (SELECT MIN(SETTING_ID) FROM BRDCAST_DTL_VERIFICATION_SETTING)

	DELETE dbo.BRDCAST_DTL_VERIFICATION_SETTING
	WHERE SETTING_ID <> (SELECT MIN(SETTING_ID) FROM BRDCAST_DTL_VERIFICATION_SETTING)

	IF EXISTS ( SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID( N'[dbo].[advfn_spot_separation_policy]' ) AND xtype IN ( N'FN', N'IF', N'TF' ))
	BEGIN
		DROP FUNCTION [dbo].[advfn_spot_separation_policy]
	END

	exec advsp_sql_column_prepare 'BRDCAST_DTL_VERIFICATION_SETTING', 'OFFICE_CODE'

	IF EXISTS(SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'BRDCAST_DTL_VERIFICATION_SETTING' AND COLUMN_NAME = 'OFFICE_CODE') BEGIN

		ALTER TABLE [dbo].[BRDCAST_DTL_VERIFICATION_SETTING] DROP COLUMN [OFFICE_CODE]
	
	END
END
GO
