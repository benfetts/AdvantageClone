DECLARE @EXPORT_TEMPLATE_ID smallint,
		@ADV_SERVICE_EXPORT_ID int
DECLARE @USER_CREATED AS varchar(100) = 'SYSADM'

IF NOT EXISTS(SELECT [NAME] FROM [dbo].[EXPORT_TEMPLATE] WHERE [TYPE] = 12 AND [SYSTEM_TEMPLATE] = 1) BEGIN

	INSERT [dbo].[EXPORT_TEMPLATE] ([TYPE], [NAME], [FILE_TYPE], [DELIMITER], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE], [SYSTEM_TEMPLATE], [DEFAULT_DIRECTORY], [INCLUDE_COLUMN_HEADERS]) 
	VALUES (12, N'YayPay Invoice Transaction', 1, N',', @USER_CREATED, GETDATE(), NULL, NULL, 1, NULL, 1)

	SELECT @EXPORT_TEMPLATE_ID = IDENT_CURRENT('EXPORT_TEMPLATE')

END ELSE BEGIN

	SELECT 
		@EXPORT_TEMPLATE_ID = EXPORT_TEMPLATE_ID
	FROM
		[dbo].[EXPORT_TEMPLATE] 
	WHERE 
		[TYPE] = 12 
		AND [SYSTEM_TEMPLATE] = 1

END

DELETE FROM [dbo].[EXPORT_TEMPLATE_DTL] WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID

INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'txId', 0, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'txType', 1, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'customerId', 2, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'amount', 3, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'amountApplied', 4, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'currency', 5, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'txDate', 6, NULL, 20, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'memo', 7, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'paid', 8, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'balance', 9, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'exchangeRate', 10, NULL, 16, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'refNum', 11, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'is_deleted', 12, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)
INSERT [dbo].[EXPORT_TEMPLATE_DTL] ([EXPORT_TEMPLATE_ID], [FIELD_NAME], [POSITION], [START], [LENGTH], [USER_CREATED], [CREATED_DATE], [USER_MODIFIED], [MODIFIED_DATE])
VALUES (@EXPORT_TEMPLATE_ID, N'paymentType', 13, NULL, 100, @USER_CREATED, GETDATE(), NULL, NULL)

IF EXISTS (SELECT EXPORT_TEMPLATE_ID FROM ADV_SERVICE_EXPORT WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID) BEGIN

	SELECT @ADV_SERVICE_EXPORT_ID = ADV_SERVICE_EXPORT_ID FROM ADV_SERVICE_EXPORT WHERE EXPORT_TEMPLATE_ID = @EXPORT_TEMPLATE_ID

	DELETE FROM dbo.ADV_SERVICE_EXPORT_SETTING WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID
	DELETE FROM dbo.ADV_SERVICE_EXPORT WHERE ADV_SERVICE_EXPORT_ID = @ADV_SERVICE_EXPORT_ID

END