EXEC [dbo].[advsp_sec_module_create] 1, 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPostBuyARWRPT', 'Broadcast Worksheet TV Post Buy', 0, 0, 0, 0, 1, 0, 0, 'Desktop_ReportWriter_AdvancedReportWriterDataSets', '', 16, 0, '', '', '', '', '', '', '', 0, 0, '', 0, '', '', '', '', '', 0
EXEC [dbo].[advsp_sec_module_create] 1, 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPreBuyARWRPT', 'Broadcast Worksheet TV Pre Buy', 0, 0, 0, 0, 1, 0, 0, 'Desktop_ReportWriter_AdvancedReportWriterDataSets', '', 17, 0, '', '', '', '', '', '', '', 0, 0, '', 0, '', '', '', '', '', 0
EXEC [dbo].[advsp_sec_module_create] 1, 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPostBuyDRPT', 'Broadcast Worksheet TV Post Buy', 0, 0, 0, 0, 1, 0, 0, 'Desktop_ReportWriter_DynamicReportDataSets', '', 16, 0, '', '', '', '', '', '', '', 0, 0, '', 0, '', '', '', '', '', 0
EXEC [dbo].[advsp_sec_module_create] 1, 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPreBuyDRPT', 'Broadcast Worksheet TV Pre Buy', 0, 0, 0, 0, 1, 0, 0, 'Desktop_ReportWriter_DynamicReportDataSets', '', 17, 0, '', '', '', '', '', '', '', 0, 0, '', 0, '', '', '', '', '', 0
GO

DECLARE @SEC_MODULE_ID AS int
DECLARE @SEC_MODULE_INFO_ID AS int
DECLARE @SEC_MODULE_CODE AS varchar(100)
DECLARE @NEW_SEC_MODULE_ID AS int
DECLARE @NEW_MODULE_INFO_ID AS int

DELETE dbo.SEC_APPLICATION_MOD
WHERE SEC_APPLICATION_ID = (SELECT SEC_APPLICATION_ID FROM dbo.SEC_APPLICATION WHERE NAME = 'Webvantage')
AND SEC_MODULE_ID = (SELECT SEC_MODULE_ID FROM dbo.SEC_MODULE 
	WHERE SEC_MODULE_CODE = 'Media_DigitalCampaignManager'
)

IF EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_MediaBroadcastWorksheetPostBuyARWRPT') AND
              EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPostBuyARWRPT') BEGIN
              
       SELECT @SEC_MODULE_ID = SEC_MODULE_ID, @SEC_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_MediaBroadcastWorksheetPostBuyARWRPT'
       SELECT @NEW_SEC_MODULE_ID = SEC_MODULE_ID, @NEW_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPostBuyARWRPT'

       DELETE FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID

       INSERT INTO [dbo].[SEC_GROUP_MODACCESS]([SEC_GROUP_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_GROUP_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_USER_MODACCESS]([SEC_USER_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_USER_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_CPUSER_MODACCESS]([CPUSER_GUID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [CPUSER_GUID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID

END

IF EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_MediaBroadcastWorksheetPreBuyARWRPT') AND
              EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPreBuyARWRPT') BEGIN
              
       SELECT @SEC_MODULE_ID = SEC_MODULE_ID, @SEC_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_MediaBroadcastWorksheetPreBuyARWRPT'
       SELECT @NEW_SEC_MODULE_ID = SEC_MODULE_ID, @NEW_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_AdvancedReportWriterDataSets_BroadcastWorksheetTVPreBuyARWRPT'

       DELETE FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID

       INSERT INTO [dbo].[SEC_GROUP_MODACCESS]([SEC_GROUP_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_GROUP_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_USER_MODACCESS]([SEC_USER_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_USER_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_CPUSER_MODACCESS]([CPUSER_GUID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [CPUSER_GUID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID

END

IF EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_MediaBroadcastWorksheetPostBuyDRPT') AND
              EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPostBuyDRPT') BEGIN
              
       SELECT @SEC_MODULE_ID = SEC_MODULE_ID, @SEC_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_MediaBroadcastWorksheetPostBuyDRPT'
       SELECT @NEW_SEC_MODULE_ID = SEC_MODULE_ID, @NEW_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPostBuyDRPT'

       DELETE FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID

       INSERT INTO [dbo].[SEC_GROUP_MODACCESS]([SEC_GROUP_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_GROUP_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_USER_MODACCESS]([SEC_USER_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_USER_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_CPUSER_MODACCESS]([CPUSER_GUID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [CPUSER_GUID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID

END

IF EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_MediaBroadcastWorksheetPreBuyDRPT') AND
              EXISTS(SELECT SEC_MODULE_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPreBuyDRPT') BEGIN
              
       SELECT @SEC_MODULE_ID = SEC_MODULE_ID, @SEC_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_MediaBroadcastWorksheetPreBuyDRPT'
       SELECT @NEW_SEC_MODULE_ID = SEC_MODULE_ID, @NEW_MODULE_INFO_ID = SEC_MODULE_INFO_ID FROM [SEC_MODULE] WHERE SEC_MODULE_CODE = 'Desktop_ReportWriter_DynamicReportDataSets_BroadcastWorksheetTVPreBuyDRPT'

       DELETE FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID
       DELETE FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @NEW_SEC_MODULE_ID

       INSERT INTO [dbo].[SEC_GROUP_MODACCESS]([SEC_GROUP_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_GROUP_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_GROUP_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_USER_MODACCESS]([SEC_USER_ID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [SEC_USER_ID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_USER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID
       
       INSERT INTO [dbo].[SEC_CPUSER_MODACCESS]([CPUSER_GUID], [SEC_MODULE_ID], [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2])
       SELECT [CPUSER_GUID], @NEW_SEC_MODULE_ID, [IS_BLOCKED], [CAN_ADD], [CAN_PRINT], [CAN_UPDATE], [CUSTOM1], [CUSTOM2] FROM [dbo].[SEC_CPUSER_MODACCESS] WHERE SEC_MODULE_ID = @SEC_MODULE_ID

END
GO