function toWeeklyTime(){try{var n={AlertID:alertId,CreatePriorWeeks:!1};$.get({url:window.appBase+"ProjectManagement/Agile/CheckAndUpdateAlertEmployeesAndHours",dataType:"json",data:n}).always(function(n){try{n&&(n.Success===!1&&n.ErrorMessage!==""?showNotification(n.ErrorMessage):filterGrid())}catch(t){}})}catch(t){console.log("Error:toWeeklyTime:",t)}}function toEmployeeTime(){try{showKendoConfirm("This will remove weekly time entries").done(function(){var n={AlertID:alertId};$.post({url:window.appBase+"ProjectManagement/Agile/DeleteWorkItemHours",dataType:"json",data:n}).always(function(n){try{n&&(n.Success===!1&&n.ErrorMessage!==""?showNotification(n.ErrorMessage):filterGrid())}catch(t){}})}).fail(function(){})}catch(n){console.log("Error:toEmployeeTime:",n)}}function checkBoxPastChanged(n){saveShowPastWeeksSetting(n.isChecked).then(()=>{filterGrid()})}function checkBoxFutureChanged(n){saveShowFutureWeeksSetting(n.isChecked).then(()=>{filterGrid()})}function checkBoxGroupEmployeeChanged(n){saveGroupEmployeesSetting(n.isChecked).then(()=>{setGridGrouping()})}function checkBoxGroupWeekChanged(n){saveGroupWeeksSetting(n.isChecked).then(()=>{setGridGrouping()})}function saveCreatePriorWeeksSetting(n){var t={Checked:n};loading(!0);$.post({url:window.appBase+"ProjectManagement/Agile/SaveCreatePriorWeeksSetting",dataType:"json",data:t}).always(function(n){try{n;loading(!1)}catch(t){loading(!1)}})}function saveShowPastWeeksSetting(n){var t=$.Deferred(),i={Checked:n};return loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/SaveShowPastWeeksSetting",dataType:"json",data:i}).always(function(n){try{n;loading(!1)}catch(i){loading(!1)}t.resolve()}),t.promise()}function saveShowFutureWeeksSetting(n){var t=$.Deferred(),i={Checked:n};return loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/SaveShowFutureWeeksSetting",dataType:"json",data:i}).always(function(n){try{n;loading(!1)}catch(i){loading(!1)}t.resolve()}),t.promise()}function saveGroupEmployeesSetting(n){var t=$.Deferred(),i={Checked:n};return loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/SaveGroupEmployeesSetting",dataType:"json",data:i}).always(function(n){try{n;loading(!1)}catch(i){loading(!1)}t.resolve()}),t.promise()}function saveGroupWeeksSetting(n){var t=$.Deferred(),i={Checked:n};return loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/SaveGroupWeeksSetting",dataType:"json",data:i}).always(function(n){try{n;loading(!1)}catch(i){loading(!1)}t.resolve()}),t.promise()}function refreshGridContent(){var n=$("#WorkItemHoursGrid").data("ejGrid");n.refreshContent(!0);console.log("refreshGridContent")}function setGridGrouping(){try{hasWeeklyHours===!0&&(groupEmployee=$("#CheckboxGroupEmployee").ejCheckBox("instance").option("checked"),groupWeek=$("#CheckboxGroupWeek").ejCheckBox("instance").option("checked"));_setGridGrouping()}catch(n){console.log("setGridGrouping:error:",n)}}function _setGridGrouping(){try{var n=$("#WorkItemHoursGrid").data("ejGrid");hasWeeklyHours===!0?(n.showColumns("Hours"),n.showColumns("Week of"),n.hideColumns("Hours Allowed"),n.hideColumns("% Complete"),groupEmployee===!0?(n.groupColumn("FullName"),n.hideColumns("Employee")):(n.ungroupColumn("FullName"),n.showColumns("Employee")),groupWeek===!0?(n.groupColumn("WeekStart"),n.hideColumns("Week of")):(n.ungroupColumn("WeekStart"),n.showColumns("Week of"),n.ungroupColumn("WeekStart"))):(n.ungroupColumn("FullName"),n.hideColumns("Hours"),n.hideColumns("Week of"),hasStartDate===!1||hasDueDate===!1?(n.hideColumns("Available"),n.hideColumns("Assigned"),n.hideColumns("Balance")):(n.showColumns("Available"),n.showColumns("Assigned"),n.showColumns("Balance")),n.showColumns("Hours Allowed"),n.showColumns("% Complete"),n.showColumns("Completed"),n.showColumns("Employee"))}catch(t){console.log("_setGridGrouping:error:",t)}}function filterGrid(){var t=!1,i=!1,n,r,u=!1,f;try{$("#CheckboxPast").ejCheckBox("instance")&&(t=$("#CheckboxPast").ejCheckBox("instance").option("checked"))}catch(e){t=!1}try{$("#CheckboxFuture").ejCheckBox("instance")&&(i=$("#CheckboxFuture").ejCheckBox("instance").option("checked"))}catch(e){i=!1}try{$("#FilterEmployees").data("kendoMultiSelect")&&(n=$("#FilterEmployees").data("kendoMultiSelect"))}catch(e){n=null}try{n&&(r=n.value())}catch(e){r=null}try{hasWeeklyHours&&hasWeeklyHours!==null&&hasWeeklyHours!==undefined||(hasWeeklyHours=!1)}catch(e){hasWeeklyHours=!1}try{$("#CheckboxShowAvailability").ejCheckBox("instance")&&(u=$("#CheckboxShowAvailability").ejCheckBox("instance").option("checked"))}catch(e){u=!1}f={SprintHeaderID:thisSprintHeaderId,AlertID:thisAlertId,ShowPast:t,ShowFuture:i,EmployeeCodes:r,HasWeeklyHours:hasWeeklyHours,ShowAvailability:u};loading(!0);$.post({url:window.appBase+"ProjectManagement/Agile/FilterHoursGrid",dataType:"json",data:f}).always(function(n){n&&(n.Data&&n.Data.Hours&&(n.Data.Hours.forEach(function(t,i){n.Data.Hours[i].WeekStart&&(n.Data.Hours[i].WeekStart=new Date(parseInt(n.Data.Hours[i].WeekStart.substr(6))));n.Data.Hours[i].WeekEnd&&(n.Data.Hours[i].WeekEnd=new Date(parseInt(n.Data.Hours[i].WeekEnd.substr(6))))}),$("#WorkItemHoursGrid").ejGrid({dataSource:n.Data.Hours})),setGridGrouping(),window.setTimeout(()=>{$("#lastFocus").val()&&$("#"+$("#lastFocus").val()).focus()},10),loading(!1))})}function filterEmployees(){}function loading(n){var t=$(document.body);t&&kendo.ui.progress(t,n)}function trackControl(n){n.select();console.log(n.id);$("#lastFocus").val(n.id)}function gridQueryCellInfo(n){var t=0,i=0,r=0,u=0;n.data&&(n.data.HoursLeft&&isNaN(n.data.HoursLeft)===!1&&(i=n.data.HoursLeft*1),n.data.HoursAvailableForWeek&&isNaN(n.data.HoursAvailableForWeek)===!1&&(r=n.data.HoursAvailableForWeek*1),n.data.HoursAssignedForWeek&&isNaN(n.data.HoursAssignedForWeek)===!1&&(u=n.data.HoursAssignedForWeek*1),n.data.HoursBalance&&isNaN(n.data.HoursBalance)===!1&&(t=n.data.HoursBalance*1));i<0&&n.column.field==="HoursLeft"&&(n.cell.class="overage",n.cell.style.color="#D32F2F");r<u&&n.column.field==="HoursAssigned"&&(n.cell.class="overage",n.cell.style.color="#D32F2F");t<0&&(n.column.field==="HoursAssignedForWeek"||n.column.field==="HoursBalance")&&(n.cell.class="overage",n.cell.style.color="#D32F2F")}function gridActionBegin(n){console.log("gridActionBegin",n)}function gridBeginEdit(n){console.log("gridBeginEdit",n)}function gridEndEdit(n){console.log("gridEndEdit",n)}function gridCellEdit(n){console.log("gridCellEdit",n)}function hoursChanged(n,t,i,r){var u,f,e;console.log("hoursChanged:",thisAlertId,thisSprintHeaderId,n,r,t.value);isNaN(t.value)===!0?t.value=parseFloat(i).toFixed(2):(u=0,i=i*1,u=t.value*1,i!==u?n&&n>0?(f={SprintEmployeeID:n,Hours:u},loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/UpdateWorkItemHours",dataType:"json",data:f}).always(function(n){try{n&&(n.Success===!0&&(filterGrid(),n.Data.HoursAllowed&&$("#hoursAllowedSpan").text(n.Data.HoursAllowed),n.Data.HoursAllocated&&$("#hoursAllocatedSpan").text(n.Data.HoursAllocated)),n.Success===!1&&(console.log("UpdateWorkItemHours:error:",n),showNotification(n.Message,"error"),t.focus(),t.select()));loading(!1)}catch(i){loading(!1)}})):(console.log("save emp hours"),e={AlertID:thisAlertId,EmployeeCode:r,Hours:u},loading(!0),$.post({url:window.appBase+"ProjectManagement/Agile/UpdateEmployeeHours",dataType:"json",data:e}).always(function(n){try{n&&(console.log(n),n.Success===!0&&(filterGrid(),n.Data.HoursAllowed&&$("#hoursAllowedSpan").text(n.Data.HoursAllowed),n.Data.HoursAllocated&&$("#hoursAllocatedSpan").text(n.Data.HoursAllocated)),n.Success===!1&&(showNotification(n.Message,"error"),t.focus(),t.select()));loading(!1)}catch(i){loading(!1)}})):t.value=parseFloat(i).toFixed(2))}